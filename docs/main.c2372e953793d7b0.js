"use strict";(self.webpackChunkportafolio=self.webpackChunkportafolio||[]).push([[179],{698:(On,_t,se)=>{var F=se(593),Ie=se(385),Ae=se(946);const at=[{path:"",loadChildren:()=>se.e(186).then(se.bind(se,186)).then(l=>l.ArticleModule)},{path:"**",redirectTo:""}];let je=(()=>{var l;class e{}return(l=e).\u0275fac=function(r){return new(r||l)},l.\u0275mod=Ae.oAB({type:l}),l.\u0275inj=Ae.cJS({imports:[Ie.Bz.forRoot(at),Ie.Bz]}),e})(),Je=(()=>{var l;class e{constructor(){this.isShowDiv=!1}toggleTheme(){this.isShowDiv=!this.isShowDiv,document.getElementById("main-navbar").classList.toggle("night-theme_button"),document.getElementsByName("body")}}return(l=e).\u0275fac=function(r){return new(r||l)},l.\u0275cmp=Ae.Xpm({type:l,selectors:[["shared-navbar"]],decls:24,vars:2,consts:[["id","main-navbar"],[1,"nav-container","p-2"],["id","name-container"],["href","/",1,"nav-link"],["id","links-container"],["href","https://github.com/edissonchamorroc","target","_blank",1,"nav-link"],["stroke","currentColor","fill","currentColor","stroke-width","0","viewBox","0 0 512 512","height","1em","width","1em","xmlns","http://www.w3.org/2000/svg"],["d","M256 32C132.3 32 32 134.9 32 261.7c0 101.5 64.2 187.5 153.2 217.9a17.56 17.56 0 003.8.4c8.3 0 11.5-6.1 11.5-11.4 0-5.5-.2-19.9-.3-39.1a102.4 102.4 0 01-22.6 2.7c-43.1 0-52.9-33.5-52.9-33.5-10.2-26.5-24.9-33.6-24.9-33.6-19.5-13.7-.1-14.1 1.4-14.1h.1c22.5 2 34.3 23.8 34.3 23.8 11.2 19.6 26.2 25.1 39.6 25.1a63 63 0 0025.6-6c2-14.8 7.8-24.9 14.2-30.7-49.7-5.8-102-25.5-102-113.5 0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8a18.64 18.64 0 015-.5c8.1 0 26.4 3.1 56.6 24.1a208.21 208.21 0 01112.2 0c30.2-21 48.5-24.1 56.6-24.1a18.64 18.64 0 015 .5c12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6 0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5 0 30.7-.3 55.5-.3 63 0 5.4 3.1 11.5 11.4 11.5a19.35 19.35 0 004-.4C415.9 449.2 480 363.1 480 261.7 480 134.9 379.7 32 256 32z"],["id","theme-container"],[1,"container-button",2,"display","inline-block","opacity","1","transform","none",3,"hidden"],["type","button","aria-label","Toggle theme",1,"theme-button",3,"click"],["viewBox","0 0 24 24","focusable","false","aria-hidden","true"],["fill","currentColor","d","M21.4,13.7C20.6,13.9,19.8,14,19,14c-5,0-9-4-9-9c0-0.8,0.1-1.6,0.3-2.4c0.1-0.3,0-0.7-0.3-1 c-0.3-0.3-0.6-0.4-1-0.3C4.3,2.7,1,7.1,1,12c0,6.1,4.9,11,11,11c4.9,0,9.3-3.3,10.6-8.1c0.1-0.3,0-0.7-0.3-1 C22.1,13.7,21.7,13.6,21.4,13.7z"],[1,"container-button",2,"opacity","1","transform","none",3,"hidden"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 24 24",1,"bi","bi-sun"],["d","M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"]],template:function(r,o){1&r&&(Ae.TgZ(0,"nav",0)(1,"div",1)(2,"div",2)(3,"h1")(4,"a",3)(5,"span")(6,"p"),Ae._uU(7," Edisson Chamorro "),Ae.qZA()()()()(),Ae.TgZ(8,"div",4)(9,"a",3),Ae._uU(10," Trabajos "),Ae.qZA(),Ae.TgZ(11,"a",5),Ae.O4$(),Ae.TgZ(12,"svg",6),Ae._UZ(13,"path",7),Ae.qZA(),Ae._uU(14," GitHub "),Ae.qZA()(),Ae.kcU(),Ae.TgZ(15,"div",8)(16,"div",9)(17,"button",10),Ae.NdJ("click",function(){return o.toggleTheme()}),Ae.O4$(),Ae.TgZ(18,"svg",11),Ae._UZ(19,"path",12),Ae.qZA()()(),Ae.kcU(),Ae.TgZ(20,"div",13)(21,"button",10),Ae.NdJ("click",function(){return o.toggleTheme()}),Ae.O4$(),Ae.TgZ(22,"svg",14),Ae._UZ(23,"path",15),Ae.qZA()()()()()()),2&r&&(Ae.xp6(16),Ae.Q6J("hidden",o.isShowDiv),Ae.xp6(4),Ae.Q6J("hidden",!o.isShowDiv))},styles:['nav[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:56px;background:rgba(255,255,255,.25);display:flex;justify-content:center;z-index:2;font-family:"M PLUS Rounded 1c",sans-serif;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.nav-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:auto;height:100%}.nav-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#1a202c}.nav-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px;font-weight:bolder}#name-container[_ngcontent-%COMP%]{width:auto;height:100%;margin-right:20px}#name-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .nav-link[_ngcontent-%COMP%]{margin:0;width:100%;height:100%}.nav-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:100%;height:100%}.nav-link[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding-top:8px}#links-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:start}#links-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-left:8px}#theme-container[_ngcontent-%COMP%]{margin-left:200px}.container-button[_ngcontent-%COMP%]{width:40px;height:40px}.theme-button[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#805ad5;border-radius:10px;border:none}.night-theme_button[_ngcontent-%COMP%]{background-color:#20202380!important}.night-theme_content[_ngcontent-%COMP%]{background:rgb(32,32,35)}']}),e})();function Tt(l,e,t,r,o,a,u){try{var f=l[a](u),p=f.value}catch(m){return void t(m)}f.done?e(p):Promise.resolve(p).then(r,o)}const Vn=1,si=2,ni=3,nn=0,wl=1,_a=2,Tr=0,oi=1,Xr=2,zn=3,Fn=4,$a=5,Bi=301,Ar=302,pi=306,er=1e3,Mt=1001,Zn=1003,Mi=1006,Or=1008,lr=1009,ae=1014,_e=1015,it=1016,Mn=1020,ui=1023,yr=1026,yo=1027,Ds=2300,qr=2301,$s=3001,_n="srgb",Oi="srgb-linear",Ta="display-p3",na="300 es",bo=2e3;class Pi{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const o=this._listeners[e];if(void 0!==o){const a=o.indexOf(t);-1!==a&&o.splice(a,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const r=this._listeners[e.type];if(void 0!==r){e.target=this;const o=r.slice(0);for(let a=0,u=o.length;a<u;a++)o[a].call(this,e);e.target=null}}}const ci=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const Br=Math.PI/180,Gn=180/Math.PI;function Rr(){const l=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(ci[255&l]+ci[l>>8&255]+ci[l>>16&255]+ci[l>>24&255]+"-"+ci[255&e]+ci[e>>8&255]+"-"+ci[e>>16&15|64]+ci[e>>24&255]+"-"+ci[63&t|128]+ci[t>>8&255]+"-"+ci[t>>16&255]+ci[t>>24&255]+ci[255&r]+ci[r>>8&255]+ci[r>>16&255]+ci[r>>24&255]).toLowerCase()}function Vi(l,e,t){return Math.max(e,Math.min(t,l))}function Vc(l,e){return(l%e+e)%e}function ec(l,e,t){return(1-t)*l+t*e}function Pu(l){return 0==(l&l-1)&&0!==l}function ef(l){return Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function La(l){return Math.pow(2,Math.floor(Math.log(l)/Math.LN2))}function Hr(l,e){switch(e.constructor){case Float32Array:return l;case Uint32Array:return l/4294967295;case Uint16Array:return l/65535;case Uint8Array:return l/255;case Int32Array:return Math.max(l/2147483647,-1);case Int16Array:return Math.max(l/32767,-1);case Int8Array:return Math.max(l/127,-1);default:throw new Error("Invalid component type.")}}function En(l,e){switch(e.constructor){case Float32Array:return l;case Uint32Array:return Math.round(4294967295*l);case Uint16Array:return Math.round(65535*l);case Uint8Array:return Math.round(255*l);case Int32Array:return Math.round(2147483647*l);case Int16Array:return Math.round(32767*l);case Int8Array:return Math.round(127*l);default:throw new Error("Invalid component type.")}}const ia_DEG2RAD=Br,ia_radToDeg=function ic(l){return l*Gn};class Re{constructor(e=0,t=0){Re.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,o=e.elements;return this.x=o[0]*t+o[3]*r+o[6],this.y=o[1]*t+o[4]*r+o[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Vi(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),o=Math.sin(t),a=this.x-e.x,u=this.y-e.y;return this.x=a*r-u*o+e.x,this.y=a*o+u*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class gn{constructor(e,t,r,o,a,u,f,p,m){gn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,r,o,a,u,f,p,m)}set(e,t,r,o,a,u,f,p,m){const v=this.elements;return v[0]=e,v[1]=o,v[2]=f,v[3]=t,v[4]=a,v[5]=p,v[6]=r,v[7]=u,v[8]=m,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,o=t.elements,a=this.elements,u=r[0],f=r[3],p=r[6],m=r[1],v=r[4],y=r[7],x=r[2],w=r[5],D=r[8],N=o[0],I=o[3],A=o[6],k=o[1],O=o[4],B=o[7],W=o[2],Y=o[5],q=o[8];return a[0]=u*N+f*k+p*W,a[3]=u*I+f*O+p*Y,a[6]=u*A+f*B+p*q,a[1]=m*N+v*k+y*W,a[4]=m*I+v*O+y*Y,a[7]=m*A+v*B+y*q,a[2]=x*N+w*k+D*W,a[5]=x*I+w*O+D*Y,a[8]=x*A+w*B+D*q,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],o=e[2],a=e[3],u=e[4],f=e[5],p=e[6],m=e[7],v=e[8];return t*u*v-t*f*m-r*a*v+r*f*p+o*a*m-o*u*p}invert(){const e=this.elements,t=e[0],r=e[1],o=e[2],a=e[3],u=e[4],f=e[5],p=e[6],m=e[7],v=e[8],y=v*u-f*m,x=f*p-v*a,w=m*a-u*p,D=t*y+r*x+o*w;if(0===D)return this.set(0,0,0,0,0,0,0,0,0);const N=1/D;return e[0]=y*N,e[1]=(o*m-v*r)*N,e[2]=(f*r-o*u)*N,e[3]=x*N,e[4]=(v*t-o*p)*N,e[5]=(o*a-f*t)*N,e[6]=w*N,e[7]=(r*p-m*t)*N,e[8]=(u*t-r*a)*N,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,o,a,u,f){const p=Math.cos(a),m=Math.sin(a);return this.set(r*p,r*m,-r*(p*u+m*f)+u+e,-o*m,o*p,-o*(-m*u+p*f)+f+t,0,0,1),this}scale(e,t){return this.premultiply(Lu.makeScale(e,t)),this}rotate(e){return this.premultiply(Lu.makeRotation(-e)),this}translate(e,t){return this.premultiply(Lu.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let o=0;o<9;o++)if(t[o]!==r[o])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const Lu=new gn;function Ll(l){for(let e=l.length-1;e>=0;--e)if(l[e]>=65535)return!0;return!1}function _r(l){return document.createElementNS("http://www.w3.org/1999/xhtml",l)}function Wc(){const l=_r("canvas");return l.style.display="block",l}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const Nl={};function To(l){l in Nl||(Nl[l]=!0,console.warn(l))}function ra(l){return l<.04045?.0773993808*l:Math.pow(.9478672986*l+.0521327014,2.4)}function qs(l){return l<.0031308?12.92*l:1.055*Math.pow(l,.41666)-.055}const jc=(new gn).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),Zs=(new gn).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),Ou={[Oi]:l=>l,[_n]:l=>l.convertSRGBToLinear(),[Ta]:function rc(l){return l.convertSRGBToLinear().applyMatrix3(Zs)}},Fu={[Oi]:l=>l,[_n]:l=>l.convertLinearToSRGB(),[Ta]:function Nu(l){return l.applyMatrix3(jc).convertLinearToSRGB()}},sr={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(l){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!l},get workingColorSpace(){return Oi},set workingColorSpace(l){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(l,e,t){if(!1===this.enabled||e===t||!e||!t)return l;const r=Ou[e],o=Fu[t];if(void 0===r||void 0===o)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return o(r(l))},fromWorkingColorSpace:function(l,e){return this.convert(l,this.workingColorSpace,e)},toWorkingColorSpace:function(l,e){return this.convert(l,e,this.workingColorSpace)}};let Rs;class Ks{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Rs&&(Rs=_r("canvas")),Rs.width=e.width,Rs.height=e.height;const r=Rs.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Rs}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=_r("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const o=r.getImageData(0,0,e.width,e.height),a=o.data;for(let u=0;u<a.length;u++)a[u]=255*ra(a[u]/255);return r.putImageData(o,0,0),t}if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t[r]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*ra(t[r]/255)):ra(t[r]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Ol=0;class sc{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Ol++}),this.uuid=Rr(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const r={uuid:this.uuid,url:""},o=this.data;if(null!==o){let a;if(Array.isArray(o)){a=[];for(let u=0,f=o.length;u<f;u++)a.push(Js(o[u].isDataTexture?o[u].image:o[u]))}else a=Js(o);r.url=a}return t||(e.images[this.uuid]=r),r}}function Js(l){return typeof HTMLImageElement<"u"&&l instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&l instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&l instanceof ImageBitmap?Ks.getDataURL(l):l.data?{data:Array.from(l.data),width:l.width,height:l.height,type:l.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Fl=0,b=(()=>{class l extends Pi{constructor(t=l.DEFAULT_IMAGE,r=l.DEFAULT_MAPPING,o=Mt,a=Mt,u=Mi,f=Or,p=ui,m=lr,v=l.DEFAULT_ANISOTROPY,y=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Fl++}),this.uuid=Rr(),this.name="",this.source=new sc(t),this.mipmaps=[],this.mapping=r,this.channel=0,this.wrapS=o,this.wrapT=a,this.magFilter=u,this.minFilter=f,this.anisotropy=v,this.format=p,this.internalFormat=null,this.type=m,this.offset=new Re(0,0),this.repeat=new Re(1,1),this.center=new Re(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new gn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof y?this.colorSpace=y:(To("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=y===$s?_n:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const r=void 0===t||"string"==typeof t;if(!r&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const o={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(o.userData=this.userData),r||(t.textures[this.uuid]=o),o}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case er:t.x=t.x-Math.floor(t.x);break;case Mt:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case er:t.y=t.y-Math.floor(t.y);break;case Mt:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return To("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===_n?$s:3e3}set encoding(t){To("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===$s?_n:""}}return l.DEFAULT_IMAGE=null,l.DEFAULT_MAPPING=300,l.DEFAULT_ANISOTROPY=1,l})();class L{constructor(e=0,t=0,r=0,o=1){L.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=o}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,o){return this.x=e,this.y=t,this.z=r,this.w=o,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,o=this.z,a=this.w,u=e.elements;return this.x=u[0]*t+u[4]*r+u[8]*o+u[12]*a,this.y=u[1]*t+u[5]*r+u[9]*o+u[13]*a,this.z=u[2]*t+u[6]*r+u[10]*o+u[14]*a,this.w=u[3]*t+u[7]*r+u[11]*o+u[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,o,a;const p=e.elements,m=p[0],v=p[4],y=p[8],x=p[1],w=p[5],D=p[9],N=p[2],I=p[6],A=p[10];if(Math.abs(v-x)<.01&&Math.abs(y-N)<.01&&Math.abs(D-I)<.01){if(Math.abs(v+x)<.1&&Math.abs(y+N)<.1&&Math.abs(D+I)<.1&&Math.abs(m+w+A-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const O=(m+1)/2,B=(w+1)/2,W=(A+1)/2,Y=(v+x)/4,q=(y+N)/4,ee=(D+I)/4;return O>B&&O>W?O<.01?(r=0,o=.707106781,a=.707106781):(r=Math.sqrt(O),o=Y/r,a=q/r):B>W?B<.01?(r=.707106781,o=0,a=.707106781):(o=Math.sqrt(B),r=Y/o,a=ee/o):W<.01?(r=.707106781,o=.707106781,a=0):(a=Math.sqrt(W),r=q/a,o=ee/a),this.set(r,o,a,t),this}let k=Math.sqrt((I-D)*(I-D)+(y-N)*(y-N)+(x-v)*(x-v));return Math.abs(k)<.001&&(k=1),this.x=(I-D)/k,this.y=(y-N)/k,this.z=(x-v)/k,this.w=Math.acos((m+w+A-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class K extends Pi{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new L(0,0,e,t),this.scissorTest=!1,this.viewport=new L(0,0,e,t);const o={width:e,height:t,depth:1};void 0!==r.encoding&&(To("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),r.colorSpace=r.encoding===$s?_n:""),this.texture=new b(o,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,this.texture.internalFormat=void 0!==r.internalFormat?r.internalFormat:null,this.texture.minFilter=void 0!==r.minFilter?r.minFilter:Mi,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0!==r.stencilBuffer&&r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null,this.samples=void 0!==r.samples?r.samples:0}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new sc(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class P extends K{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class G extends b{constructor(e=null,t=1,r=1,o=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:o},this.magFilter=Zn,this.minFilter=Zn,this.wrapR=Mt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Ce extends b{constructor(e=null,t=1,r=1,o=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:o},this.magFilter=Zn,this.minFilter=Zn,this.wrapR=Mt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class pn{constructor(e=0,t=0,r=0,o=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=o}static slerpFlat(e,t,r,o,a,u,f){let p=r[o+0],m=r[o+1],v=r[o+2],y=r[o+3];const x=a[u+0],w=a[u+1],D=a[u+2],N=a[u+3];if(0===f)return e[t+0]=p,e[t+1]=m,e[t+2]=v,void(e[t+3]=y);if(1===f)return e[t+0]=x,e[t+1]=w,e[t+2]=D,void(e[t+3]=N);if(y!==N||p!==x||m!==w||v!==D){let I=1-f;const A=p*x+m*w+v*D+y*N,k=A>=0?1:-1,O=1-A*A;if(O>Number.EPSILON){const W=Math.sqrt(O),Y=Math.atan2(W,A*k);I=Math.sin(I*Y)/W,f=Math.sin(f*Y)/W}const B=f*k;if(p=p*I+x*B,m=m*I+w*B,v=v*I+D*B,y=y*I+N*B,I===1-f){const W=1/Math.sqrt(p*p+m*m+v*v+y*y);p*=W,m*=W,v*=W,y*=W}}e[t]=p,e[t+1]=m,e[t+2]=v,e[t+3]=y}static multiplyQuaternionsFlat(e,t,r,o,a,u){const f=r[o],p=r[o+1],m=r[o+2],v=r[o+3],y=a[u],x=a[u+1],w=a[u+2],D=a[u+3];return e[t]=f*D+v*y+p*w-m*x,e[t+1]=p*D+v*x+m*y-f*w,e[t+2]=m*D+v*w+f*x-p*y,e[t+3]=v*D-f*y-p*x-m*w,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,o){return this._x=e,this._y=t,this._z=r,this._w=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const r=e._x,o=e._y,a=e._z,u=e._order,f=Math.cos,p=Math.sin,m=f(r/2),v=f(o/2),y=f(a/2),x=p(r/2),w=p(o/2),D=p(a/2);switch(u){case"XYZ":this._x=x*v*y+m*w*D,this._y=m*w*y-x*v*D,this._z=m*v*D+x*w*y,this._w=m*v*y-x*w*D;break;case"YXZ":this._x=x*v*y+m*w*D,this._y=m*w*y-x*v*D,this._z=m*v*D-x*w*y,this._w=m*v*y+x*w*D;break;case"ZXY":this._x=x*v*y-m*w*D,this._y=m*w*y+x*v*D,this._z=m*v*D+x*w*y,this._w=m*v*y-x*w*D;break;case"ZYX":this._x=x*v*y-m*w*D,this._y=m*w*y+x*v*D,this._z=m*v*D-x*w*y,this._w=m*v*y+x*w*D;break;case"YZX":this._x=x*v*y+m*w*D,this._y=m*w*y+x*v*D,this._z=m*v*D-x*w*y,this._w=m*v*y-x*w*D;break;case"XZY":this._x=x*v*y-m*w*D,this._y=m*w*y-x*v*D,this._z=m*v*D+x*w*y,this._w=m*v*y+x*w*D;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,o=Math.sin(r);return this._x=e.x*o,this._y=e.y*o,this._z=e.z*o,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],o=t[4],a=t[8],u=t[1],f=t[5],p=t[9],m=t[2],v=t[6],y=t[10],x=r+f+y;if(x>0){const w=.5/Math.sqrt(x+1);this._w=.25/w,this._x=(v-p)*w,this._y=(a-m)*w,this._z=(u-o)*w}else if(r>f&&r>y){const w=2*Math.sqrt(1+r-f-y);this._w=(v-p)/w,this._x=.25*w,this._y=(o+u)/w,this._z=(a+m)/w}else if(f>y){const w=2*Math.sqrt(1+f-r-y);this._w=(a-m)/w,this._x=(o+u)/w,this._y=.25*w,this._z=(p+v)/w}else{const w=2*Math.sqrt(1+y-r-f);this._w=(u-o)/w,this._x=(a+m)/w,this._y=(p+v)/w,this._z=.25*w}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Vi(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(0===r)return this;const o=Math.min(1,t/r);return this.slerp(e,o),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,o=e._y,a=e._z,u=e._w,f=t._x,p=t._y,m=t._z,v=t._w;return this._x=r*v+u*f+o*m-a*p,this._y=o*v+u*p+a*f-r*m,this._z=a*v+u*m+r*p-o*f,this._w=u*v-r*f-o*p-a*m,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const r=this._x,o=this._y,a=this._z,u=this._w;let f=u*e._w+r*e._x+o*e._y+a*e._z;if(f<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,f=-f):this.copy(e),f>=1)return this._w=u,this._x=r,this._y=o,this._z=a,this;const p=1-f*f;if(p<=Number.EPSILON){const w=1-t;return this._w=w*u+t*this._w,this._x=w*r+t*this._x,this._y=w*o+t*this._y,this._z=w*a+t*this._z,this.normalize(),this._onChangeCallback(),this}const m=Math.sqrt(p),v=Math.atan2(m,f),y=Math.sin((1-t)*v)/m,x=Math.sin(t*v)/m;return this._w=u*y+this._w*x,this._x=r*y+this._x*x,this._y=o*y+this._y*x,this._z=a*y+this._z*x,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),o=2*Math.PI*Math.random(),a=2*Math.PI*Math.random();return this.set(t*Math.cos(o),r*Math.sin(a),r*Math.cos(a),t*Math.sin(o))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ${constructor(e=0,t=0,r=0){$.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return void 0===r&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Fi.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Fi.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,o=this.z,a=e.elements;return this.x=a[0]*t+a[3]*r+a[6]*o,this.y=a[1]*t+a[4]*r+a[7]*o,this.z=a[2]*t+a[5]*r+a[8]*o,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,o=this.z,a=e.elements,u=1/(a[3]*t+a[7]*r+a[11]*o+a[15]);return this.x=(a[0]*t+a[4]*r+a[8]*o+a[12])*u,this.y=(a[1]*t+a[5]*r+a[9]*o+a[13])*u,this.z=(a[2]*t+a[6]*r+a[10]*o+a[14])*u,this}applyQuaternion(e){const t=this.x,r=this.y,o=this.z,a=e.x,u=e.y,f=e.z,p=e.w,m=p*t+u*o-f*r,v=p*r+f*t-a*o,y=p*o+a*r-u*t,x=-a*t-u*r-f*o;return this.x=m*p+x*-a+v*-f-y*-u,this.y=v*p+x*-u+y*-a-m*-f,this.z=y*p+x*-f+m*-u-v*-a,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,o=this.z,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*o,this.y=a[1]*t+a[5]*r+a[9]*o,this.z=a[2]*t+a[6]*r+a[10]*o,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,o=e.y,a=e.z,u=t.x,f=t.y,p=t.z;return this.x=o*p-a*f,this.y=a*u-r*p,this.z=r*f-o*u,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return Sn.copy(this).projectOnVector(e),this.sub(Sn)}reflect(e){return this.sub(Sn.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Vi(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,o=this.z-e.z;return t*t+r*r+o*o}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const o=Math.sin(t)*e;return this.x=o*Math.sin(r),this.y=Math.cos(t)*e,this.z=o*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),o=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=o,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Sn=new $,Fi=new pn;class Xn{constructor(e=new $(1/0,1/0,1/0),t=new $(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(fr.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(fr.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=fr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),Pr.copy(e.boundingBox),Pr.applyMatrix4(e.matrixWorld),this.union(Pr);else{const o=e.geometry;if(void 0!==o)if(t&&void 0!==o.attributes&&void 0!==o.attributes.position){const a=o.attributes.position;for(let u=0,f=a.count;u<f;u++)fr.fromBufferAttribute(a,u).applyMatrix4(e.matrixWorld),this.expandByPoint(fr)}else null===o.boundingBox&&o.computeBoundingBox(),Pr.copy(o.boundingBox),Pr.applyMatrix4(e.matrixWorld),this.union(Pr)}const r=e.children;for(let o=0,a=r.length;o<a;o++)this.expandByObject(r[o],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,fr),fr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(oc),Na.subVectors(this.max,oc),Zr.subVectors(e.a,oc),or.subVectors(e.b,oc),Vr.subVectors(e.c,oc),Wi.subVectors(or,Zr),ar.subVectors(Vr,or),sa.subVectors(Zr,Vr);let t=[0,-Wi.z,Wi.y,0,-ar.z,ar.y,0,-sa.z,sa.y,Wi.z,0,-Wi.x,ar.z,0,-ar.x,sa.z,0,-sa.x,-Wi.y,Wi.x,0,-ar.y,ar.x,0,-sa.y,sa.x,0];return!(!Uu(t,Zr,or,Vr,Na)||(t=[1,0,0,0,1,0,0,0,1],!Uu(t,Zr,or,Vr,Na)))&&(ac.crossVectors(Wi,ar),t=[ac.x,ac.y,ac.z],Uu(t,Zr,or,Vr,Na))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,fr).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(fr).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(gi[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),gi[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),gi[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),gi[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),gi[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),gi[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),gi[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),gi[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(gi)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const gi=[new $,new $,new $,new $,new $,new $,new $,new $],fr=new $,Pr=new Xn,Zr=new $,or=new $,Vr=new $,Wi=new $,ar=new $,sa=new $,oc=new $,Na=new $,ac=new $,Ao=new $;function Uu(l,e,t,r,o){for(let a=0,u=l.length-3;a<=u;a+=3){Ao.fromArray(l,a);const f=o.x*Math.abs(Ao.x)+o.y*Math.abs(Ao.y)+o.z*Math.abs(Ao.z),p=e.dot(Ao),m=t.dot(Ao),v=r.dot(Ao);if(Math.max(-Math.max(p,m,v),Math.min(p,m,v))>f)return!1}return!0}const ku=new Xn,$c=new $,vs=new $;class zr{constructor(e=new $,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;void 0!==t?r.copy(t):ku.setFromPoints(e).getCenter(r);let o=0;for(let a=0,u=e.length;a<u;a++)o=Math.max(o,r.distanceToSquared(e[a]));return this.radius=Math.sqrt(o),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;$c.subVectors(e,this.center);const t=$c.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),o=.5*(r-this.radius);this.center.addScaledVector($c,o/r),this.radius+=o}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(vs.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint($c.copy(e.center).add(vs)),this.expandByPoint($c.copy(e.center).sub(vs))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Qs=new $,vi=new $,eo=new $,ys=new $,Lr=new $,Ul=new $,kl=new $;class Ps{constructor(e=new $,t=new $(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Qs)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Qs.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Qs.copy(this.origin).addScaledVector(this.direction,t),Qs.distanceToSquared(e))}distanceSqToSegment(e,t,r,o){vi.copy(e).add(t).multiplyScalar(.5),eo.copy(t).sub(e).normalize(),ys.copy(this.origin).sub(vi);const a=.5*e.distanceTo(t),u=-this.direction.dot(eo),f=ys.dot(this.direction),p=-ys.dot(eo),m=ys.lengthSq(),v=Math.abs(1-u*u);let y,x,w,D;if(v>0)if(y=u*p-f,x=u*f-p,D=a*v,y>=0)if(x>=-D)if(x<=D){const N=1/v;y*=N,x*=N,w=y*(y+u*x+2*f)+x*(u*y+x+2*p)+m}else x=a,y=Math.max(0,-(u*x+f)),w=-y*y+x*(x+2*p)+m;else x=-a,y=Math.max(0,-(u*x+f)),w=-y*y+x*(x+2*p)+m;else x<=-D?(y=Math.max(0,-(-u*a+f)),x=y>0?-a:Math.min(Math.max(-a,-p),a),w=-y*y+x*(x+2*p)+m):x<=D?(y=0,x=Math.min(Math.max(-a,-p),a),w=x*(x+2*p)+m):(y=Math.max(0,-(u*a+f)),x=y>0?a:Math.min(Math.max(-a,-p),a),w=-y*y+x*(x+2*p)+m);else x=u>0?-a:a,y=Math.max(0,-(u*x+f)),w=-y*y+x*(x+2*p)+m;return r&&r.copy(this.origin).addScaledVector(this.direction,y),o&&o.copy(vi).addScaledVector(eo,x),w}intersectSphere(e,t){Qs.subVectors(e.center,this.origin);const r=Qs.dot(this.direction),o=Qs.dot(Qs)-r*r,a=e.radius*e.radius;if(o>a)return null;const u=Math.sqrt(a-o),f=r-u,p=r+u;return p<0?null:this.at(f<0?p:f,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return null===r?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,o,a,u,f,p;const m=1/this.direction.x,v=1/this.direction.y,y=1/this.direction.z,x=this.origin;return m>=0?(r=(e.min.x-x.x)*m,o=(e.max.x-x.x)*m):(r=(e.max.x-x.x)*m,o=(e.min.x-x.x)*m),v>=0?(a=(e.min.y-x.y)*v,u=(e.max.y-x.y)*v):(a=(e.max.y-x.y)*v,u=(e.min.y-x.y)*v),r>u||a>o||((a>r||isNaN(r))&&(r=a),(u<o||isNaN(o))&&(o=u),y>=0?(f=(e.min.z-x.z)*y,p=(e.max.z-x.z)*y):(f=(e.max.z-x.z)*y,p=(e.min.z-x.z)*y),r>p||f>o)||((f>r||r!=r)&&(r=f),(p<o||o!=o)&&(o=p),o<0)?null:this.at(r>=0?r:o,t)}intersectsBox(e){return null!==this.intersectBox(e,Qs)}intersectTriangle(e,t,r,o,a){Lr.subVectors(t,e),Ul.subVectors(r,e),kl.crossVectors(Lr,Ul);let f,u=this.direction.dot(kl);if(u>0){if(o)return null;f=1}else{if(!(u<0))return null;f=-1,u=-u}ys.subVectors(this.origin,e);const p=f*this.direction.dot(Ul.crossVectors(ys,Ul));if(p<0)return null;const m=f*this.direction.dot(Lr.cross(ys));if(m<0||p+m>u)return null;const v=-f*ys.dot(kl);return v<0?null:this.at(v/u,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Ht{constructor(e,t,r,o,a,u,f,p,m,v,y,x,w,D,N,I){Ht.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,r,o,a,u,f,p,m,v,y,x,w,D,N,I)}set(e,t,r,o,a,u,f,p,m,v,y,x,w,D,N,I){const A=this.elements;return A[0]=e,A[4]=t,A[8]=r,A[12]=o,A[1]=a,A[5]=u,A[9]=f,A[13]=p,A[2]=m,A[6]=v,A[10]=y,A[14]=x,A[3]=w,A[7]=D,A[11]=N,A[15]=I,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Ht).fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,o=1/cc.setFromMatrixColumn(e,0).length(),a=1/cc.setFromMatrixColumn(e,1).length(),u=1/cc.setFromMatrixColumn(e,2).length();return t[0]=r[0]*o,t[1]=r[1]*o,t[2]=r[2]*o,t[3]=0,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=0,t[8]=r[8]*u,t[9]=r[9]*u,t[10]=r[10]*u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,o=e.y,a=e.z,u=Math.cos(r),f=Math.sin(r),p=Math.cos(o),m=Math.sin(o),v=Math.cos(a),y=Math.sin(a);if("XYZ"===e.order){const x=u*v,w=u*y,D=f*v,N=f*y;t[0]=p*v,t[4]=-p*y,t[8]=m,t[1]=w+D*m,t[5]=x-N*m,t[9]=-f*p,t[2]=N-x*m,t[6]=D+w*m,t[10]=u*p}else if("YXZ"===e.order){const x=p*v,w=p*y,D=m*v,N=m*y;t[0]=x+N*f,t[4]=D*f-w,t[8]=u*m,t[1]=u*y,t[5]=u*v,t[9]=-f,t[2]=w*f-D,t[6]=N+x*f,t[10]=u*p}else if("ZXY"===e.order){const x=p*v,w=p*y,D=m*v,N=m*y;t[0]=x-N*f,t[4]=-u*y,t[8]=D+w*f,t[1]=w+D*f,t[5]=u*v,t[9]=N-x*f,t[2]=-u*m,t[6]=f,t[10]=u*p}else if("ZYX"===e.order){const x=u*v,w=u*y,D=f*v,N=f*y;t[0]=p*v,t[4]=D*m-w,t[8]=x*m+N,t[1]=p*y,t[5]=N*m+x,t[9]=w*m-D,t[2]=-m,t[6]=f*p,t[10]=u*p}else if("YZX"===e.order){const x=u*p,w=u*m,D=f*p,N=f*m;t[0]=p*v,t[4]=N-x*y,t[8]=D*y+w,t[1]=y,t[5]=u*v,t[9]=-f*v,t[2]=-m*v,t[6]=w*y+D,t[10]=x-N*y}else if("XZY"===e.order){const x=u*p,w=u*m,D=f*p,N=f*m;t[0]=p*v,t[4]=-y,t[8]=m*v,t[1]=x*y+N,t[5]=u*v,t[9]=w*y-D,t[2]=D*y-w,t[6]=f*v,t[10]=N*y+x}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Bu,e,oa)}lookAt(e,t,r){const o=this.elements;return as.subVectors(e,t),0===as.lengthSq()&&(as.z=1),as.normalize(),Co.crossVectors(r,as),0===Co.lengthSq()&&(1===Math.abs(r.z)?as.x+=1e-4:as.z+=1e-4,as.normalize(),Co.crossVectors(r,as)),Co.normalize(),Xc.crossVectors(as,Co),o[0]=Co.x,o[4]=Xc.x,o[8]=as.x,o[1]=Co.y,o[5]=Xc.y,o[9]=as.y,o[2]=Co.z,o[6]=Xc.z,o[10]=as.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,o=t.elements,a=this.elements,u=r[0],f=r[4],p=r[8],m=r[12],v=r[1],y=r[5],x=r[9],w=r[13],D=r[2],N=r[6],I=r[10],A=r[14],k=r[3],O=r[7],B=r[11],W=r[15],Y=o[0],q=o[4],ee=o[8],z=o[12],Z=o[1],fe=o[5],He=o[9],he=o[13],pe=o[2],ve=o[6],Xe=o[10],Ue=o[14],ze=o[3],Ye=o[7],et=o[11],Rt=o[15];return a[0]=u*Y+f*Z+p*pe+m*ze,a[4]=u*q+f*fe+p*ve+m*Ye,a[8]=u*ee+f*He+p*Xe+m*et,a[12]=u*z+f*he+p*Ue+m*Rt,a[1]=v*Y+y*Z+x*pe+w*ze,a[5]=v*q+y*fe+x*ve+w*Ye,a[9]=v*ee+y*He+x*Xe+w*et,a[13]=v*z+y*he+x*Ue+w*Rt,a[2]=D*Y+N*Z+I*pe+A*ze,a[6]=D*q+N*fe+I*ve+A*Ye,a[10]=D*ee+N*He+I*Xe+A*et,a[14]=D*z+N*he+I*Ue+A*Rt,a[3]=k*Y+O*Z+B*pe+W*ze,a[7]=k*q+O*fe+B*ve+W*Ye,a[11]=k*ee+O*He+B*Xe+W*et,a[15]=k*z+O*he+B*Ue+W*Rt,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],o=e[8],a=e[12],u=e[1],f=e[5],p=e[9],m=e[13],v=e[2],y=e[6],x=e[10],w=e[14];return e[3]*(+a*p*y-o*m*y-a*f*x+r*m*x+o*f*w-r*p*w)+e[7]*(+t*p*w-t*m*x+a*u*x-o*u*w+o*m*v-a*p*v)+e[11]*(+t*m*y-t*f*w-a*u*y+r*u*w+a*f*v-r*m*v)+e[15]*(-o*f*v-t*p*y+t*f*x+o*u*y-r*u*x+r*p*v)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const o=this.elements;return e.isVector3?(o[12]=e.x,o[13]=e.y,o[14]=e.z):(o[12]=e,o[13]=t,o[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],o=e[2],a=e[3],u=e[4],f=e[5],p=e[6],m=e[7],v=e[8],y=e[9],x=e[10],w=e[11],D=e[12],N=e[13],I=e[14],A=e[15],k=y*I*m-N*x*m+N*p*w-f*I*w-y*p*A+f*x*A,O=D*x*m-v*I*m-D*p*w+u*I*w+v*p*A-u*x*A,B=v*N*m-D*y*m+D*f*w-u*N*w-v*f*A+u*y*A,W=D*y*p-v*N*p-D*f*x+u*N*x+v*f*I-u*y*I,Y=t*k+r*O+o*B+a*W;if(0===Y)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const q=1/Y;return e[0]=k*q,e[1]=(N*x*a-y*I*a-N*o*w+r*I*w+y*o*A-r*x*A)*q,e[2]=(f*I*a-N*p*a+N*o*m-r*I*m-f*o*A+r*p*A)*q,e[3]=(y*p*a-f*x*a-y*o*m+r*x*m+f*o*w-r*p*w)*q,e[4]=O*q,e[5]=(v*I*a-D*x*a+D*o*w-t*I*w-v*o*A+t*x*A)*q,e[6]=(D*p*a-u*I*a-D*o*m+t*I*m+u*o*A-t*p*A)*q,e[7]=(u*x*a-v*p*a+v*o*m-t*x*m-u*o*w+t*p*w)*q,e[8]=B*q,e[9]=(D*y*a-v*N*a-D*r*w+t*N*w+v*r*A-t*y*A)*q,e[10]=(u*N*a-D*f*a+D*r*m-t*N*m-u*r*A+t*f*A)*q,e[11]=(v*f*a-u*y*a-v*r*m+t*y*m+u*r*w-t*f*w)*q,e[12]=W*q,e[13]=(v*N*o-D*y*o+D*r*x-t*N*x-v*r*I+t*y*I)*q,e[14]=(D*f*o-u*N*o-D*r*p+t*N*p+u*r*I-t*f*I)*q,e[15]=(u*y*o-v*f*o+v*r*p-t*y*p-u*r*x+t*f*x)*q,this}scale(e){const t=this.elements,r=e.x,o=e.y,a=e.z;return t[0]*=r,t[4]*=o,t[8]*=a,t[1]*=r,t[5]*=o,t[9]*=a,t[2]*=r,t[6]*=o,t[10]*=a,t[3]*=r,t[7]*=o,t[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),o=Math.sin(t),a=1-r,u=e.x,f=e.y,p=e.z,m=a*u,v=a*f;return this.set(m*u+r,m*f-o*p,m*p+o*f,0,m*f+o*p,v*f+r,v*p-o*u,0,m*p-o*f,v*p+o*u,a*p*p+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,o,a,u){return this.set(1,r,a,0,e,1,u,0,t,o,1,0,0,0,0,1),this}compose(e,t,r){const o=this.elements,a=t._x,u=t._y,f=t._z,p=t._w,m=a+a,v=u+u,y=f+f,x=a*m,w=a*v,D=a*y,N=u*v,I=u*y,A=f*y,k=p*m,O=p*v,B=p*y,W=r.x,Y=r.y,q=r.z;return o[0]=(1-(N+A))*W,o[1]=(w+B)*W,o[2]=(D-O)*W,o[3]=0,o[4]=(w-B)*Y,o[5]=(1-(x+A))*Y,o[6]=(I+k)*Y,o[7]=0,o[8]=(D+O)*q,o[9]=(I-k)*q,o[10]=(1-(x+N))*q,o[11]=0,o[12]=e.x,o[13]=e.y,o[14]=e.z,o[15]=1,this}decompose(e,t,r){const o=this.elements;let a=cc.set(o[0],o[1],o[2]).length();const u=cc.set(o[4],o[5],o[6]).length(),f=cc.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),e.x=o[12],e.y=o[13],e.z=o[14],_s.copy(this);const m=1/a,v=1/u,y=1/f;return _s.elements[0]*=m,_s.elements[1]*=m,_s.elements[2]*=m,_s.elements[4]*=v,_s.elements[5]*=v,_s.elements[6]*=v,_s.elements[8]*=y,_s.elements[9]*=y,_s.elements[10]*=y,t.setFromRotationMatrix(_s),r.x=a,r.y=u,r.z=f,this}makePerspective(e,t,r,o,a,u,f=bo){const p=this.elements,m=2*a/(t-e),v=2*a/(r-o),y=(t+e)/(t-e),x=(r+o)/(r-o);let w,D;if(f===bo)w=-(u+a)/(u-a),D=-2*u*a/(u-a);else{if(2001!==f)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+f);w=-u/(u-a),D=-u*a/(u-a)}return p[0]=m,p[4]=0,p[8]=y,p[12]=0,p[1]=0,p[5]=v,p[9]=x,p[13]=0,p[2]=0,p[6]=0,p[10]=w,p[14]=D,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,t,r,o,a,u,f=bo){const p=this.elements,m=1/(t-e),v=1/(r-o),y=1/(u-a),x=(t+e)*m,w=(r+o)*v;let D,N;if(f===bo)D=(u+a)*y,N=-2*y;else{if(2001!==f)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+f);D=a*y,N=-1*y}return p[0]=2*m,p[4]=0,p[8]=0,p[12]=-x,p[1]=0,p[5]=2*v,p[9]=0,p[13]=-w,p[2]=0,p[6]=0,p[10]=N,p[14]=-D,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let o=0;o<16;o++)if(t[o]!==r[o])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const cc=new $,_s=new Ht,Bu=new $(0,0,0),oa=new $(1,1,1),Co=new $,Xc=new $,as=new $,tf=new Ht,Hu=new pn;let Vu=(()=>{class l{constructor(t=0,r=0,o=0,a=l.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=r,this._z=o,this._order=a}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,r,o,a=this._order){return this._x=t,this._y=r,this._z=o,this._order=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,r=this._order,o=!0){const a=t.elements,u=a[0],f=a[4],p=a[8],m=a[1],v=a[5],y=a[9],x=a[2],w=a[6],D=a[10];switch(r){case"XYZ":this._y=Math.asin(Vi(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-y,D),this._z=Math.atan2(-f,u)):(this._x=Math.atan2(w,v),this._z=0);break;case"YXZ":this._x=Math.asin(-Vi(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(p,D),this._z=Math.atan2(m,v)):(this._y=Math.atan2(-x,u),this._z=0);break;case"ZXY":this._x=Math.asin(Vi(w,-1,1)),Math.abs(w)<.9999999?(this._y=Math.atan2(-x,D),this._z=Math.atan2(-f,v)):(this._y=0,this._z=Math.atan2(m,u));break;case"ZYX":this._y=Math.asin(-Vi(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(w,D),this._z=Math.atan2(m,u)):(this._x=0,this._z=Math.atan2(-f,v));break;case"YZX":this._z=Math.asin(Vi(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(-y,v),this._y=Math.atan2(-x,u)):(this._x=0,this._y=Math.atan2(p,D));break;case"XZY":this._z=Math.asin(-Vi(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(w,v),this._y=Math.atan2(p,u)):(this._x=Math.atan2(-y,D),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+r)}return this._order=r,!0===o&&this._onChangeCallback(),this}setFromQuaternion(t,r,o){return tf.makeRotationFromQuaternion(t),this.setFromRotationMatrix(tf,r,o)}setFromVector3(t,r=this._order){return this.set(t.x,t.y,t.z,r)}reorder(t){return Hu.setFromEuler(this),this.setFromQuaternion(Hu,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],r=0){return t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,t[r+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return l.DEFAULT_ORDER="XYZ",l})();class an{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let zh=0;const nf=new $,Kr=new pn,Do=new Ht,zu=new $,Yc=new $,qc=new $,rf=new pn,Gu=new $(1,0,0),Bl=new $(0,1,0),sf=new $(0,0,1),Gh={type:"added"},qe={type:"removed"};let sn=(()=>{class l extends Pi{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:zh++}),this.uuid=Rr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=l.DEFAULT_UP.clone();const t=new $,r=new Vu,o=new pn,a=new $(1,1,1);r._onChange(function u(){o.setFromEuler(r,!1)}),o._onChange(function f(){r.setFromQuaternion(o,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:o},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new Ht},normalMatrix:{value:new gn}}),this.matrix=new Ht,this.matrixWorld=new Ht,this.matrixAutoUpdate=l.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=l.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new an,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,r){this.quaternion.setFromAxisAngle(t,r)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,r){return Kr.setFromAxisAngle(t,r),this.quaternion.multiply(Kr),this}rotateOnWorldAxis(t,r){return Kr.setFromAxisAngle(t,r),this.quaternion.premultiply(Kr),this}rotateX(t){return this.rotateOnAxis(Gu,t)}rotateY(t){return this.rotateOnAxis(Bl,t)}rotateZ(t){return this.rotateOnAxis(sf,t)}translateOnAxis(t,r){return nf.copy(t).applyQuaternion(this.quaternion),this.position.add(nf.multiplyScalar(r)),this}translateX(t){return this.translateOnAxis(Gu,t)}translateY(t){return this.translateOnAxis(Bl,t)}translateZ(t){return this.translateOnAxis(sf,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Do.copy(this.matrixWorld).invert())}lookAt(t,r,o){t.isVector3?zu.copy(t):zu.set(t,r,o);const a=this.parent;this.updateWorldMatrix(!0,!1),Yc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Do.lookAt(Yc,zu,this.up):Do.lookAt(zu,Yc,this.up),this.quaternion.setFromRotationMatrix(Do),a&&(Do.extractRotation(a.matrixWorld),Kr.setFromRotationMatrix(Do),this.quaternion.premultiply(Kr.invert()))}add(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Gh)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.remove(arguments[o]);return this}const r=this.children.indexOf(t);return-1!==r&&(t.parent=null,this.children.splice(r,1),t.dispatchEvent(qe)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Do.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Do.multiply(t.parent.matrixWorld)),t.applyMatrix4(Do),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,r){if(this[t]===r)return this;for(let o=0,a=this.children.length;o<a;o++){const f=this.children[o].getObjectByProperty(t,r);if(void 0!==f)return f}}getObjectsByProperty(t,r){let o=[];this[t]===r&&o.push(this);for(let a=0,u=this.children.length;a<u;a++){const f=this.children[a].getObjectsByProperty(t,r);f.length>0&&(o=o.concat(f))}return o}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Yc,t,qc),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Yc,rf,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const r=this.matrixWorld.elements;return t.set(r[8],r[9],r[10]).normalize()}raycast(){}traverse(t){t(this);const r=this.children;for(let o=0,a=r.length;o<a;o++)r[o].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const r=this.children;for(let o=0,a=r.length;o<a;o++)r[o].traverseVisible(t)}traverseAncestors(t){const r=this.parent;null!==r&&(t(r),r.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const r=this.children;for(let o=0,a=r.length;o<a;o++){const u=r[o];(!0===u.matrixWorldAutoUpdate||!0===t)&&u.updateMatrixWorld(t)}}updateWorldMatrix(t,r){const o=this.parent;if(!0===t&&null!==o&&!0===o.matrixWorldAutoUpdate&&o.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===r){const a=this.children;for(let u=0,f=a.length;u<f;u++){const p=a[u];!0===p.matrixWorldAutoUpdate&&p.updateWorldMatrix(!1,!0)}}}toJSON(t){const r=void 0===t||"string"==typeof t,o={};r&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},o.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const a={};function u(p,m){return void 0===p[m.uuid]&&(p[m.uuid]=m.toJSON(t)),m.uuid}if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),!0===this.castShadow&&(a.castShadow=!0),!0===this.receiveShadow&&(a.receiveShadow=!0),!1===this.visible&&(a.visible=!1),!1===this.frustumCulled&&(a.frustumCulled=!1),0!==this.renderOrder&&(a.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),a.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(a.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?a.background=this.background.toJSON():this.background.isTexture&&(a.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(a.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){a.geometry=u(t.geometries,this.geometry);const p=this.geometry.parameters;if(void 0!==p&&void 0!==p.shapes){const m=p.shapes;if(Array.isArray(m))for(let v=0,y=m.length;v<y;v++)u(t.shapes,m[v]);else u(t.shapes,m)}}if(this.isSkinnedMesh&&(a.bindMode=this.bindMode,a.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(u(t.skeletons,this.skeleton),a.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const p=[];for(let m=0,v=this.material.length;m<v;m++)p.push(u(t.materials,this.material[m]));a.material=p}else a.material=u(t.materials,this.material);if(this.children.length>0){a.children=[];for(let p=0;p<this.children.length;p++)a.children.push(this.children[p].toJSON(t).object)}if(this.animations.length>0){a.animations=[];for(let p=0;p<this.animations.length;p++)a.animations.push(u(t.animations,this.animations[p]))}if(r){const p=f(t.geometries),m=f(t.materials),v=f(t.textures),y=f(t.images),x=f(t.shapes),w=f(t.skeletons),D=f(t.animations),N=f(t.nodes);p.length>0&&(o.geometries=p),m.length>0&&(o.materials=m),v.length>0&&(o.textures=v),y.length>0&&(o.images=y),x.length>0&&(o.shapes=x),w.length>0&&(o.skeletons=w),D.length>0&&(o.animations=D),N.length>0&&(o.nodes=N)}return o.object=a,o;function f(p){const m=[];for(const v in p){const y=p[v];delete y.metadata,m.push(y)}return m}}clone(t){return(new this.constructor).copy(this,t)}copy(t,r=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===r)for(let o=0;o<t.children.length;o++)this.add(t.children[o].clone());return this}}return l.DEFAULT_UP=new $(0,1,0),l.DEFAULT_MATRIX_AUTO_UPDATE=!0,l.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,l})();const Ls=new $,aa=new $,hr=new $,Io=new $,to=new $,Jr=new $,Zc=new $,Kc=new $,Wu=new $,af=new $;let Jc=!1;class Ei{constructor(e=new $,t=new $,r=new $){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,o){o.subVectors(r,t),Ls.subVectors(e,t),o.cross(Ls);const a=o.lengthSq();return a>0?o.multiplyScalar(1/Math.sqrt(a)):o.set(0,0,0)}static getBarycoord(e,t,r,o,a){Ls.subVectors(o,t),aa.subVectors(r,t),hr.subVectors(e,t);const u=Ls.dot(Ls),f=Ls.dot(aa),p=Ls.dot(hr),m=aa.dot(aa),v=aa.dot(hr),y=u*m-f*f;if(0===y)return a.set(-2,-1,-1);const x=1/y,w=(m*p-f*v)*x,D=(u*v-f*p)*x;return a.set(1-w-D,D,w)}static containsPoint(e,t,r,o){return this.getBarycoord(e,t,r,o,Io),Io.x>=0&&Io.y>=0&&Io.x+Io.y<=1}static getUV(e,t,r,o,a,u,f,p){return!1===Jc&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Jc=!0),this.getInterpolation(e,t,r,o,a,u,f,p)}static getInterpolation(e,t,r,o,a,u,f,p){return this.getBarycoord(e,t,r,o,Io),p.setScalar(0),p.addScaledVector(a,Io.x),p.addScaledVector(u,Io.y),p.addScaledVector(f,Io.z),p}static isFrontFacing(e,t,r,o){return Ls.subVectors(r,t),aa.subVectors(e,t),Ls.cross(aa).dot(o)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,o){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[o]),this}setFromAttributeAndIndices(e,t,r,o){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,o),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ls.subVectors(this.c,this.b),aa.subVectors(this.a,this.b),.5*Ls.cross(aa).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ei.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Ei.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,o,a){return!1===Jc&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Jc=!0),Ei.getInterpolation(e,this.a,this.b,this.c,t,r,o,a)}getInterpolation(e,t,r,o,a){return Ei.getInterpolation(e,this.a,this.b,this.c,t,r,o,a)}containsPoint(e){return Ei.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ei.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,o=this.b,a=this.c;let u,f;to.subVectors(o,r),Jr.subVectors(a,r),Kc.subVectors(e,r);const p=to.dot(Kc),m=Jr.dot(Kc);if(p<=0&&m<=0)return t.copy(r);Wu.subVectors(e,o);const v=to.dot(Wu),y=Jr.dot(Wu);if(v>=0&&y<=v)return t.copy(o);const x=p*y-v*m;if(x<=0&&p>=0&&v<=0)return u=p/(p-v),t.copy(r).addScaledVector(to,u);af.subVectors(e,a);const w=to.dot(af),D=Jr.dot(af);if(D>=0&&w<=D)return t.copy(a);const N=w*m-p*D;if(N<=0&&m>=0&&D<=0)return f=m/(m-D),t.copy(r).addScaledVector(Jr,f);const I=v*D-w*y;if(I<=0&&y-v>=0&&w-D>=0)return Zc.subVectors(a,o),f=(y-v)/(y-v+(w-D)),t.copy(o).addScaledVector(Zc,f);const A=1/(I+N+x);return u=N*A,f=x*A,t.copy(r).addScaledVector(to,u).addScaledVector(Jr,f)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Ro=0;class Ms extends Pi{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Ro++}),this.uuid=Rr(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const r=e[t];if(void 0===r){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const o=this[t];void 0!==o?o&&o.isColor?o.set(r):o&&o.isVector3&&r&&r.isVector3?o.copy(r):this[t]=r:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function o(a){const u=[];for(const f in a){const p=a[f];delete p.metadata,u.push(p)}return u}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(r.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(r.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(r.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),0!==this.side&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaHash&&(r.alphaHash=this.alphaHash),!0===this.alphaToCoverage&&(r.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(r.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=this.flatShading),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),!1===this.fog&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData),t){const a=o(e.textures),u=o(e.images);a.length>0&&(r.textures=a),u.length>0&&(r.images=u)}return r}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(null!==t){const o=t.length;r=new Array(o);for(let a=0;a!==o;++a)r[a]=t[a].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const Oa={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Xi={h:0,s:0,l:0},Hl={h:0,s:0,l:0};function ju(l,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?l+6*(e-l)*t:t<.5?e:t<2/3?l+6*(e-l)*(2/3-t):l}class It{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(void 0===t&&void 0===r){const o=e;o&&o.isColor?this.copy(o):"number"==typeof o?this.setHex(o):"string"==typeof o&&this.setStyle(o)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=_n){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,sr.toWorkingColorSpace(this,t),this}setRGB(e,t,r,o=sr.workingColorSpace){return this.r=e,this.g=t,this.b=r,sr.toWorkingColorSpace(this,o),this}setHSL(e,t,r,o=sr.workingColorSpace){if(e=Vc(e,1),t=Vi(t,0,1),r=Vi(r,0,1),0===t)this.r=this.g=this.b=r;else{const a=r<=.5?r*(1+t):r+t-r*t,u=2*r-a;this.r=ju(u,a,e+1/3),this.g=ju(u,a,e),this.b=ju(u,a,e-1/3)}return sr.toWorkingColorSpace(this,o),this}setStyle(e,t=_n){function r(a){void 0!==a&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let o;if(o=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const f=o[2];switch(o[1]){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return r(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,t);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return r(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,t);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return r(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=o[1],u=a.length;if(3===u)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,t);if(6===u)return this.setHex(parseInt(a,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=_n){const r=Oa[e.toLowerCase()];return void 0!==r?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ra(e.r),this.g=ra(e.g),this.b=ra(e.b),this}copyLinearToSRGB(e){return this.r=qs(e.r),this.g=qs(e.g),this.b=qs(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=_n){return sr.fromWorkingColorSpace(Gr.copy(this),e),65536*Math.round(Vi(255*Gr.r,0,255))+256*Math.round(Vi(255*Gr.g,0,255))+Math.round(Vi(255*Gr.b,0,255))}getHexString(e=_n){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=sr.workingColorSpace){sr.fromWorkingColorSpace(Gr.copy(this),t);const r=Gr.r,o=Gr.g,a=Gr.b,u=Math.max(r,o,a),f=Math.min(r,o,a);let p,m;const v=(f+u)/2;if(f===u)p=0,m=0;else{const y=u-f;switch(m=v<=.5?y/(u+f):y/(2-u-f),u){case r:p=(o-a)/y+(o<a?6:0);break;case o:p=(a-r)/y+2;break;case a:p=(r-o)/y+4}p/=6}return e.h=p,e.s=m,e.l=v,e}getRGB(e,t=sr.workingColorSpace){return sr.fromWorkingColorSpace(Gr.copy(this),t),e.r=Gr.r,e.g=Gr.g,e.b=Gr.b,e}getStyle(e=_n){sr.fromWorkingColorSpace(Gr.copy(this),e);const t=Gr.r,r=Gr.g,o=Gr.b;return e!==_n?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${o.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*r)},${Math.round(255*o)})`}offsetHSL(e,t,r){return this.getHSL(Xi),Xi.h+=e,Xi.s+=t,Xi.l+=r,this.setHSL(Xi.h,Xi.s,Xi.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Xi),e.getHSL(Hl);const r=ec(Xi.h,Hl.h,t),o=ec(Xi.s,Hl.s,t),a=ec(Xi.l,Hl.l,t);return this.setHSL(r,o,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,o=this.b,a=e.elements;return this.r=a[0]*t+a[3]*r+a[6]*o,this.g=a[1]*t+a[4]*r+a[7]*o,this.b=a[2]*t+a[5]*r+a[8]*o,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Gr=new It;It.NAMES=Oa;class cs extends Ms{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new It(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=nn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const E=new $,R=new Re;class H{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=r,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=_e,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let o=0,a=this.itemSize;o<a;o++)this.array[e+o]=t.array[r+o];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,r=this.count;t<r;t++)R.fromBufferAttribute(this,t),R.applyMatrix3(e),this.setXY(t,R.x,R.y);else if(3===this.itemSize)for(let t=0,r=this.count;t<r;t++)E.fromBufferAttribute(this,t),E.applyMatrix3(e),this.setXYZ(t,E.x,E.y,E.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)E.fromBufferAttribute(this,t),E.applyMatrix4(e),this.setXYZ(t,E.x,E.y,E.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)E.fromBufferAttribute(this,t),E.applyNormalMatrix(e),this.setXYZ(t,E.x,E.y,E.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)E.fromBufferAttribute(this,t),E.transformDirection(e),this.setXYZ(t,E.x,E.y,E.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=Hr(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=En(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Hr(t,this.array)),t}setX(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Hr(t,this.array)),t}setY(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Hr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Hr(t,this.array)),t}setW(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),r=En(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,o){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),r=En(r,this.array),o=En(o,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=o,this}setXYZW(e,t,r,o,a){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),r=En(r,this.array),o=En(o,this.array),a=En(a,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=o,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class $t extends H{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class Ti extends H{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class Ot extends H{constructor(e,t,r){super(new Float32Array(e),t,r)}}let zl=0;const Mr=new Ht,Gl=new sn,Fa=new $,Qr=new Xn,io=new Xn,Nr=new $;class Bn extends Pi{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:zl++}),this.uuid=Rr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(Ll(e)?Ti:$t)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(void 0!==r){const a=(new gn).getNormalMatrix(e);r.applyNormalMatrix(a),r.needsUpdate=!0}const o=this.attributes.tangent;return void 0!==o&&(o.transformDirection(e),o.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Mr.makeRotationFromQuaternion(e),this.applyMatrix4(Mr),this}rotateX(e){return Mr.makeRotationX(e),this.applyMatrix4(Mr),this}rotateY(e){return Mr.makeRotationY(e),this.applyMatrix4(Mr),this}rotateZ(e){return Mr.makeRotationZ(e),this.applyMatrix4(Mr),this}translate(e,t,r){return Mr.makeTranslation(e,t,r),this.applyMatrix4(Mr),this}scale(e,t,r){return Mr.makeScale(e,t,r),this.applyMatrix4(Mr),this}lookAt(e){return Gl.lookAt(e),Gl.updateMatrix(),this.applyMatrix4(Gl.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Fa).negate(),this.translate(Fa.x,Fa.y,Fa.z),this}setFromPoints(e){const t=[];for(let r=0,o=e.length;r<o;r++){const a=e[r];t.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new Ot(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Xn);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new $(-1/0,-1/0,-1/0),new $(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,o=t.length;r<o;r++)Qr.setFromBufferAttribute(t[r]),this.morphTargetsRelative?(Nr.addVectors(this.boundingBox.min,Qr.min),this.boundingBox.expandByPoint(Nr),Nr.addVectors(this.boundingBox.max,Qr.max),this.boundingBox.expandByPoint(Nr)):(this.boundingBox.expandByPoint(Qr.min),this.boundingBox.expandByPoint(Qr.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new zr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new $,1/0);if(e){const r=this.boundingSphere.center;if(Qr.setFromBufferAttribute(e),t)for(let a=0,u=t.length;a<u;a++)io.setFromBufferAttribute(t[a]),this.morphTargetsRelative?(Nr.addVectors(Qr.min,io.min),Qr.expandByPoint(Nr),Nr.addVectors(Qr.max,io.max),Qr.expandByPoint(Nr)):(Qr.expandByPoint(io.min),Qr.expandByPoint(io.max));Qr.getCenter(r);let o=0;for(let a=0,u=e.count;a<u;a++)Nr.fromBufferAttribute(e,a),o=Math.max(o,r.distanceToSquared(Nr));if(t)for(let a=0,u=t.length;a<u;a++){const f=t[a],p=this.morphTargetsRelative;for(let m=0,v=f.count;m<v;m++)Nr.fromBufferAttribute(f,m),p&&(Fa.fromBufferAttribute(e,m),Nr.add(Fa)),o=Math.max(o,r.distanceToSquared(Nr))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const r=e.array,o=t.position.array,a=t.normal.array,u=t.uv.array,f=o.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new H(new Float32Array(4*f),4));const p=this.getAttribute("tangent").array,m=[],v=[];for(let Z=0;Z<f;Z++)m[Z]=new $,v[Z]=new $;const y=new $,x=new $,w=new $,D=new Re,N=new Re,I=new Re,A=new $,k=new $;function O(Z,fe,He){y.fromArray(o,3*Z),x.fromArray(o,3*fe),w.fromArray(o,3*He),D.fromArray(u,2*Z),N.fromArray(u,2*fe),I.fromArray(u,2*He),x.sub(y),w.sub(y),N.sub(D),I.sub(D);const he=1/(N.x*I.y-I.x*N.y);isFinite(he)&&(A.copy(x).multiplyScalar(I.y).addScaledVector(w,-N.y).multiplyScalar(he),k.copy(w).multiplyScalar(N.x).addScaledVector(x,-I.x).multiplyScalar(he),m[Z].add(A),m[fe].add(A),m[He].add(A),v[Z].add(k),v[fe].add(k),v[He].add(k))}let B=this.groups;0===B.length&&(B=[{start:0,count:r.length}]);for(let Z=0,fe=B.length;Z<fe;++Z){const He=B[Z],he=He.start;for(let ve=he,Xe=he+He.count;ve<Xe;ve+=3)O(r[ve+0],r[ve+1],r[ve+2])}const W=new $,Y=new $,q=new $,ee=new $;function z(Z){q.fromArray(a,3*Z),ee.copy(q);const fe=m[Z];W.copy(fe),W.sub(q.multiplyScalar(q.dot(fe))).normalize(),Y.crossVectors(ee,fe);const he=Y.dot(v[Z])<0?-1:1;p[4*Z]=W.x,p[4*Z+1]=W.y,p[4*Z+2]=W.z,p[4*Z+3]=he}for(let Z=0,fe=B.length;Z<fe;++Z){const He=B[Z],he=He.start;for(let ve=he,Xe=he+He.count;ve<Xe;ve+=3)z(r[ve+0]),z(r[ve+1]),z(r[ve+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let r=this.getAttribute("normal");if(void 0===r)r=new H(new Float32Array(3*t.count),3),this.setAttribute("normal",r);else for(let x=0,w=r.count;x<w;x++)r.setXYZ(x,0,0,0);const o=new $,a=new $,u=new $,f=new $,p=new $,m=new $,v=new $,y=new $;if(e)for(let x=0,w=e.count;x<w;x+=3){const D=e.getX(x+0),N=e.getX(x+1),I=e.getX(x+2);o.fromBufferAttribute(t,D),a.fromBufferAttribute(t,N),u.fromBufferAttribute(t,I),v.subVectors(u,a),y.subVectors(o,a),v.cross(y),f.fromBufferAttribute(r,D),p.fromBufferAttribute(r,N),m.fromBufferAttribute(r,I),f.add(v),p.add(v),m.add(v),r.setXYZ(D,f.x,f.y,f.z),r.setXYZ(N,p.x,p.y,p.z),r.setXYZ(I,m.x,m.y,m.z)}else for(let x=0,w=t.count;x<w;x+=3)o.fromBufferAttribute(t,x+0),a.fromBufferAttribute(t,x+1),u.fromBufferAttribute(t,x+2),v.subVectors(u,a),y.subVectors(o,a),v.cross(y),r.setXYZ(x+0,v.x,v.y,v.z),r.setXYZ(x+1,v.x,v.y,v.z),r.setXYZ(x+2,v.x,v.y,v.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)Nr.fromBufferAttribute(e,t),Nr.normalize(),e.setXYZ(t,Nr.x,Nr.y,Nr.z)}toNonIndexed(){function e(f,p){const m=f.array,v=f.itemSize,y=f.normalized,x=new m.constructor(p.length*v);let w=0,D=0;for(let N=0,I=p.length;N<I;N++){w=f.isInterleavedBufferAttribute?p[N]*f.data.stride+f.offset:p[N]*v;for(let A=0;A<v;A++)x[D++]=m[w++]}return new H(x,v,y)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Bn,r=this.index.array,o=this.attributes;for(const f in o){const m=e(o[f],r);t.setAttribute(f,m)}const a=this.morphAttributes;for(const f in a){const p=[],m=a[f];for(let v=0,y=m.length;v<y;v++){const w=e(m[v],r);p.push(w)}t.morphAttributes[f]=p}t.morphTargetsRelative=this.morphTargetsRelative;const u=this.groups;for(let f=0,p=u.length;f<p;f++){const m=u[f];t.addGroup(m.start,m.count,m.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const p=this.parameters;for(const m in p)void 0!==p[m]&&(e[m]=p[m]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const p in r)e.data.attributes[p]=r[p].toJSON(e.data);const o={};let a=!1;for(const p in this.morphAttributes){const m=this.morphAttributes[p],v=[];for(let y=0,x=m.length;y<x;y++)v.push(m[y].toJSON(e.data));v.length>0&&(o[p]=v,a=!0)}a&&(e.data.morphAttributes=o,e.data.morphTargetsRelative=this.morphTargetsRelative);const u=this.groups;u.length>0&&(e.data.groups=JSON.parse(JSON.stringify(u)));const f=this.boundingSphere;return null!==f&&(e.data.boundingSphere={center:f.center.toArray(),radius:f.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;null!==r&&this.setIndex(r.clone(t));const o=e.attributes;for(const m in o)this.setAttribute(m,o[m].clone(t));const a=e.morphAttributes;for(const m in a){const v=[],y=a[m];for(let x=0,w=y.length;x<w;x++)v.push(y[x].clone(t));this.morphAttributes[m]=v}this.morphTargetsRelative=e.morphTargetsRelative;const u=e.groups;for(let m=0,v=u.length;m<v;m++){const y=u[m];this.addGroup(y.start,y.count,y.materialIndex)}const f=e.boundingBox;null!==f&&(this.boundingBox=f.clone());const p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const $u=new Ht,ca=new Ps,Wl=new zr,jh=new $,Qc=new $,jl=new $,Po=new $,el=new $,cf=new $,$h=new Re,$l=new Re,Xh=new Re,km=new $,Bm=new $,Hy=new $,Yh=new $,Xl=new $;class pr extends sn{constructor(e=new Bn,t=new cs){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const o=t[r[0]];if(void 0!==o){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,u=o.length;a<u;a++){const f=o[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=a}}}}getVertexPosition(e,t){const r=this.geometry,a=r.morphAttributes.position,u=r.morphTargetsRelative;t.fromBufferAttribute(r.attributes.position,e);const f=this.morphTargetInfluences;if(a&&f){cf.set(0,0,0);for(let p=0,m=a.length;p<m;p++){const v=f[p];0!==v&&(el.fromBufferAttribute(a[p],e),cf.addScaledVector(u?el:el.sub(t),v))}t.add(cf)}return t}raycast(e,t){const r=this.geometry,a=this.matrixWorld;void 0!==this.material&&(null===r.boundingSphere&&r.computeBoundingSphere(),Wl.copy(r.boundingSphere),Wl.applyMatrix4(a),ca.copy(e.ray).recast(e.near),(!1!==Wl.containsPoint(ca.origin)||!(null===ca.intersectSphere(Wl,jh)||ca.origin.distanceToSquared(jh)>(e.far-e.near)**2))&&($u.copy(a).invert(),ca.copy(e.ray).applyMatrix4($u),(null===r.boundingBox||!1!==ca.intersectsBox(r.boundingBox))&&this._computeIntersections(e,t,ca)))}_computeIntersections(e,t,r){let o;const a=this.geometry,u=this.material,f=a.index,p=a.attributes.position,m=a.attributes.uv,v=a.attributes.uv1,y=a.attributes.normal,x=a.groups,w=a.drawRange;if(null!==f)if(Array.isArray(u))for(let D=0,N=x.length;D<N;D++){const I=x[D],A=u[I.materialIndex];for(let B=Math.max(I.start,w.start),W=Math.min(f.count,Math.min(I.start+I.count,w.start+w.count));B<W;B+=3)o=lc(this,A,e,r,m,v,y,f.getX(B),f.getX(B+1),f.getX(B+2)),o&&(o.faceIndex=Math.floor(B/3),o.face.materialIndex=I.materialIndex,t.push(o))}else for(let I=Math.max(0,w.start),A=Math.min(f.count,w.start+w.count);I<A;I+=3)o=lc(this,u,e,r,m,v,y,f.getX(I),f.getX(I+1),f.getX(I+2)),o&&(o.faceIndex=Math.floor(I/3),t.push(o));else if(void 0!==p)if(Array.isArray(u))for(let D=0,N=x.length;D<N;D++){const I=x[D],A=u[I.materialIndex];for(let B=Math.max(I.start,w.start),W=Math.min(p.count,Math.min(I.start+I.count,w.start+w.count));B<W;B+=3)o=lc(this,A,e,r,m,v,y,B,B+1,B+2),o&&(o.faceIndex=Math.floor(B/3),o.face.materialIndex=I.materialIndex,t.push(o))}else for(let I=Math.max(0,w.start),A=Math.min(p.count,w.start+w.count);I<A;I+=3)o=lc(this,u,e,r,m,v,y,I,I+1,I+2),o&&(o.faceIndex=Math.floor(I/3),t.push(o))}}function lc(l,e,t,r,o,a,u,f,p,m){l.getVertexPosition(f,Qc),l.getVertexPosition(p,jl),l.getVertexPosition(m,Po);const v=function Vy(l,e,t,r,o,a,u,f){let p;if(p=1===e.side?r.intersectTriangle(u,a,o,!0,f):r.intersectTriangle(o,a,u,0===e.side,f),null===p)return null;Xl.copy(f),Xl.applyMatrix4(l.matrixWorld);const m=t.ray.origin.distanceTo(Xl);return m<t.near||m>t.far?null:{distance:m,point:Xl.clone(),object:l}}(l,e,t,r,Qc,jl,Po,Yh);if(v){o&&($h.fromBufferAttribute(o,f),$l.fromBufferAttribute(o,p),Xh.fromBufferAttribute(o,m),v.uv=Ei.getInterpolation(Yh,Qc,jl,Po,$h,$l,Xh,new Re)),a&&($h.fromBufferAttribute(a,f),$l.fromBufferAttribute(a,p),Xh.fromBufferAttribute(a,m),v.uv1=Ei.getInterpolation(Yh,Qc,jl,Po,$h,$l,Xh,new Re),v.uv2=v.uv1),u&&(km.fromBufferAttribute(u,f),Bm.fromBufferAttribute(u,p),Hy.fromBufferAttribute(u,m),v.normal=Ei.getInterpolation(Yh,Qc,jl,Po,km,Bm,Hy,new $),v.normal.dot(r.direction)>0&&v.normal.multiplyScalar(-1));const y={a:f,b:p,c:m,normal:new $,materialIndex:0};Ei.getNormal(Qc,jl,Po,y.normal),v.face=y}return v}class uc extends Bn{constructor(e=1,t=1,r=1,o=1,a=1,u=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:o,heightSegments:a,depthSegments:u};const f=this;o=Math.floor(o),a=Math.floor(a),u=Math.floor(u);const p=[],m=[],v=[],y=[];let x=0,w=0;function D(N,I,A,k,O,B,W,Y,q,ee,z){const Z=B/q,fe=W/ee,He=B/2,he=W/2,pe=Y/2,ve=q+1,Xe=ee+1;let Ue=0,ze=0;const Ye=new $;for(let et=0;et<Xe;et++){const Rt=et*fe-he;for(let ge=0;ge<ve;ge++)Ye[N]=(ge*Z-He)*k,Ye[I]=Rt*O,Ye[A]=pe,m.push(Ye.x,Ye.y,Ye.z),Ye[N]=0,Ye[I]=0,Ye[A]=Y>0?1:-1,v.push(Ye.x,Ye.y,Ye.z),y.push(ge/q),y.push(1-et/ee),Ue+=1}for(let et=0;et<ee;et++)for(let Rt=0;Rt<q;Rt++){const tt=x+Rt+ve*(et+1),mt=x+(Rt+1)+ve*(et+1),Pt=x+(Rt+1)+ve*et;p.push(x+Rt+ve*et,tt,Pt),p.push(tt,mt,Pt),ze+=6}f.addGroup(w,ze,z),w+=ze,x+=Ue}D("z","y","x",-1,-1,r,t,e,u,a,0),D("z","y","x",1,-1,r,t,-e,u,a,1),D("x","z","y",1,1,e,r,t,o,u,2),D("x","z","y",1,-1,e,r,-t,o,u,3),D("x","y","z",1,-1,e,t,r,o,a,4),D("x","y","z",-1,-1,e,t,-r,o,a,5),this.setIndex(p),this.setAttribute("position",new Ot(m,3)),this.setAttribute("normal",new Ot(v,3)),this.setAttribute("uv",new Ot(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new uc(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Ua(l){const e={};for(const t in l){e[t]={};for(const r in l[t]){const o=l[t][r];o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture||o.isQuaternion)?o.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=o.clone():e[t][r]=Array.isArray(o)?o.slice():o}}return e}function xs(l){const e={};for(let t=0;t<l.length;t++){const r=Ua(l[t]);for(const o in r)e[o]=r[o]}return e}function qh(l){return null===l.getRenderTarget()?l.outputColorSpace:Oi}const zy={clone:Ua,merge:xs};class Lo extends Ms{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ua(e.uniforms),this.uniformsGroups=function Hm(l){const e=[];for(let t=0;t<l.length;t++)e.push(l[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const o in this.uniforms){const u=this.uniforms[o].value;t.uniforms[o]=u&&u.isTexture?{type:"t",value:u.toJSON(e).uuid}:u&&u.isColor?{type:"c",value:u.getHex()}:u&&u.isVector2?{type:"v2",value:u.toArray()}:u&&u.isVector3?{type:"v3",value:u.toArray()}:u&&u.isVector4?{type:"v4",value:u.toArray()}:u&&u.isMatrix3?{type:"m3",value:u.toArray()}:u&&u.isMatrix4?{type:"m4",value:u.toArray()}:{value:u}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const o in this.extensions)!0===this.extensions[o]&&(r[o]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class Xu extends sn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ht,this.projectionMatrix=new Ht,this.projectionMatrixInverse=new Ht,this.coordinateSystem=bo}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class xr extends Xu{constructor(e=50,t=1,r=.1,o=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=o,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Gn*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Br*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Gn*Math.atan(Math.tan(.5*Br*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,o,a,u){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=o,this.view.width=a,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Br*this.fov)/this.zoom,r=2*t,o=this.aspect*r,a=-.5*o;const u=this.view;if(null!==this.view&&this.view.enabled){const p=u.fullWidth,m=u.fullHeight;a+=u.offsetX*o/p,t-=u.offsetY*r/m,o*=u.width/p,r*=u.height/m}const f=this.filmOffset;0!==f&&(a+=e*f/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+o,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class Wy extends sn{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null;const o=new xr(-90,1,e,t);o.layers=this.layers,this.add(o);const a=new xr(-90,1,e,t);a.layers=this.layers,this.add(a);const u=new xr(-90,1,e,t);u.layers=this.layers,this.add(u);const f=new xr(-90,1,e,t);f.layers=this.layers,this.add(f);const p=new xr(-90,1,e,t);p.layers=this.layers,this.add(p);const m=new xr(-90,1,e,t);m.layers=this.layers,this.add(m)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,o,a,u,f,p]=t;for(const m of t)this.remove(m);if(e===bo)r.up.set(0,1,0),r.lookAt(1,0,0),o.up.set(0,1,0),o.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),u.up.set(0,0,1),u.lookAt(0,-1,0),f.up.set(0,1,0),f.lookAt(0,0,1),p.up.set(0,1,0),p.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);r.up.set(0,-1,0),r.lookAt(-1,0,0),o.up.set(0,-1,0),o.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),u.up.set(0,0,-1),u.lookAt(0,-1,0),f.up.set(0,-1,0),f.lookAt(0,0,1),p.up.set(0,-1,0),p.lookAt(0,0,-1)}for(const m of t)this.add(m),m.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const r=this.renderTarget;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[o,a,u,f,p,m]=this.children,v=e.getRenderTarget(),y=e.xr.enabled;e.xr.enabled=!1;const x=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,o),e.setRenderTarget(r,1),e.render(t,a),e.setRenderTarget(r,2),e.render(t,u),e.setRenderTarget(r,3),e.render(t,f),e.setRenderTarget(r,4),e.render(t,p),r.texture.generateMipmaps=x,e.setRenderTarget(r,5),e.render(t,m),e.setRenderTarget(v),e.xr.enabled=y,r.texture.needsPMREMUpdate=!0}}class Yu extends b{constructor(e,t,r,o,a,u,f,p,m,v){super(e=void 0!==e?e:[],t=void 0!==t?t:Bi,r,o,a,u,f,p,m,v),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Vm extends P{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},o=[r,r,r,r,r,r];void 0!==t.encoding&&(To("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===$s?_n:""),this.texture=new Yu(o,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Mi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r_uniforms={tEquirect:{value:null}},r_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",o=new uc(5,5,5),a=new Lo({name:"CubemapFromEquirect",uniforms:Ua(r_uniforms),vertexShader:r_vertexShader,fragmentShader:r_fragmentShader,side:1,blending:0});a.uniforms.tEquirect.value=t;const u=new pr(o,a),f=t.minFilter;return t.minFilter===Or&&(t.minFilter=Mi),new Wy(1,10,this).update(e,u),t.minFilter=f,u.geometry.dispose(),u.material.dispose(),this}clear(e,t,r,o){const a=e.getRenderTarget();for(let u=0;u<6;u++)e.setRenderTarget(this,u),e.clear(t,r,o);e.setRenderTarget(a)}}const lf=new $,zm=new $,jy=new gn;class No{constructor(e=new $(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,o){return this.normal.set(e,t,r),this.constant=o,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const o=lf.subVectors(r,t).cross(zm.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(o,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(lf),o=this.normal.dot(r);if(0===o)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/o;return a<0||a>1?null:t.copy(e.start).addScaledVector(r,a)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||jy.getNormalMatrix(e),o=this.coplanarPoint(lf).applyMatrix4(e),a=this.normal.applyMatrix3(r).normalize();return this.constant=-o.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Ns=new zr,uf=new $;class df{constructor(e=new No,t=new No,r=new No,o=new No,a=new No,u=new No){this.planes=[e,t,r,o,a,u]}set(e,t,r,o,a,u){const f=this.planes;return f[0].copy(e),f[1].copy(t),f[2].copy(r),f[3].copy(o),f[4].copy(a),f[5].copy(u),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=bo){const r=this.planes,o=e.elements,a=o[0],u=o[1],f=o[2],p=o[3],m=o[4],v=o[5],y=o[6],x=o[7],w=o[8],D=o[9],N=o[10],I=o[11],A=o[12],k=o[13],O=o[14],B=o[15];if(r[0].setComponents(p-a,x-m,I-w,B-A).normalize(),r[1].setComponents(p+a,x+m,I+w,B+A).normalize(),r[2].setComponents(p+u,x+v,I+D,B+k).normalize(),r[3].setComponents(p-u,x-v,I-D,B-k).normalize(),r[4].setComponents(p-f,x-y,I-N,B-O).normalize(),t===bo)r[5].setComponents(p+f,x+y,I+N,B+O).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);r[5].setComponents(f,y,N,O).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Ns.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Ns.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Ns)}intersectsSprite(e){return Ns.center.set(0,0,0),Ns.radius=.7071067811865476,Ns.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ns)}intersectsSphere(e){const t=this.planes,r=e.center,o=-e.radius;for(let a=0;a<6;a++)if(t[a].distanceToPoint(r)<o)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const o=t[r];if(uf.x=o.normal.x>0?e.max.x:e.min.x,uf.y=o.normal.y>0?e.max.y:e.min.y,uf.z=o.normal.z>0?e.max.z:e.min.z,o.distanceToPoint(uf)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Zh(){let l=null,e=!1,t=null,r=null;function o(a,u){t(a,u),r=l.requestAnimationFrame(o)}return{start:function(){!0!==e&&null!==t&&(r=l.requestAnimationFrame(o),e=!0)},stop:function(){l.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(a){t=a},setContext:function(a){l=a}}}function qu(l,e){const t=e.isWebGL2,r=new WeakMap;return{get:function u(m){return m.isInterleavedBufferAttribute&&(m=m.data),r.get(m)},remove:function f(m){m.isInterleavedBufferAttribute&&(m=m.data);const v=r.get(m);v&&(l.deleteBuffer(v.buffer),r.delete(m))},update:function p(m,v){if(m.isGLBufferAttribute){const x=r.get(m);return void((!x||x.version<m.version)&&r.set(m,{buffer:m.buffer,type:m.type,bytesPerElement:m.elementSize,version:m.version}))}m.isInterleavedBufferAttribute&&(m=m.data);const y=r.get(m);void 0===y?r.set(m,function o(m,v){const y=m.array,x=m.usage,w=l.createBuffer();let D;if(l.bindBuffer(v,w),l.bufferData(v,y,x),m.onUploadCallback(),y instanceof Float32Array)D=l.FLOAT;else if(y instanceof Uint16Array)if(m.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");D=l.HALF_FLOAT}else D=l.UNSIGNED_SHORT;else if(y instanceof Int16Array)D=l.SHORT;else if(y instanceof Uint32Array)D=l.UNSIGNED_INT;else if(y instanceof Int32Array)D=l.INT;else if(y instanceof Int8Array)D=l.BYTE;else if(y instanceof Uint8Array)D=l.UNSIGNED_BYTE;else{if(!(y instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+y);D=l.UNSIGNED_BYTE}return{buffer:w,type:D,bytesPerElement:y.BYTES_PER_ELEMENT,version:m.version}}(m,v)):y.version<m.version&&(function a(m,v,y){const x=v.array,w=v.updateRange;l.bindBuffer(y,m),-1===w.count?l.bufferSubData(y,0,x):(t?l.bufferSubData(y,w.offset*x.BYTES_PER_ELEMENT,x,w.offset,w.count):l.bufferSubData(y,w.offset*x.BYTES_PER_ELEMENT,x.subarray(w.offset,w.offset+w.count)),w.count=-1),v.onUploadCallback()}(y.buffer,m,v),y.version=m.version)}}}class ff extends Bn{constructor(e=1,t=1,r=1,o=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:o};const a=e/2,u=t/2,f=Math.floor(r),p=Math.floor(o),m=f+1,v=p+1,y=e/f,x=t/p,w=[],D=[],N=[],I=[];for(let A=0;A<v;A++){const k=A*x-u;for(let O=0;O<m;O++)D.push(O*y-a,-k,0),N.push(0,0,1),I.push(O/f),I.push(1-A/p)}for(let A=0;A<p;A++)for(let k=0;k<f;k++){const B=k+m*(A+1),W=k+1+m*(A+1),Y=k+1+m*A;w.push(k+m*A,B,Y),w.push(B,W,Y)}this.setIndex(w),this.setAttribute("position",new Ot(D,3)),this.setAttribute("normal",new Ot(N,3)),this.setAttribute("uv",new Ot(I,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ff(e.width,e.height,e.widthSegments,e.heightSegments)}}const Hn={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},bt={common:{diffuse:{value:new It(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new gn},alphaMap:{value:null},alphaMapTransform:{value:new gn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new gn}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new gn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new gn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new gn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new gn},normalScale:{value:new Re(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new gn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new gn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new gn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new gn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new It(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new It(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new gn},alphaTest:{value:0},uvTransform:{value:new gn}},sprite:{diffuse:{value:new It(16777215)},opacity:{value:1},center:{value:new Re(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new gn},alphaMap:{value:null},alphaMapTransform:{value:new gn},alphaTest:{value:0}}},Us={basic:{uniforms:xs([bt.common,bt.specularmap,bt.envmap,bt.aomap,bt.lightmap,bt.fog]),vertexShader:Hn.meshbasic_vert,fragmentShader:Hn.meshbasic_frag},lambert:{uniforms:xs([bt.common,bt.specularmap,bt.envmap,bt.aomap,bt.lightmap,bt.emissivemap,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.fog,bt.lights,{emissive:{value:new It(0)}}]),vertexShader:Hn.meshlambert_vert,fragmentShader:Hn.meshlambert_frag},phong:{uniforms:xs([bt.common,bt.specularmap,bt.envmap,bt.aomap,bt.lightmap,bt.emissivemap,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.fog,bt.lights,{emissive:{value:new It(0)},specular:{value:new It(1118481)},shininess:{value:30}}]),vertexShader:Hn.meshphong_vert,fragmentShader:Hn.meshphong_frag},standard:{uniforms:xs([bt.common,bt.envmap,bt.aomap,bt.lightmap,bt.emissivemap,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.roughnessmap,bt.metalnessmap,bt.fog,bt.lights,{emissive:{value:new It(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Hn.meshphysical_vert,fragmentShader:Hn.meshphysical_frag},toon:{uniforms:xs([bt.common,bt.aomap,bt.lightmap,bt.emissivemap,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.gradientmap,bt.fog,bt.lights,{emissive:{value:new It(0)}}]),vertexShader:Hn.meshtoon_vert,fragmentShader:Hn.meshtoon_frag},matcap:{uniforms:xs([bt.common,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.fog,{matcap:{value:null}}]),vertexShader:Hn.meshmatcap_vert,fragmentShader:Hn.meshmatcap_frag},points:{uniforms:xs([bt.points,bt.fog]),vertexShader:Hn.points_vert,fragmentShader:Hn.points_frag},dashed:{uniforms:xs([bt.common,bt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Hn.linedashed_vert,fragmentShader:Hn.linedashed_frag},depth:{uniforms:xs([bt.common,bt.displacementmap]),vertexShader:Hn.depth_vert,fragmentShader:Hn.depth_frag},normal:{uniforms:xs([bt.common,bt.bumpmap,bt.normalmap,bt.displacementmap,{opacity:{value:1}}]),vertexShader:Hn.meshnormal_vert,fragmentShader:Hn.meshnormal_frag},sprite:{uniforms:xs([bt.sprite,bt.fog]),vertexShader:Hn.sprite_vert,fragmentShader:Hn.sprite_frag},background:{uniforms:{uvTransform:{value:new gn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Hn.background_vert,fragmentShader:Hn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Hn.backgroundCube_vert,fragmentShader:Hn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Hn.cube_vert,fragmentShader:Hn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Hn.equirect_vert,fragmentShader:Hn.equirect_frag},distanceRGBA:{uniforms:xs([bt.common,bt.displacementmap,{referencePosition:{value:new $},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Hn.distanceRGBA_vert,fragmentShader:Hn.distanceRGBA_frag},shadow:{uniforms:xs([bt.lights,bt.fog,{color:{value:new It(0)},opacity:{value:1}}]),vertexShader:Hn.shadow_vert,fragmentShader:Hn.shadow_frag}};Us.physical={uniforms:xs([Us.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new gn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new gn},clearcoatNormalScale:{value:new Re(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new gn},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new gn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new gn},sheen:{value:0},sheenColor:{value:new It(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new gn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new gn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new gn},transmissionSamplerSize:{value:new Re},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new gn},attenuationDistance:{value:0},attenuationColor:{value:new It(0)},specularColor:{value:new It(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new gn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new gn},anisotropyVector:{value:new Re},anisotropyMap:{value:null},anisotropyMapTransform:{value:new gn}}]),vertexShader:Hn.meshphysical_vert,fragmentShader:Hn.meshphysical_frag};const Tf={r:0,b:0,g:0};function N_(l,e,t,r,o,a,u){const f=new It(0);let m,v,p=!0===a?0:1,y=null,x=0,w=null;function N(I,A){I.getRGB(Tf,qh(l)),r.buffers.color.setClear(Tf.r,Tf.g,Tf.b,A,u)}return{getClearColor:function(){return f},setClearColor:function(I,A=1){f.set(I),p=A,N(f,p)},getClearAlpha:function(){return p},setClearAlpha:function(I){p=I,N(f,p)},render:function D(I,A){let k=!1,O=!0===A.isScene?A.background:null;O&&O.isTexture&&(O=(A.backgroundBlurriness>0?t:e).get(O)),null===O?N(f,p):O&&O.isColor&&(N(O,1),k=!0);const B=l.xr.getEnvironmentBlendMode();"additive"===B?r.buffers.color.setClear(0,0,0,1,u):"alpha-blend"===B&&r.buffers.color.setClear(0,0,0,0,u),(l.autoClear||k)&&l.clear(l.autoClearColor,l.autoClearDepth,l.autoClearStencil),O&&(O.isCubeTexture||O.mapping===pi)?(void 0===v&&(v=new pr(new uc(1,1,1),new Lo({name:"BackgroundCubeMaterial",uniforms:Ua(Us.backgroundCube.uniforms),vertexShader:Us.backgroundCube.vertexShader,fragmentShader:Us.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),v.geometry.deleteAttribute("normal"),v.geometry.deleteAttribute("uv"),v.onBeforeRender=function(W,Y,q){this.matrixWorld.copyPosition(q.matrixWorld)},Object.defineProperty(v.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),o.update(v)),v.material.uniforms.envMap.value=O,v.material.uniforms.flipEnvMap.value=O.isCubeTexture&&!1===O.isRenderTargetTexture?-1:1,v.material.uniforms.backgroundBlurriness.value=A.backgroundBlurriness,v.material.uniforms.backgroundIntensity.value=A.backgroundIntensity,v.material.toneMapped=O.colorSpace!==_n,(y!==O||x!==O.version||w!==l.toneMapping)&&(v.material.needsUpdate=!0,y=O,x=O.version,w=l.toneMapping),v.layers.enableAll(),I.unshift(v,v.geometry,v.material,0,0,null)):O&&O.isTexture&&(void 0===m&&(m=new pr(new ff(2,2),new Lo({name:"BackgroundMaterial",uniforms:Ua(Us.background.uniforms),vertexShader:Us.background.vertexShader,fragmentShader:Us.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),Object.defineProperty(m.material,"map",{get:function(){return this.uniforms.t2D.value}}),o.update(m)),m.material.uniforms.t2D.value=O,m.material.uniforms.backgroundIntensity.value=A.backgroundIntensity,m.material.toneMapped=O.colorSpace!==_n,!0===O.matrixAutoUpdate&&O.updateMatrix(),m.material.uniforms.uvTransform.value.copy(O.matrix),(y!==O||x!==O.version||w!==l.toneMapping)&&(m.material.needsUpdate=!0,y=O,x=O.version,w=l.toneMapping),m.layers.enableAll(),I.unshift(m,m.geometry,m.material,0,0,null))}}}function O_(l,e,t,r){const o=l.getParameter(l.MAX_VERTEX_ATTRIBS),a=r.isWebGL2?null:e.get("OES_vertex_array_object"),u=r.isWebGL2||null!==a,f={},p=I(null);let m=p,v=!1;function w(pe){return r.isWebGL2?l.bindVertexArray(pe):a.bindVertexArrayOES(pe)}function D(pe){return r.isWebGL2?l.deleteVertexArray(pe):a.deleteVertexArrayOES(pe)}function I(pe){const ve=[],Xe=[],Ue=[];for(let ze=0;ze<o;ze++)ve[ze]=0,Xe[ze]=0,Ue[ze]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:ve,enabledAttributes:Xe,attributeDivisors:Ue,object:pe,attributes:{},index:null}}function O(){const pe=m.newAttributes;for(let ve=0,Xe=pe.length;ve<Xe;ve++)pe[ve]=0}function B(pe){W(pe,0)}function W(pe,ve){const Ue=m.enabledAttributes,ze=m.attributeDivisors;m.newAttributes[pe]=1,0===Ue[pe]&&(l.enableVertexAttribArray(pe),Ue[pe]=1),ze[pe]!==ve&&((r.isWebGL2?l:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](pe,ve),ze[pe]=ve)}function Y(){const pe=m.newAttributes,ve=m.enabledAttributes;for(let Xe=0,Ue=ve.length;Xe<Ue;Xe++)ve[Xe]!==pe[Xe]&&(l.disableVertexAttribArray(Xe),ve[Xe]=0)}function q(pe,ve,Xe,Ue,ze,Ye,et){!0===et?l.vertexAttribIPointer(pe,ve,Xe,ze,Ye):l.vertexAttribPointer(pe,ve,Xe,Ue,ze,Ye)}function He(){he(),v=!0,m!==p&&(m=p,w(m.object))}function he(){p.geometry=null,p.program=null,p.wireframe=!1}return{setup:function y(pe,ve,Xe,Ue,ze){let Ye=!1;if(u){const et=function N(pe,ve,Xe){const Ue=!0===Xe.wireframe;let ze=f[pe.id];void 0===ze&&(ze={},f[pe.id]=ze);let Ye=ze[ve.id];void 0===Ye&&(Ye={},ze[ve.id]=Ye);let et=Ye[Ue];return void 0===et&&(et=I(function x(){return r.isWebGL2?l.createVertexArray():a.createVertexArrayOES()}()),Ye[Ue]=et),et}(Ue,Xe,ve);m!==et&&(m=et,w(m.object)),Ye=function A(pe,ve,Xe,Ue){const ze=m.attributes,Ye=ve.attributes;let et=0;const Rt=Xe.getAttributes();for(const ge in Rt)if(Rt[ge].location>=0){const mt=ze[ge];let Pt=Ye[ge];if(void 0===Pt&&("instanceMatrix"===ge&&pe.instanceMatrix&&(Pt=pe.instanceMatrix),"instanceColor"===ge&&pe.instanceColor&&(Pt=pe.instanceColor)),void 0===mt||mt.attribute!==Pt||Pt&&mt.data!==Pt.data)return!0;et++}return m.attributesNum!==et||m.index!==Ue}(pe,Ue,Xe,ze),Ye&&function k(pe,ve,Xe,Ue){const ze={},Ye=ve.attributes;let et=0;const Rt=Xe.getAttributes();for(const ge in Rt)if(Rt[ge].location>=0){let mt=Ye[ge];void 0===mt&&("instanceMatrix"===ge&&pe.instanceMatrix&&(mt=pe.instanceMatrix),"instanceColor"===ge&&pe.instanceColor&&(mt=pe.instanceColor));const Pt={};Pt.attribute=mt,mt&&mt.data&&(Pt.data=mt.data),ze[ge]=Pt,et++}m.attributes=ze,m.attributesNum=et,m.index=Ue}(pe,Ue,Xe,ze)}else{const et=!0===ve.wireframe;(m.geometry!==Ue.id||m.program!==Xe.id||m.wireframe!==et)&&(m.geometry=Ue.id,m.program=Xe.id,m.wireframe=et,Ye=!0)}null!==ze&&t.update(ze,l.ELEMENT_ARRAY_BUFFER),(Ye||v)&&(v=!1,function ee(pe,ve,Xe,Ue){if(!1===r.isWebGL2&&(pe.isInstancedMesh||Ue.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;O();const ze=Ue.attributes,Ye=Xe.getAttributes(),et=ve.defaultAttributeValues;for(const Rt in Ye){const ge=Ye[Rt];if(ge.location>=0){let tt=ze[Rt];if(void 0===tt&&("instanceMatrix"===Rt&&pe.instanceMatrix&&(tt=pe.instanceMatrix),"instanceColor"===Rt&&pe.instanceColor&&(tt=pe.instanceColor)),void 0!==tt){const mt=tt.normalized,Pt=tt.itemSize,Bt=t.get(tt);if(void 0===Bt)continue;const Wt=Bt.buffer,dn=Bt.type,ln=Bt.bytesPerElement,Wn=!0===r.isWebGL2&&(dn===l.INT||dn===l.UNSIGNED_INT||1013===tt.gpuType);if(tt.isInterleavedBufferAttribute){const fn=tt.data,ne=fn.stride,vt=tt.offset;if(fn.isInstancedInterleavedBuffer){for(let Ge=0;Ge<ge.locationSize;Ge++)W(ge.location+Ge,fn.meshPerAttribute);!0!==pe.isInstancedMesh&&void 0===Ue._maxInstanceCount&&(Ue._maxInstanceCount=fn.meshPerAttribute*fn.count)}else for(let Ge=0;Ge<ge.locationSize;Ge++)B(ge.location+Ge);l.bindBuffer(l.ARRAY_BUFFER,Wt);for(let Ge=0;Ge<ge.locationSize;Ge++)q(ge.location+Ge,Pt/ge.locationSize,dn,mt,ne*ln,(vt+Pt/ge.locationSize*Ge)*ln,Wn)}else{if(tt.isInstancedBufferAttribute){for(let fn=0;fn<ge.locationSize;fn++)W(ge.location+fn,tt.meshPerAttribute);!0!==pe.isInstancedMesh&&void 0===Ue._maxInstanceCount&&(Ue._maxInstanceCount=tt.meshPerAttribute*tt.count)}else for(let fn=0;fn<ge.locationSize;fn++)B(ge.location+fn);l.bindBuffer(l.ARRAY_BUFFER,Wt);for(let fn=0;fn<ge.locationSize;fn++)q(ge.location+fn,Pt/ge.locationSize,dn,mt,Pt*ln,Pt/ge.locationSize*fn*ln,Wn)}}else if(void 0!==et){const mt=et[Rt];if(void 0!==mt)switch(mt.length){case 2:l.vertexAttrib2fv(ge.location,mt);break;case 3:l.vertexAttrib3fv(ge.location,mt);break;case 4:l.vertexAttrib4fv(ge.location,mt);break;default:l.vertexAttrib1fv(ge.location,mt)}}}}Y()}(pe,ve,Xe,Ue),null!==ze&&l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,t.get(ze).buffer))},reset:He,resetDefaultState:he,dispose:function z(){He();for(const pe in f){const ve=f[pe];for(const Xe in ve){const Ue=ve[Xe];for(const ze in Ue)D(Ue[ze].object),delete Ue[ze];delete ve[Xe]}delete f[pe]}},releaseStatesOfGeometry:function Z(pe){if(void 0===f[pe.id])return;const ve=f[pe.id];for(const Xe in ve){const Ue=ve[Xe];for(const ze in Ue)D(Ue[ze].object),delete Ue[ze];delete ve[Xe]}delete f[pe.id]},releaseStatesOfProgram:function fe(pe){for(const ve in f){const Xe=f[ve];if(void 0===Xe[pe.id])continue;const Ue=Xe[pe.id];for(const ze in Ue)D(Ue[ze].object),delete Ue[ze];delete Xe[pe.id]}},initAttributes:O,enableAttribute:B,disableUnusedAttributes:Y}}function F_(l,e,t,r){const o=r.isWebGL2;let a;this.setMode=function u(m){a=m},this.render=function f(m,v){l.drawArrays(a,m,v),t.update(v,a,1)},this.renderInstances=function p(m,v,y){if(0===y)return;let x,w;if(o)x=l,w="drawArraysInstanced";else if(x=e.get("ANGLE_instanced_arrays"),w="drawArraysInstancedANGLE",null===x)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");x[w](a,m,v,y),t.update(v,a,y)}}function U_(l,e,t){let r;function a(q){if("highp"===q){if(l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.HIGH_FLOAT).precision>0&&l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.HIGH_FLOAT).precision>0)return"highp";q="mediump"}return"mediump"===q&&l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.MEDIUM_FLOAT).precision>0&&l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const u=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===l.constructor.name;let f=void 0!==t.precision?t.precision:"highp";const p=a(f);p!==f&&(console.warn("THREE.WebGLRenderer:",f,"not supported, using",p,"instead."),f=p);const m=u||e.has("WEBGL_draw_buffers"),v=!0===t.logarithmicDepthBuffer,y=l.getParameter(l.MAX_TEXTURE_IMAGE_UNITS),x=l.getParameter(l.MAX_VERTEX_TEXTURE_IMAGE_UNITS),w=l.getParameter(l.MAX_TEXTURE_SIZE),D=l.getParameter(l.MAX_CUBE_MAP_TEXTURE_SIZE),N=l.getParameter(l.MAX_VERTEX_ATTRIBS),I=l.getParameter(l.MAX_VERTEX_UNIFORM_VECTORS),A=l.getParameter(l.MAX_VARYING_VECTORS),k=l.getParameter(l.MAX_FRAGMENT_UNIFORM_VECTORS),O=x>0,B=u||e.has("OES_texture_float");return{isWebGL2:u,drawBuffers:m,getMaxAnisotropy:function o(){if(void 0!==r)return r;if(!0===e.has("EXT_texture_filter_anisotropic")){const q=e.get("EXT_texture_filter_anisotropic");r=l.getParameter(q.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:a,precision:f,logarithmicDepthBuffer:v,maxTextures:y,maxVertexTextures:x,maxTextureSize:w,maxCubemapSize:D,maxAttributes:N,maxVertexUniforms:I,maxVaryings:A,maxFragmentUniforms:k,vertexTextures:O,floatFragmentTextures:B,floatVertexTextures:O&&B,maxSamples:u?l.getParameter(l.MAX_SAMPLES):0}}function k_(l){const e=this;let t=null,r=0,o=!1,a=!1;const u=new No,f=new gn,p={value:null,needsUpdate:!1};function v(y,x,w,D){const N=null!==y?y.length:0;let I=null;if(0!==N){if(I=p.value,!0!==D||null===I){const A=w+4*N,k=x.matrixWorldInverse;f.getNormalMatrix(k),(null===I||I.length<A)&&(I=new Float32Array(A));for(let O=0,B=w;O!==N;++O,B+=4)u.copy(y[O]).applyMatrix4(k,f),u.normal.toArray(I,B),I[B+3]=u.constant}p.value=I,p.needsUpdate=!0}return e.numPlanes=N,e.numIntersection=0,I}this.uniform=p,this.numPlanes=0,this.numIntersection=0,this.init=function(y,x){const w=0!==y.length||x||0!==r||o;return o=x,r=y.length,w},this.beginShadows=function(){a=!0,v(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(y,x){t=v(y,x,0)},this.setState=function(y,x,w){const D=y.clippingPlanes,N=y.clipIntersection,I=y.clipShadows,A=l.get(y);if(!o||null===D||0===D.length||a&&!I)a?v(null):function m(){p.value!==t&&(p.value=t,p.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}();else{const k=a?0:r,O=4*k;let B=A.clippingState||null;p.value=B,B=v(D,x,O,w);for(let W=0;W!==O;++W)B[W]=t[W];A.clippingState=B,this.numIntersection=N?this.numPlanes:0,this.numPlanes+=k}}}function dg(l){let e=new WeakMap;function t(u,f){return 303===f?u.mapping=Bi:304===f&&(u.mapping=Ar),u}function o(u){const f=u.target;f.removeEventListener("dispose",o);const p=e.get(f);void 0!==p&&(e.delete(f),p.dispose())}return{get:function r(u){if(u&&u.isTexture&&!1===u.isRenderTargetTexture){const f=u.mapping;if(303===f||304===f){if(e.has(u))return t(e.get(u).texture,u.mapping);{const p=u.image;if(p&&p.height>0){const m=new Vm(p.height/2);return m.fromEquirectangularTexture(l,u),e.set(u,m),u.addEventListener("dispose",o),t(m.texture,u.mapping)}return null}}}return u},dispose:function a(){e=new WeakMap}}}class tl extends Xu{constructor(e=-1,t=1,r=1,o=-1,a=.1,u=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=o,this.near=a,this.far=u,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,r,o,a,u){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=o,this.view.width=a,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,o=(this.top+this.bottom)/2;let a=r-e,u=r+e,f=o+t,p=o-t;if(null!==this.view&&this.view.enabled){const m=(this.right-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=m*this.view.offsetX,u=a+m*this.view.width,f-=v*this.view.offsetY,p=f-v*this.view.height}this.projectionMatrix.makeOrthographic(a,u,f,p,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const Af=[.125,.215,.35,.446,.526,.582],op=new tl,Cf=new It;let Df=null;const ks=(1+Math.sqrt(5))/2,il=1/ks,ap=[new $(1,1,1),new $(-1,1,1),new $(1,1,-1),new $(-1,1,-1),new $(0,ks,il),new $(0,ks,-il),new $(il,0,ks),new $(-il,0,ks),new $(ks,il,0),new $(-ks,il,0)];class fg{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,o=100){Df=this._renderer.getRenderTarget(),this._setSize(256);const a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,r,o,a),t>0&&this._blur(a,0,0,t),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=lp(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=cp(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Df),e.scissorTest=!1,If(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===Bi||e.mapping===Ar?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),Df=this._renderer.getRenderTarget();const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:Mi,minFilter:Mi,generateMipmaps:!1,type:it,format:ui,colorSpace:Oi,depthBuffer:!1},o=ed(e,t,r);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=ed(e,t,r);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function Gx(l){const e=[],t=[],r=[];let o=l;const a=l-4+1+Af.length;for(let u=0;u<a;u++){const f=Math.pow(2,o);t.push(f);let p=1/f;u>l-4?p=Af[u-l+4-1]:0===u&&(p=0),r.push(p);const m=1/(f-2),v=-m,y=1+m,x=[v,v,y,v,y,y,v,v,y,y,v,y],w=6,D=6,N=3,I=2,A=1,k=new Float32Array(N*D*w),O=new Float32Array(I*D*w),B=new Float32Array(A*D*w);for(let Y=0;Y<w;Y++){const q=Y%3*2/3-1,ee=Y>2?0:-1;k.set([q,ee,0,q+2/3,ee,0,q+2/3,ee+1,0,q,ee,0,q+2/3,ee+1,0,q,ee+1,0],N*D*Y),O.set(x,I*D*Y),B.set([Y,Y,Y,Y,Y,Y],A*D*Y)}const W=new Bn;W.setAttribute("position",new H(k,N)),W.setAttribute("uv",new H(O,I)),W.setAttribute("faceIndex",new H(B,A)),e.push(W),o>4&&o--}return{lodPlanes:e,sizeLods:t,sigmas:r}}(a)),this._blurMaterial=function hg(l,e,t){const r=new Float32Array(20),o=new $(0,1,0);return new Lo({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${l}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:o}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(a,e,t)}return o}_compileMaterial(e){const t=new pr(this._lodPlanes[0],e);this._renderer.compile(t,op)}_sceneToCubeUV(e,t,r,o){const f=new xr(90,1,t,r),p=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],v=this._renderer,y=v.autoClear,x=v.toneMapping;v.getClearColor(Cf),v.toneMapping=Tr,v.autoClear=!1;const w=new cs({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),D=new pr(new uc,w);let N=!1;const I=e.background;I?I.isColor&&(w.color.copy(I),e.background=null,N=!0):(w.color.copy(Cf),N=!0);for(let A=0;A<6;A++){const k=A%3;0===k?(f.up.set(0,p[A],0),f.lookAt(m[A],0,0)):1===k?(f.up.set(0,0,p[A]),f.lookAt(0,m[A],0)):(f.up.set(0,p[A],0),f.lookAt(0,0,m[A]));const O=this._cubeSize;If(o,k*O,A>2?O:0,O,O),v.setRenderTarget(o),N&&v.render(D,f),v.render(e,f)}D.geometry.dispose(),D.material.dispose(),v.toneMapping=x,v.autoClear=y,e.background=I}_textureToCubeUV(e,t){const r=this._renderer,o=e.mapping===Bi||e.mapping===Ar;o?(null===this._cubemapMaterial&&(this._cubemapMaterial=lp()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=cp());const a=o?this._cubemapMaterial:this._equirectMaterial,u=new pr(this._lodPlanes[0],a);a.uniforms.envMap.value=e;const p=this._cubeSize;If(t,0,0,3*p,2*p),r.setRenderTarget(t),r.render(u,op)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let o=1;o<this._lodPlanes.length;o++){const a=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]);this._blur(e,o-1,o,a,ap[(o-1)%ap.length])}t.autoClear=r}_blur(e,t,r,o,a){const u=this._pingPongRenderTarget;this._halfBlur(e,u,t,r,o,"latitudinal",a),this._halfBlur(u,e,r,r,o,"longitudinal",a)}_halfBlur(e,t,r,o,a,u,f){const p=this._renderer,m=this._blurMaterial;"latitudinal"!==u&&"longitudinal"!==u&&console.error("blur direction must be either latitudinal or longitudinal!");const y=new pr(this._lodPlanes[o],m),x=m.uniforms,w=this._sizeLods[r]-1,D=isFinite(a)?Math.PI/(2*w):2*Math.PI/39,N=a/D,I=isFinite(a)?1+Math.floor(3*N):20;I>20&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${I} samples when the maximum is set to 20`);const A=[];let k=0;for(let q=0;q<20;++q){const ee=q/N,z=Math.exp(-ee*ee/2);A.push(z),0===q?k+=z:q<I&&(k+=2*z)}for(let q=0;q<A.length;q++)A[q]=A[q]/k;x.envMap.value=e.texture,x.samples.value=I,x.weights.value=A,x.latitudinal.value="latitudinal"===u,f&&(x.poleAxis.value=f);const{_lodMax:O}=this;x.dTheta.value=D,x.mipInt.value=O-r;const B=this._sizeLods[o];If(t,3*B*(o>O-4?o-O+4:0),4*(this._cubeSize-B),3*B,2*B),p.setRenderTarget(t),p.render(y,op)}}function ed(l,e,t){const r=new P(l,e,t);return r.texture.mapping=pi,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function If(l,e,t,r,o){l.viewport.set(e,t,r,o),l.scissor.set(e,t,r,o)}function cp(){return new Lo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function lp(){return new Lo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function pg(l){let e=new WeakMap,t=null;function a(f){const p=f.target;p.removeEventListener("dispose",a);const m=e.get(p);void 0!==m&&(e.delete(p),m.dispose())}return{get:function r(f){if(f&&f.isTexture){const p=f.mapping,m=303===p||304===p,v=p===Bi||p===Ar;if(m||v){if(f.isRenderTargetTexture&&!0===f.needsPMREMUpdate){f.needsPMREMUpdate=!1;let y=e.get(f);return null===t&&(t=new fg(l)),y=m?t.fromEquirectangular(f,y):t.fromCubemap(f,y),e.set(f,y),y.texture}if(e.has(f))return e.get(f).texture;{const y=f.image;if(m&&y&&y.height>0||v&&y&&function o(f){let p=0;for(let v=0;v<6;v++)void 0!==f[v]&&p++;return 6===p}(y)){null===t&&(t=new fg(l));const x=m?t.fromEquirectangular(f):t.fromCubemap(f);return e.set(f,x),f.addEventListener("dispose",a),x.texture}return null}}}return f},dispose:function u(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function Rf(l){const e={};function t(r){if(void 0!==e[r])return e[r];let o;switch(r){case"WEBGL_depth_texture":o=l.getExtension("WEBGL_depth_texture")||l.getExtension("MOZ_WEBGL_depth_texture")||l.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":o=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":o=l.getExtension("WEBGL_compressed_texture_s3tc")||l.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||l.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":o=l.getExtension("WEBGL_compressed_texture_pvrtc")||l.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:o=l.getExtension(r)}return e[r]=o,o}return{has:function(r){return null!==t(r)},init:function(r){r.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){const o=t(r);return null===o&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),o}}}function nd(l,e,t,r){const o={},a=new WeakMap;function u(y){const x=y.target;null!==x.index&&e.remove(x.index);for(const D in x.attributes)e.remove(x.attributes[D]);for(const D in x.morphAttributes){const N=x.morphAttributes[D];for(let I=0,A=N.length;I<A;I++)e.remove(N[I])}x.removeEventListener("dispose",u),delete o[x.id];const w=a.get(x);w&&(e.remove(w),a.delete(x)),r.releaseStatesOfGeometry(x),!0===x.isInstancedBufferGeometry&&delete x._maxInstanceCount,t.memory.geometries--}function m(y){const x=[],w=y.index,D=y.attributes.position;let N=0;if(null!==w){const k=w.array;N=w.version;for(let O=0,B=k.length;O<B;O+=3){const W=k[O+0],Y=k[O+1],q=k[O+2];x.push(W,Y,Y,q,q,W)}}else{if(void 0===D)return;N=D.version;for(let O=0,B=D.array.length/3-1;O<B;O+=3){const W=O+0,Y=O+1,q=O+2;x.push(W,Y,Y,q,q,W)}}const I=new(Ll(x)?Ti:$t)(x,1);I.version=N;const A=a.get(y);A&&e.remove(A),a.set(y,I)}return{get:function f(y,x){return!0===o[x.id]||(x.addEventListener("dispose",u),o[x.id]=!0,t.memory.geometries++),x},update:function p(y){const x=y.attributes;for(const D in x)e.update(x[D],l.ARRAY_BUFFER);const w=y.morphAttributes;for(const D in w){const N=w[D];for(let I=0,A=N.length;I<A;I++)e.update(N[I],l.ARRAY_BUFFER)}},getWireframeAttribute:function v(y){const x=a.get(y);if(x){const w=y.index;null!==w&&x.version<w.version&&m(y)}else m(y);return a.get(y)}}}function mg(l,e,t,r){const o=r.isWebGL2;let a,f,p;this.setMode=function u(x){a=x},this.setIndex=function m(x){f=x.type,p=x.bytesPerElement},this.render=function v(x,w){l.drawElements(a,w,f,x*p),t.update(w,a,1)},this.renderInstances=function y(x,w,D){if(0===D)return;let N,I;if(o)N=l,I="drawElementsInstanced";else if(N=e.get("ANGLE_instanced_arrays"),I="drawElementsInstancedANGLE",null===N)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");N[I](a,w,f,x*p,D),t.update(w,a,D)}}function up(l){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function o(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function r(a,u,f){switch(t.calls++,u){case l.TRIANGLES:t.triangles+=f*(a/3);break;case l.LINES:t.lines+=f*(a/2);break;case l.LINE_STRIP:t.lines+=f*(a-1);break;case l.LINE_LOOP:t.lines+=f*a;break;case l.POINTS:t.points+=f*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",u)}}}}function Pf(l,e){return l[0]-e[0]}function gg(l,e){return Math.abs(e[1])-Math.abs(l[1])}function dp(l,e,t){const r={},o=new Float32Array(8),a=new WeakMap,u=new L,f=[];for(let m=0;m<8;m++)f[m]=[m,0];return{update:function p(m,v,y){const x=m.morphTargetInfluences;if(!0===e.isWebGL2){const w=v.morphAttributes.position||v.morphAttributes.normal||v.morphAttributes.color,D=void 0!==w?w.length:0;let N=a.get(v);if(void 0===N||N.count!==D){let pe=function(){He.dispose(),a.delete(v),v.removeEventListener("dispose",pe)};void 0!==N&&N.texture.dispose();const k=void 0!==v.morphAttributes.position,O=void 0!==v.morphAttributes.normal,B=void 0!==v.morphAttributes.color,W=v.morphAttributes.position||[],Y=v.morphAttributes.normal||[],q=v.morphAttributes.color||[];let ee=0;!0===k&&(ee=1),!0===O&&(ee=2),!0===B&&(ee=3);let z=v.attributes.position.count*ee,Z=1;z>e.maxTextureSize&&(Z=Math.ceil(z/e.maxTextureSize),z=e.maxTextureSize);const fe=new Float32Array(z*Z*4*D),He=new G(fe,z,Z,D);He.type=_e,He.needsUpdate=!0;const he=4*ee;for(let ve=0;ve<D;ve++){const Xe=W[ve],Ue=Y[ve],ze=q[ve],Ye=z*Z*4*ve;for(let et=0;et<Xe.count;et++){const Rt=et*he;!0===k&&(u.fromBufferAttribute(Xe,et),fe[Ye+Rt+0]=u.x,fe[Ye+Rt+1]=u.y,fe[Ye+Rt+2]=u.z,fe[Ye+Rt+3]=0),!0===O&&(u.fromBufferAttribute(Ue,et),fe[Ye+Rt+4]=u.x,fe[Ye+Rt+5]=u.y,fe[Ye+Rt+6]=u.z,fe[Ye+Rt+7]=0),!0===B&&(u.fromBufferAttribute(ze,et),fe[Ye+Rt+8]=u.x,fe[Ye+Rt+9]=u.y,fe[Ye+Rt+10]=u.z,fe[Ye+Rt+11]=4===ze.itemSize?u.w:1)}}N={count:D,texture:He,size:new Re(z,Z)},a.set(v,N),v.addEventListener("dispose",pe)}let I=0;for(let k=0;k<x.length;k++)I+=x[k];const A=v.morphTargetsRelative?1:1-I;y.getUniforms().setValue(l,"morphTargetBaseInfluence",A),y.getUniforms().setValue(l,"morphTargetInfluences",x),y.getUniforms().setValue(l,"morphTargetsTexture",N.texture,t),y.getUniforms().setValue(l,"morphTargetsTextureSize",N.size)}else{const w=void 0===x?0:x.length;let D=r[v.id];if(void 0===D||D.length!==w){D=[];for(let O=0;O<w;O++)D[O]=[O,0];r[v.id]=D}for(let O=0;O<w;O++){const B=D[O];B[0]=O,B[1]=x[O]}D.sort(gg);for(let O=0;O<8;O++)O<w&&D[O][1]?(f[O][0]=D[O][0],f[O][1]=D[O][1]):(f[O][0]=Number.MAX_SAFE_INTEGER,f[O][1]=0);f.sort(Pf);const N=v.morphAttributes.position,I=v.morphAttributes.normal;let A=0;for(let O=0;O<8;O++){const B=f[O],W=B[0],Y=B[1];W!==Number.MAX_SAFE_INTEGER&&Y?(N&&v.getAttribute("morphTarget"+O)!==N[W]&&v.setAttribute("morphTarget"+O,N[W]),I&&v.getAttribute("morphNormal"+O)!==I[W]&&v.setAttribute("morphNormal"+O,I[W]),o[O]=Y,A+=Y):(N&&!0===v.hasAttribute("morphTarget"+O)&&v.deleteAttribute("morphTarget"+O),I&&!0===v.hasAttribute("morphNormal"+O)&&v.deleteAttribute("morphNormal"+O),o[O]=0)}const k=v.morphTargetsRelative?1:1-A;y.getUniforms().setValue(l,"morphTargetBaseInfluence",k),y.getUniforms().setValue(l,"morphTargetInfluences",o)}}}}function id(l,e,t,r){let o=new WeakMap;function f(p){const m=p.target;m.removeEventListener("dispose",f),t.remove(m.instanceMatrix),null!==m.instanceColor&&t.remove(m.instanceColor)}return{update:function a(p){const m=r.render.frame,y=e.get(p,p.geometry);if(o.get(y)!==m&&(e.update(y),o.set(y,m)),p.isInstancedMesh&&(!1===p.hasEventListener("dispose",f)&&p.addEventListener("dispose",f),o.get(p)!==m&&(t.update(p.instanceMatrix,l.ARRAY_BUFFER),null!==p.instanceColor&&t.update(p.instanceColor,l.ARRAY_BUFFER),o.set(p,m))),p.isSkinnedMesh){const x=p.skeleton;o.get(x)!==m&&(x.update(),o.set(x,m))}return y},dispose:function u(){o=new WeakMap}}}const vg=new b,fp=new G,yg=new Ce,_g=new Yu,Mg=[],hp=[],pp=new Float32Array(16),rd=new Float32Array(9),Lf=new Float32Array(4);function Oo(l,e,t){const r=l[0];if(r<=0||r>0)return l;const o=e*t;let a=Mg[o];if(void 0===a&&(a=new Float32Array(o),Mg[o]=a),0!==e){r.toArray(a,0);for(let u=1,f=0;u!==e;++u)f+=t,l[u].toArray(a,f)}return a}function Sr(l,e){if(l.length!==e.length)return!1;for(let t=0,r=l.length;t<r;t++)if(l[t]!==e[t])return!1;return!0}function br(l,e){for(let t=0,r=e.length;t<r;t++)l[t]=e[t]}function mp(l,e){let t=hp[e];void 0===t&&(t=new Int32Array(e),hp[e]=t);for(let r=0;r!==e;++r)t[r]=l.allocateTextureUnit();return t}function B_(l,e){const t=this.cache;t[0]!==e&&(l.uniform1f(this.addr,e),t[0]=e)}function gp(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(l.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Sr(t,e))return;l.uniform2fv(this.addr,e),br(t,e)}}function H_(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(l.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(l.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Sr(t,e))return;l.uniform3fv(this.addr,e),br(t,e)}}function iu(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(l.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Sr(t,e))return;l.uniform4fv(this.addr,e),br(t,e)}}function Nf(l,e){const t=this.cache,r=e.elements;if(void 0===r){if(Sr(t,e))return;l.uniformMatrix2fv(this.addr,!1,e),br(t,e)}else{if(Sr(t,r))return;Lf.set(r),l.uniformMatrix2fv(this.addr,!1,Lf),br(t,r)}}function vp(l,e){const t=this.cache,r=e.elements;if(void 0===r){if(Sr(t,e))return;l.uniformMatrix3fv(this.addr,!1,e),br(t,e)}else{if(Sr(t,r))return;rd.set(r),l.uniformMatrix3fv(this.addr,!1,rd),br(t,r)}}function xg(l,e){const t=this.cache,r=e.elements;if(void 0===r){if(Sr(t,e))return;l.uniformMatrix4fv(this.addr,!1,e),br(t,e)}else{if(Sr(t,r))return;pp.set(r),l.uniformMatrix4fv(this.addr,!1,pp),br(t,r)}}function Eg(l,e){const t=this.cache;t[0]!==e&&(l.uniform1i(this.addr,e),t[0]=e)}function Sg(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(l.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Sr(t,e))return;l.uniform2iv(this.addr,e),br(t,e)}}function bg(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(l.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Sr(t,e))return;l.uniform3iv(this.addr,e),br(t,e)}}function V_(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(l.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Sr(t,e))return;l.uniform4iv(this.addr,e),br(t,e)}}function z_(l,e){const t=this.cache;t[0]!==e&&(l.uniform1ui(this.addr,e),t[0]=e)}function G_(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(l.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Sr(t,e))return;l.uniform2uiv(this.addr,e),br(t,e)}}function W_(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(l.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Sr(t,e))return;l.uniform3uiv(this.addr,e),br(t,e)}}function j_(l,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(l.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Sr(t,e))return;l.uniform4uiv(this.addr,e),br(t,e)}}function hc(l,e,t){const r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(l.uniform1i(this.addr,o),r[0]=o),t.setTexture2D(e||vg,o)}function sd(l,e,t){const r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(l.uniform1i(this.addr,o),r[0]=o),t.setTexture3D(e||yg,o)}function $_(l,e,t){const r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(l.uniform1i(this.addr,o),r[0]=o),t.setTextureCube(e||_g,o)}function Wx(l,e,t){const r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(l.uniform1i(this.addr,o),r[0]=o),t.setTexture2DArray(e||fp,o)}function $x(l,e){l.uniform1fv(this.addr,e)}function Xx(l,e){const t=Oo(e,this.size,2);l.uniform2fv(this.addr,t)}function Yx(l,e){const t=Oo(e,this.size,3);l.uniform3fv(this.addr,t)}function wg(l,e){const t=Oo(e,this.size,4);l.uniform4fv(this.addr,t)}function X_(l,e){const t=Oo(e,this.size,4);l.uniformMatrix2fv(this.addr,!1,t)}function Y_(l,e){const t=Oo(e,this.size,9);l.uniformMatrix3fv(this.addr,!1,t)}function q_(l,e){const t=Oo(e,this.size,16);l.uniformMatrix4fv(this.addr,!1,t)}function Z_(l,e){l.uniform1iv(this.addr,e)}function yp(l,e){l.uniform2iv(this.addr,e)}function Ba(l,e){l.uniform3iv(this.addr,e)}function od(l,e){l.uniform4iv(this.addr,e)}function Tg(l,e){l.uniform1uiv(this.addr,e)}function Ag(l,e){l.uniform2uiv(this.addr,e)}function Cg(l,e){l.uniform3uiv(this.addr,e)}function qx(l,e){l.uniform4uiv(this.addr,e)}function Zx(l,e,t){const r=this.cache,o=e.length,a=mp(t,o);Sr(r,a)||(l.uniform1iv(this.addr,a),br(r,a));for(let u=0;u!==o;++u)t.setTexture2D(e[u]||vg,a[u])}function Kx(l,e,t){const r=this.cache,o=e.length,a=mp(t,o);Sr(r,a)||(l.uniform1iv(this.addr,a),br(r,a));for(let u=0;u!==o;++u)t.setTexture3D(e[u]||yg,a[u])}function _p(l,e,t){const r=this.cache,o=e.length,a=mp(t,o);Sr(r,a)||(l.uniform1iv(this.addr,a),br(r,a));for(let u=0;u!==o;++u)t.setTextureCube(e[u]||_g,a[u])}function Mp(l,e,t){const r=this.cache,o=e.length,a=mp(t,o);Sr(r,a)||(l.uniform1iv(this.addr,a),br(r,a));for(let u=0;u!==o;++u)t.setTexture2DArray(e[u]||fp,a[u])}class Qx{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=function jx(l){switch(l){case 5126:return B_;case 35664:return gp;case 35665:return H_;case 35666:return iu;case 35674:return Nf;case 35675:return vp;case 35676:return xg;case 5124:case 35670:return Eg;case 35667:case 35671:return Sg;case 35668:case 35672:return bg;case 35669:case 35673:return V_;case 5125:return z_;case 36294:return G_;case 36295:return W_;case 36296:return j_;case 35678:case 36198:case 36298:case 36306:case 35682:return hc;case 35679:case 36299:case 36307:return sd;case 35680:case 36300:case 36308:case 36293:return $_;case 36289:case 36303:case 36311:case 36292:return Wx}}(t.type)}}class Dg{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=function Jx(l){switch(l){case 5126:return $x;case 35664:return Xx;case 35665:return Yx;case 35666:return wg;case 35674:return X_;case 35675:return Y_;case 35676:return q_;case 5124:case 35670:return Z_;case 35667:case 35671:return yp;case 35668:case 35672:return Ba;case 35669:case 35673:return od;case 5125:return Tg;case 36294:return Ag;case 36295:return Cg;case 36296:return qx;case 35678:case 36198:case 36298:case 36306:case 35682:return Zx;case 35679:case 36299:case 36307:return Kx;case 35680:case 36300:case 36308:case 36293:return _p;case 36289:case 36303:case 36311:case 36292:return Mp}}(t.type)}}class K_{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const o=this.seq;for(let a=0,u=o.length;a!==u;++a){const f=o[a];f.setValue(e,t[f.id],r)}}}const xp=/(\w+)(\])?(\[|\.)?/g;function Ig(l,e){l.seq.push(e),l.map[e.id]=e}function J_(l,e,t){const r=l.name,o=r.length;for(xp.lastIndex=0;;){const a=xp.exec(r);let f=a[1];const m=a[3];if("]"===a[2]&&(f|=0),void 0===m||"["===m&&xp.lastIndex+2===o){Ig(t,void 0===m?new Qx(f,l,e):new Dg(f,l,e));break}{let y=t.map[f];void 0===y&&(y=new K_(f),Ig(t,y)),t=y}}}class ad{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let o=0;o<r;++o){const a=e.getActiveUniform(t,o);J_(a,e.getUniformLocation(t,a.name),this)}}setValue(e,t,r,o){const a=this.map[t];void 0!==a&&a.setValue(e,r,o)}setOptional(e,t,r){const o=t[r];void 0!==o&&this.setValue(e,r,o)}static upload(e,t,r,o){for(let a=0,u=t.length;a!==u;++a){const f=t[a],p=r[f.id];!1!==p.needsUpdate&&f.setValue(e,p.value,o)}}static seqWithValue(e,t){const r=[];for(let o=0,a=e.length;o!==a;++o){const u=e[o];u.id in t&&r.push(u)}return r}}function cd(l,e,t){const r=l.createShader(e);return l.shaderSource(r,t),l.compileShader(r),r}let Q_=0;function rl(l,e,t){const r=l.getShaderParameter(e,l.COMPILE_STATUS),o=l.getShaderInfoLog(e).trim();if(r&&""===o)return"";const a=/ERROR: 0:(\d+)/.exec(o);if(a){const u=parseInt(a[1]);return t.toUpperCase()+"\n\n"+o+"\n\n"+function Ep(l,e){const t=l.split("\n"),r=[],o=Math.max(e-6,0),a=Math.min(e+6,t.length);for(let u=o;u<a;u++){const f=u+1;r.push(`${f===e?">":" "} ${f}: ${t[u]}`)}return r.join("\n")}(l.getShaderSource(e),u)}return o}function t0(l,e){const t=function e0(l){switch(l){case Oi:return["Linear","( value )"];case _n:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",l),["Linear","( value )"]}}(e);return"vec4 "+l+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function n0(l,e){let t;switch(e){case oi:t="Linear";break;case Xr:t="Reinhard";break;case zn:t="OptimizedCineon";break;case Fn:t="ACESFilmic";break;case $a:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+l+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function ld(l){return""!==l}function Lg(l,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return l.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Ng(l,e){return l.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Og=/^[ \t]*#include +<([\w\d./]+)>/gm;function Fg(l){return l.replace(Og,ud)}const eE=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function ud(l,e){let t=Hn[e];if(void 0===t){const r=eE.get(e);if(void 0===r)throw new Error("Can not resolve #include <"+e+">");t=Hn[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r)}return Fg(t)}const di=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function ru(l){return l.replace(di,Ug)}function Ug(l,e,t,r){let o="";for(let a=parseInt(e);a<parseInt(t);a++)o+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return o}function Sp(l){let e="precision "+l.precision+" float;\nprecision "+l.precision+" int;";return"highp"===l.precision?e+="\n#define HIGH_PRECISION":"mediump"===l.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===l.precision&&(e+="\n#define LOW_PRECISION"),e}function Of(l,e,t,r){const o=l.getContext(),a=t.defines;let u=t.vertexShader,f=t.fragmentShader;const p=function bp(l){let e="SHADOWMAP_TYPE_BASIC";return l.shadowMapType===Vn?e="SHADOWMAP_TYPE_PCF":l.shadowMapType===si?e="SHADOWMAP_TYPE_PCF_SOFT":l.shadowMapType===ni&&(e="SHADOWMAP_TYPE_VSM"),e}(t),m=function kg(l){let e="ENVMAP_TYPE_CUBE";if(l.envMap)switch(l.envMapMode){case Bi:case Ar:e="ENVMAP_TYPE_CUBE";break;case pi:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),v=function s0(l){let e="ENVMAP_MODE_REFLECTION";return l.envMap&&l.envMapMode===Ar&&(e="ENVMAP_MODE_REFRACTION"),e}(t),y=function Bg(l){let e="ENVMAP_BLENDING_NONE";if(l.envMap)switch(l.combine){case nn:e="ENVMAP_BLENDING_MULTIPLY";break;case wl:e="ENVMAP_BLENDING_MIX";break;case _a:e="ENVMAP_BLENDING_ADD"}return e}(t),x=function Hg(l){const e=l.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:r,maxMip:t}}(t),w=t.isWebGL2?"":function Rg(l){return[l.extensionDerivatives||l.envMapCubeUVHeight||l.bumpMap||l.normalMapTangentSpace||l.clearcoatNormalMap||l.flatShading||"physical"===l.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(l.extensionFragDepth||l.logarithmicDepthBuffer)&&l.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",l.extensionDrawBuffers&&l.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(l.extensionShaderTextureLOD||l.envMap||l.transmission)&&l.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ld).join("\n")}(t),D=function Pg(l){const e=[];for(const t in l){const r=l[t];!1!==r&&e.push("#define "+t+" "+r)}return e.join("\n")}(a),N=o.createProgram();let I,A,k=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(I=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,D].filter(ld).join("\n"),I.length>0&&(I+="\n"),A=[w,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,D].filter(ld).join("\n"),A.length>0&&(A+="\n")):(I=[Sp(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,D,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+v:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ld).join("\n"),A=[w,Sp(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,D,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.envMap?"#define "+v:"",t.envMap?"#define "+y:"",x?"#define CUBEUV_TEXEL_WIDTH "+x.texelWidth:"",x?"#define CUBEUV_TEXEL_HEIGHT "+x.texelHeight:"",x?"#define CUBEUV_MAX_MIP "+x.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+p:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Tr?"#define TONE_MAPPING":"",t.toneMapping!==Tr?Hn.tonemapping_pars_fragment:"",t.toneMapping!==Tr?n0("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Hn.colorspace_pars_fragment,t0("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(ld).join("\n")),u=Fg(u),u=Lg(u,t),u=Ng(u,t),f=Fg(f),f=Lg(f,t),f=Ng(f,t),u=ru(u),f=ru(f),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(k="#version 300 es\n",I=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+I,A=["#define varying in",t.glslVersion===na?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===na?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+A);const B=k+A+f,W=cd(o,o.VERTEX_SHADER,k+I+u),Y=cd(o,o.FRAGMENT_SHADER,B);if(o.attachShader(N,W),o.attachShader(N,Y),void 0!==t.index0AttributeName?o.bindAttribLocation(N,0,t.index0AttributeName):!0===t.morphTargets&&o.bindAttribLocation(N,0,"position"),o.linkProgram(N),l.debug.checkShaderErrors){const z=o.getProgramInfoLog(N).trim(),Z=o.getShaderInfoLog(W).trim(),fe=o.getShaderInfoLog(Y).trim();let He=!0,he=!0;if(!1===o.getProgramParameter(N,o.LINK_STATUS))if(He=!1,"function"==typeof l.debug.onShaderError)l.debug.onShaderError(o,N,W,Y);else{const pe=rl(o,W,"vertex"),ve=rl(o,Y,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(N,o.VALIDATE_STATUS)+"\n\nProgram Info Log: "+z+"\n"+pe+"\n"+ve)}else""!==z?console.warn("THREE.WebGLProgram: Program Info Log:",z):(""===Z||""===fe)&&(he=!1);he&&(this.diagnostics={runnable:He,programLog:z,vertexShader:{log:Z,prefix:I},fragmentShader:{log:fe,prefix:A}})}let q,ee;return o.deleteShader(W),o.deleteShader(Y),this.getUniforms=function(){return void 0===q&&(q=new ad(o,N)),q},this.getAttributes=function(){return void 0===ee&&(ee=function r0(l,e){const t={},r=l.getProgramParameter(e,l.ACTIVE_ATTRIBUTES);for(let o=0;o<r;o++){const a=l.getActiveAttrib(e,o),u=a.name;let f=1;a.type===l.FLOAT_MAT2&&(f=2),a.type===l.FLOAT_MAT3&&(f=3),a.type===l.FLOAT_MAT4&&(f=4),t[u]={type:a.type,location:l.getAttribLocation(e,u),locationSize:f}}return t}(o,N)),ee},this.destroy=function(){r.releaseStatesOfProgram(this),o.deleteProgram(N),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Q_++,this.cacheKey=e,this.usedTimes=1,this.program=N,this.vertexShader=W,this.fragmentShader=Y,this}let tE=0;class wp{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const r=e.fragmentShader,o=this._getShaderStage(e.vertexShader),a=this._getShaderStage(r),u=this._getShaderCacheForMaterial(e);return!1===u.has(o)&&(u.add(o),o.usedTimes++),!1===u.has(a)&&(u.add(a),a.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,0===r.usedTimes&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return void 0===r&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return void 0===r&&(r=new o0(e),t.set(e,r)),r}}class o0{constructor(e){this.id=tE++,this.code=e,this.usedTimes=0}}function Tp(l,e,t,r,o,a,u){const f=new an,p=new wp,m=[],v=o.isWebGL2,y=o.logarithmicDepthBuffer,x=o.vertexTextures;let w=o.precision;const D={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function N(z){return 0===z?"uv":`uv${z}`}return{getParameters:function I(z,Z,fe,He,he){const pe=He.fog,ve=he.geometry,Ue=(z.isMeshStandardMaterial?t:e).get(z.envMap||(z.isMeshStandardMaterial?He.environment:null)),ze=Ue&&Ue.mapping===pi?Ue.image.height:null,Ye=D[z.type];null!==z.precision&&(w=o.getMaxPrecision(z.precision),w!==z.precision&&console.warn("THREE.WebGLProgram.getParameters:",z.precision,"not supported, using",w,"instead."));const et=ve.morphAttributes.position||ve.morphAttributes.normal||ve.morphAttributes.color,Rt=void 0!==et?et.length:0;let tt,mt,Pt,Bt,ge=0;if(void 0!==ve.morphAttributes.position&&(ge=1),void 0!==ve.morphAttributes.normal&&(ge=2),void 0!==ve.morphAttributes.color&&(ge=3),Ye){const Ui=Us[Ye];tt=Ui.vertexShader,mt=Ui.fragmentShader}else tt=z.vertexShader,mt=z.fragmentShader,p.update(z),Pt=p.getVertexShaderID(z),Bt=p.getFragmentShaderID(z);const Wt=l.getRenderTarget(),dn=!0===he.isInstancedMesh,ln=!!z.map,fn=!!Ue,ne=!!z.aoMap,vt=!!z.lightMap,Ge=!!z.bumpMap,yt=!!z.normalMap,Ze=!!z.displacementMap,rn=!!z.emissiveMap,Vt=!!z.metalnessMap,Gt=!!z.roughnessMap,Yt=z.anisotropy>0,ei=z.clearcoat>0,zi=z.iridescence>0,te=z.sheen>0,j=z.transmission>0,Se=Yt&&!!z.anisotropyMap,dt=ei&&!!z.clearcoatMap,rt=ei&&!!z.clearcoatNormalMap,pt=ei&&!!z.clearcoatRoughnessMap,Qt=zi&&!!z.iridescenceMap,gt=zi&&!!z.iridescenceThicknessMap,Te=te&&!!z.sheenColorMap,ie=te&&!!z.sheenRoughnessMap,Ke=!!z.specularMap,Ft=!!z.specularColorMap,St=!!z.specularIntensityMap,Ct=j&&!!z.transmissionMap,An=j&&!!z.thicknessMap,ce=!!z.alphaMap,ct=!!z.extensions,xt=!!ve.attributes.uv1,Kn=!!ve.attributes.uv2,Si=!!ve.attributes.uv3;let Li=Tr;return z.toneMapped&&(null===Wt||!0===Wt.isXRRenderTarget)&&(Li=l.toneMapping),{isWebGL2:v,shaderID:Ye,shaderType:z.type,shaderName:z.name,vertexShader:tt,fragmentShader:mt,defines:z.defines,customVertexShaderID:Pt,customFragmentShaderID:Bt,isRawShaderMaterial:!0===z.isRawShaderMaterial,glslVersion:z.glslVersion,precision:w,instancing:dn,instancingColor:dn&&null!==he.instanceColor,supportsVertexTextures:x,outputColorSpace:null===Wt?l.outputColorSpace:!0===Wt.isXRRenderTarget?Wt.texture.colorSpace:Oi,map:ln,matcap:!!z.matcap,envMap:fn,envMapMode:fn&&Ue.mapping,envMapCubeUVHeight:ze,aoMap:ne,lightMap:vt,bumpMap:Ge,normalMap:yt,displacementMap:x&&Ze,emissiveMap:rn,normalMapObjectSpace:yt&&1===z.normalMapType,normalMapTangentSpace:yt&&0===z.normalMapType,metalnessMap:Vt,roughnessMap:Gt,anisotropy:Yt,anisotropyMap:Se,clearcoat:ei,clearcoatMap:dt,clearcoatNormalMap:rt,clearcoatRoughnessMap:pt,iridescence:zi,iridescenceMap:Qt,iridescenceThicknessMap:gt,sheen:te,sheenColorMap:Te,sheenRoughnessMap:ie,specularMap:Ke,specularColorMap:Ft,specularIntensityMap:St,transmission:j,transmissionMap:Ct,thicknessMap:An,gradientMap:!!z.gradientMap,opaque:!1===z.transparent&&1===z.blending,alphaMap:ce,alphaTest:z.alphaTest>0,alphaHash:!!z.alphaHash,combine:z.combine,mapUv:ln&&N(z.map.channel),aoMapUv:ne&&N(z.aoMap.channel),lightMapUv:vt&&N(z.lightMap.channel),bumpMapUv:Ge&&N(z.bumpMap.channel),normalMapUv:yt&&N(z.normalMap.channel),displacementMapUv:Ze&&N(z.displacementMap.channel),emissiveMapUv:rn&&N(z.emissiveMap.channel),metalnessMapUv:Vt&&N(z.metalnessMap.channel),roughnessMapUv:Gt&&N(z.roughnessMap.channel),anisotropyMapUv:Se&&N(z.anisotropyMap.channel),clearcoatMapUv:dt&&N(z.clearcoatMap.channel),clearcoatNormalMapUv:rt&&N(z.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:pt&&N(z.clearcoatRoughnessMap.channel),iridescenceMapUv:Qt&&N(z.iridescenceMap.channel),iridescenceThicknessMapUv:gt&&N(z.iridescenceThicknessMap.channel),sheenColorMapUv:Te&&N(z.sheenColorMap.channel),sheenRoughnessMapUv:ie&&N(z.sheenRoughnessMap.channel),specularMapUv:Ke&&N(z.specularMap.channel),specularColorMapUv:Ft&&N(z.specularColorMap.channel),specularIntensityMapUv:St&&N(z.specularIntensityMap.channel),transmissionMapUv:Ct&&N(z.transmissionMap.channel),thicknessMapUv:An&&N(z.thicknessMap.channel),alphaMapUv:ce&&N(z.alphaMap.channel),vertexTangents:!!ve.attributes.tangent&&(yt||Yt),vertexColors:z.vertexColors,vertexAlphas:!0===z.vertexColors&&!!ve.attributes.color&&4===ve.attributes.color.itemSize,vertexUv1s:xt,vertexUv2s:Kn,vertexUv3s:Si,pointsUvs:!0===he.isPoints&&!!ve.attributes.uv&&(ln||ce),fog:!!pe,useFog:!0===z.fog,fogExp2:pe&&pe.isFogExp2,flatShading:!0===z.flatShading,sizeAttenuation:!0===z.sizeAttenuation,logarithmicDepthBuffer:y,skinning:!0===he.isSkinnedMesh,morphTargets:void 0!==ve.morphAttributes.position,morphNormals:void 0!==ve.morphAttributes.normal,morphColors:void 0!==ve.morphAttributes.color,morphTargetsCount:Rt,morphTextureStride:ge,numDirLights:Z.directional.length,numPointLights:Z.point.length,numSpotLights:Z.spot.length,numSpotLightMaps:Z.spotLightMap.length,numRectAreaLights:Z.rectArea.length,numHemiLights:Z.hemi.length,numDirLightShadows:Z.directionalShadowMap.length,numPointLightShadows:Z.pointShadowMap.length,numSpotLightShadows:Z.spotShadowMap.length,numSpotLightShadowsWithMaps:Z.numSpotLightShadowsWithMaps,numClippingPlanes:u.numPlanes,numClipIntersection:u.numIntersection,dithering:z.dithering,shadowMapEnabled:l.shadowMap.enabled&&fe.length>0,shadowMapType:l.shadowMap.type,toneMapping:Li,useLegacyLights:l._useLegacyLights,decodeVideoTexture:ln&&!0===z.map.isVideoTexture&&z.map.colorSpace===_n,premultipliedAlpha:z.premultipliedAlpha,doubleSided:2===z.side,flipSided:1===z.side,useDepthPacking:z.depthPacking>=0,depthPacking:z.depthPacking||0,index0AttributeName:z.index0AttributeName,extensionDerivatives:ct&&!0===z.extensions.derivatives,extensionFragDepth:ct&&!0===z.extensions.fragDepth,extensionDrawBuffers:ct&&!0===z.extensions.drawBuffers,extensionShaderTextureLOD:ct&&!0===z.extensions.shaderTextureLOD,rendererExtensionFragDepth:v||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:v||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:v||r.has("EXT_shader_texture_lod"),customProgramCacheKey:z.customProgramCacheKey()}},getProgramCacheKey:function A(z){const Z=[];if(z.shaderID?Z.push(z.shaderID):(Z.push(z.customVertexShaderID),Z.push(z.customFragmentShaderID)),void 0!==z.defines)for(const fe in z.defines)Z.push(fe),Z.push(z.defines[fe]);return!1===z.isRawShaderMaterial&&(function k(z,Z){z.push(Z.precision),z.push(Z.outputColorSpace),z.push(Z.envMapMode),z.push(Z.envMapCubeUVHeight),z.push(Z.mapUv),z.push(Z.alphaMapUv),z.push(Z.lightMapUv),z.push(Z.aoMapUv),z.push(Z.bumpMapUv),z.push(Z.normalMapUv),z.push(Z.displacementMapUv),z.push(Z.emissiveMapUv),z.push(Z.metalnessMapUv),z.push(Z.roughnessMapUv),z.push(Z.anisotropyMapUv),z.push(Z.clearcoatMapUv),z.push(Z.clearcoatNormalMapUv),z.push(Z.clearcoatRoughnessMapUv),z.push(Z.iridescenceMapUv),z.push(Z.iridescenceThicknessMapUv),z.push(Z.sheenColorMapUv),z.push(Z.sheenRoughnessMapUv),z.push(Z.specularMapUv),z.push(Z.specularColorMapUv),z.push(Z.specularIntensityMapUv),z.push(Z.transmissionMapUv),z.push(Z.thicknessMapUv),z.push(Z.combine),z.push(Z.fogExp2),z.push(Z.sizeAttenuation),z.push(Z.morphTargetsCount),z.push(Z.morphAttributeCount),z.push(Z.numDirLights),z.push(Z.numPointLights),z.push(Z.numSpotLights),z.push(Z.numSpotLightMaps),z.push(Z.numHemiLights),z.push(Z.numRectAreaLights),z.push(Z.numDirLightShadows),z.push(Z.numPointLightShadows),z.push(Z.numSpotLightShadows),z.push(Z.numSpotLightShadowsWithMaps),z.push(Z.shadowMapType),z.push(Z.toneMapping),z.push(Z.numClippingPlanes),z.push(Z.numClipIntersection),z.push(Z.depthPacking)}(Z,z),function O(z,Z){f.disableAll(),Z.isWebGL2&&f.enable(0),Z.supportsVertexTextures&&f.enable(1),Z.instancing&&f.enable(2),Z.instancingColor&&f.enable(3),Z.matcap&&f.enable(4),Z.envMap&&f.enable(5),Z.normalMapObjectSpace&&f.enable(6),Z.normalMapTangentSpace&&f.enable(7),Z.clearcoat&&f.enable(8),Z.iridescence&&f.enable(9),Z.alphaTest&&f.enable(10),Z.vertexColors&&f.enable(11),Z.vertexAlphas&&f.enable(12),Z.vertexUv1s&&f.enable(13),Z.vertexUv2s&&f.enable(14),Z.vertexUv3s&&f.enable(15),Z.vertexTangents&&f.enable(16),Z.anisotropy&&f.enable(17),z.push(f.mask),f.disableAll(),Z.fog&&f.enable(0),Z.useFog&&f.enable(1),Z.flatShading&&f.enable(2),Z.logarithmicDepthBuffer&&f.enable(3),Z.skinning&&f.enable(4),Z.morphTargets&&f.enable(5),Z.morphNormals&&f.enable(6),Z.morphColors&&f.enable(7),Z.premultipliedAlpha&&f.enable(8),Z.shadowMapEnabled&&f.enable(9),Z.useLegacyLights&&f.enable(10),Z.doubleSided&&f.enable(11),Z.flipSided&&f.enable(12),Z.useDepthPacking&&f.enable(13),Z.dithering&&f.enable(14),Z.transmission&&f.enable(15),Z.sheen&&f.enable(16),Z.opaque&&f.enable(17),Z.pointsUvs&&f.enable(18),Z.decodeVideoTexture&&f.enable(19),z.push(f.mask)}(Z,z),Z.push(l.outputColorSpace)),Z.push(z.customProgramCacheKey),Z.join()},getUniforms:function B(z){const Z=D[z.type];let fe;return fe=Z?zy.clone(Us[Z].uniforms):z.uniforms,fe},acquireProgram:function W(z,Z){let fe;for(let He=0,he=m.length;He<he;He++){const pe=m[He];if(pe.cacheKey===Z){fe=pe,++fe.usedTimes;break}}return void 0===fe&&(fe=new Of(l,Z,z,a),m.push(fe)),fe},releaseProgram:function Y(z){if(0==--z.usedTimes){const Z=m.indexOf(z);m[Z]=m[m.length-1],m.pop(),z.destroy()}},releaseShaderCache:function q(z){p.remove(z)},programs:m,dispose:function ee(){p.dispose()}}}function Vg(){let l=new WeakMap;return{get:function e(a){let u=l.get(a);return void 0===u&&(u={},l.set(a,u)),u},remove:function t(a){l.delete(a)},update:function r(a,u,f){l.get(a)[u]=f},dispose:function o(){l=new WeakMap}}}function zg(l,e){return l.groupOrder!==e.groupOrder?l.groupOrder-e.groupOrder:l.renderOrder!==e.renderOrder?l.renderOrder-e.renderOrder:l.material.id!==e.material.id?l.material.id-e.material.id:l.z!==e.z?l.z-e.z:l.id-e.id}function pc(l,e){return l.groupOrder!==e.groupOrder?l.groupOrder-e.groupOrder:l.renderOrder!==e.renderOrder?l.renderOrder-e.renderOrder:l.z!==e.z?e.z-l.z:l.id-e.id}function Gg(){const l=[];let e=0;const t=[],r=[],o=[];function u(y,x,w,D,N,I){let A=l[e];return void 0===A?(A={id:y.id,object:y,geometry:x,material:w,groupOrder:D,renderOrder:y.renderOrder,z:N,group:I},l[e]=A):(A.id=y.id,A.object=y,A.geometry=x,A.material=w,A.groupOrder=D,A.renderOrder=y.renderOrder,A.z=N,A.group=I),e++,A}return{opaque:t,transmissive:r,transparent:o,init:function a(){e=0,t.length=0,r.length=0,o.length=0},push:function f(y,x,w,D,N,I){const A=u(y,x,w,D,N,I);w.transmission>0?r.push(A):!0===w.transparent?o.push(A):t.push(A)},unshift:function p(y,x,w,D,N,I){const A=u(y,x,w,D,N,I);w.transmission>0?r.unshift(A):!0===w.transparent?o.unshift(A):t.unshift(A)},finish:function v(){for(let y=e,x=l.length;y<x;y++){const w=l[y];if(null===w.id)break;w.id=null,w.object=null,w.geometry=null,w.material=null,w.group=null}},sort:function m(y,x){t.length>1&&t.sort(y||zg),r.length>1&&r.sort(x||pc),o.length>1&&o.sort(x||pc)}}}function Ap(){let l=new WeakMap;return{get:function e(r,o){const a=l.get(r);let u;return void 0===a?(u=new Gg,l.set(r,[u])):o>=a.length?(u=new Gg,a.push(u)):u=a[o],u},dispose:function t(){l=new WeakMap}}}function Ff(){const l={};return{get:function(e){if(void 0!==l[e.id])return l[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new $,color:new It};break;case"SpotLight":t={position:new $,direction:new $,color:new It,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new $,color:new It,distance:0,decay:0};break;case"HemisphereLight":t={direction:new $,skyColor:new It,groundColor:new It};break;case"RectAreaLight":t={color:new It,position:new $,halfWidth:new $,halfHeight:new $}}return l[e.id]=t,t}}}let Cp=0;function Uf(l,e){return(e.castShadow?2:0)-(l.castShadow?2:0)+(e.map?1:0)-(l.map?1:0)}function ua(l,e){const t=new Ff,r=function a0(){const l={};return{get:function(e){if(void 0!==l[e.id])return l[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Re};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Re,shadowCameraNear:1,shadowCameraFar:1e3}}return l[e.id]=t,t}}}(),o={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let v=0;v<9;v++)o.probe.push(new $);const a=new $,u=new Ht,f=new Ht;return{setup:function p(v,y){let x=0,w=0,D=0;for(let fe=0;fe<9;fe++)o.probe[fe].set(0,0,0);let N=0,I=0,A=0,k=0,O=0,B=0,W=0,Y=0,q=0,ee=0;v.sort(Uf);const z=!0===y?Math.PI:1;for(let fe=0,He=v.length;fe<He;fe++){const he=v[fe],pe=he.color,ve=he.intensity,Xe=he.distance,Ue=he.shadow&&he.shadow.map?he.shadow.map.texture:null;if(he.isAmbientLight)x+=pe.r*ve*z,w+=pe.g*ve*z,D+=pe.b*ve*z;else if(he.isLightProbe)for(let ze=0;ze<9;ze++)o.probe[ze].addScaledVector(he.sh.coefficients[ze],ve);else if(he.isDirectionalLight){const ze=t.get(he);if(ze.color.copy(he.color).multiplyScalar(he.intensity*z),he.castShadow){const Ye=he.shadow,et=r.get(he);et.shadowBias=Ye.bias,et.shadowNormalBias=Ye.normalBias,et.shadowRadius=Ye.radius,et.shadowMapSize=Ye.mapSize,o.directionalShadow[N]=et,o.directionalShadowMap[N]=Ue,o.directionalShadowMatrix[N]=he.shadow.matrix,B++}o.directional[N]=ze,N++}else if(he.isSpotLight){const ze=t.get(he);ze.position.setFromMatrixPosition(he.matrixWorld),ze.color.copy(pe).multiplyScalar(ve*z),ze.distance=Xe,ze.coneCos=Math.cos(he.angle),ze.penumbraCos=Math.cos(he.angle*(1-he.penumbra)),ze.decay=he.decay,o.spot[A]=ze;const Ye=he.shadow;if(he.map&&(o.spotLightMap[q]=he.map,q++,Ye.updateMatrices(he),he.castShadow&&ee++),o.spotLightMatrix[A]=Ye.matrix,he.castShadow){const et=r.get(he);et.shadowBias=Ye.bias,et.shadowNormalBias=Ye.normalBias,et.shadowRadius=Ye.radius,et.shadowMapSize=Ye.mapSize,o.spotShadow[A]=et,o.spotShadowMap[A]=Ue,Y++}A++}else if(he.isRectAreaLight){const ze=t.get(he);ze.color.copy(pe).multiplyScalar(ve),ze.halfWidth.set(.5*he.width,0,0),ze.halfHeight.set(0,.5*he.height,0),o.rectArea[k]=ze,k++}else if(he.isPointLight){const ze=t.get(he);if(ze.color.copy(he.color).multiplyScalar(he.intensity*z),ze.distance=he.distance,ze.decay=he.decay,he.castShadow){const Ye=he.shadow,et=r.get(he);et.shadowBias=Ye.bias,et.shadowNormalBias=Ye.normalBias,et.shadowRadius=Ye.radius,et.shadowMapSize=Ye.mapSize,et.shadowCameraNear=Ye.camera.near,et.shadowCameraFar=Ye.camera.far,o.pointShadow[I]=et,o.pointShadowMap[I]=Ue,o.pointShadowMatrix[I]=he.shadow.matrix,W++}o.point[I]=ze,I++}else if(he.isHemisphereLight){const ze=t.get(he);ze.skyColor.copy(he.color).multiplyScalar(ve*z),ze.groundColor.copy(he.groundColor).multiplyScalar(ve*z),o.hemi[O]=ze,O++}}k>0&&(e.isWebGL2||!0===l.has("OES_texture_float_linear")?(o.rectAreaLTC1=bt.LTC_FLOAT_1,o.rectAreaLTC2=bt.LTC_FLOAT_2):!0===l.has("OES_texture_half_float_linear")?(o.rectAreaLTC1=bt.LTC_HALF_1,o.rectAreaLTC2=bt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),o.ambient[0]=x,o.ambient[1]=w,o.ambient[2]=D;const Z=o.hash;(Z.directionalLength!==N||Z.pointLength!==I||Z.spotLength!==A||Z.rectAreaLength!==k||Z.hemiLength!==O||Z.numDirectionalShadows!==B||Z.numPointShadows!==W||Z.numSpotShadows!==Y||Z.numSpotMaps!==q)&&(o.directional.length=N,o.spot.length=A,o.rectArea.length=k,o.point.length=I,o.hemi.length=O,o.directionalShadow.length=B,o.directionalShadowMap.length=B,o.pointShadow.length=W,o.pointShadowMap.length=W,o.spotShadow.length=Y,o.spotShadowMap.length=Y,o.directionalShadowMatrix.length=B,o.pointShadowMatrix.length=W,o.spotLightMatrix.length=Y+q-ee,o.spotLightMap.length=q,o.numSpotLightShadowsWithMaps=ee,Z.directionalLength=N,Z.pointLength=I,Z.spotLength=A,Z.rectAreaLength=k,Z.hemiLength=O,Z.numDirectionalShadows=B,Z.numPointShadows=W,Z.numSpotShadows=Y,Z.numSpotMaps=q,o.version=Cp++)},setupView:function m(v,y){let x=0,w=0,D=0,N=0,I=0;const A=y.matrixWorldInverse;for(let k=0,O=v.length;k<O;k++){const B=v[k];if(B.isDirectionalLight){const W=o.directional[x];W.direction.setFromMatrixPosition(B.matrixWorld),a.setFromMatrixPosition(B.target.matrixWorld),W.direction.sub(a),W.direction.transformDirection(A),x++}else if(B.isSpotLight){const W=o.spot[D];W.position.setFromMatrixPosition(B.matrixWorld),W.position.applyMatrix4(A),W.direction.setFromMatrixPosition(B.matrixWorld),a.setFromMatrixPosition(B.target.matrixWorld),W.direction.sub(a),W.direction.transformDirection(A),D++}else if(B.isRectAreaLight){const W=o.rectArea[N];W.position.setFromMatrixPosition(B.matrixWorld),W.position.applyMatrix4(A),f.identity(),u.copy(B.matrixWorld),u.premultiply(A),f.extractRotation(u),W.halfWidth.set(.5*B.width,0,0),W.halfHeight.set(0,.5*B.height,0),W.halfWidth.applyMatrix4(f),W.halfHeight.applyMatrix4(f),N++}else if(B.isPointLight){const W=o.point[w];W.position.setFromMatrixPosition(B.matrixWorld),W.position.applyMatrix4(A),w++}else if(B.isHemisphereLight){const W=o.hemi[I];W.direction.setFromMatrixPosition(B.matrixWorld),W.direction.transformDirection(A),I++}}},state:o}}function dd(l,e){const t=new ua(l,e),r=[],o=[];return{init:function a(){r.length=0,o.length=0},state:{lightsArray:r,shadowsArray:o,lights:t},setupLights:function p(y){t.setup(r,y)},setupLightsView:function m(y){t.setupView(r,y)},pushLight:function u(y){r.push(y)},pushShadow:function f(y){o.push(y)}}}function Dp(l,e){let t=new WeakMap;return{get:function r(a,u=0){const f=t.get(a);let p;return void 0===f?(p=new dd(l,e),t.set(a,[p])):u>=f.length?(p=new dd(l,e),f.push(p)):p=f[u],p},dispose:function o(){t=new WeakMap}}}class Wg extends Ms{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class jg extends Ms{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function c0(l,e,t){let r=new df;const o=new Re,a=new Re,u=new L,f=new Wg({depthPacking:3201}),p=new jg,m={},v=t.maxTextureSize,y={0:1,1:0,2:2},x=new Lo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Re},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),w=x.clone();w.defines.HORIZONTAL_PASS=1;const D=new Bn;D.setAttribute("position",new H(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const N=new pr(D,x),I=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Vn;let A=this.type;function k(W,Y){const q=e.update(N);x.defines.VSM_SAMPLES!==W.blurSamples&&(x.defines.VSM_SAMPLES=W.blurSamples,w.defines.VSM_SAMPLES=W.blurSamples,x.needsUpdate=!0,w.needsUpdate=!0),null===W.mapPass&&(W.mapPass=new P(o.x,o.y)),x.uniforms.shadow_pass.value=W.map.texture,x.uniforms.resolution.value=W.mapSize,x.uniforms.radius.value=W.radius,l.setRenderTarget(W.mapPass),l.clear(),l.renderBufferDirect(Y,null,q,x,N,null),w.uniforms.shadow_pass.value=W.mapPass.texture,w.uniforms.resolution.value=W.mapSize,w.uniforms.radius.value=W.radius,l.setRenderTarget(W.map),l.clear(),l.renderBufferDirect(Y,null,q,w,N,null)}function O(W,Y,q,ee){let z=null;const Z=!0===q.isPointLight?W.customDistanceMaterial:W.customDepthMaterial;if(void 0!==Z)z=Z;else if(z=!0===q.isPointLight?p:f,l.localClippingEnabled&&!0===Y.clipShadows&&Array.isArray(Y.clippingPlanes)&&0!==Y.clippingPlanes.length||Y.displacementMap&&0!==Y.displacementScale||Y.alphaMap&&Y.alphaTest>0||Y.map&&Y.alphaTest>0){const fe=z.uuid,He=Y.uuid;let he=m[fe];void 0===he&&(he={},m[fe]=he);let pe=he[He];void 0===pe&&(pe=z.clone(),he[He]=pe),z=pe}return z.visible=Y.visible,z.wireframe=Y.wireframe,z.side=ee===ni?null!==Y.shadowSide?Y.shadowSide:Y.side:null!==Y.shadowSide?Y.shadowSide:y[Y.side],z.alphaMap=Y.alphaMap,z.alphaTest=Y.alphaTest,z.map=Y.map,z.clipShadows=Y.clipShadows,z.clippingPlanes=Y.clippingPlanes,z.clipIntersection=Y.clipIntersection,z.displacementMap=Y.displacementMap,z.displacementScale=Y.displacementScale,z.displacementBias=Y.displacementBias,z.wireframeLinewidth=Y.wireframeLinewidth,z.linewidth=Y.linewidth,!0===q.isPointLight&&!0===z.isMeshDistanceMaterial&&(l.properties.get(z).light=q),z}function B(W,Y,q,ee,z){if(!1===W.visible)return;if(W.layers.test(Y.layers)&&(W.isMesh||W.isLine||W.isPoints)&&(W.castShadow||W.receiveShadow&&z===ni)&&(!W.frustumCulled||r.intersectsObject(W))){W.modelViewMatrix.multiplyMatrices(q.matrixWorldInverse,W.matrixWorld);const He=e.update(W),he=W.material;if(Array.isArray(he)){const pe=He.groups;for(let ve=0,Xe=pe.length;ve<Xe;ve++){const Ue=pe[ve],ze=he[Ue.materialIndex];if(ze&&ze.visible){const Ye=O(W,ze,ee,z);l.renderBufferDirect(q,null,He,Ye,W,Ue)}}}else if(he.visible){const pe=O(W,he,ee,z);l.renderBufferDirect(q,null,He,pe,W,null)}}const fe=W.children;for(let He=0,he=fe.length;He<he;He++)B(fe[He],Y,q,ee,z)}this.render=function(W,Y,q){if(!1===I.enabled||!1===I.autoUpdate&&!1===I.needsUpdate||0===W.length)return;const ee=l.getRenderTarget(),z=l.getActiveCubeFace(),Z=l.getActiveMipmapLevel(),fe=l.state;fe.setBlending(0),fe.buffers.color.setClear(1,1,1,1),fe.buffers.depth.setTest(!0),fe.setScissorTest(!1);const He=A!==ni&&this.type===ni,he=A===ni&&this.type!==ni;for(let pe=0,ve=W.length;pe<ve;pe++){const Xe=W[pe],Ue=Xe.shadow;if(void 0===Ue){console.warn("THREE.WebGLShadowMap:",Xe,"has no shadow.");continue}if(!1===Ue.autoUpdate&&!1===Ue.needsUpdate)continue;o.copy(Ue.mapSize);const ze=Ue.getFrameExtents();if(o.multiply(ze),a.copy(Ue.mapSize),(o.x>v||o.y>v)&&(o.x>v&&(a.x=Math.floor(v/ze.x),o.x=a.x*ze.x,Ue.mapSize.x=a.x),o.y>v&&(a.y=Math.floor(v/ze.y),o.y=a.y*ze.y,Ue.mapSize.y=a.y)),null===Ue.map||!0===He||!0===he){const et=this.type!==ni?{minFilter:Zn,magFilter:Zn}:{};null!==Ue.map&&Ue.map.dispose(),Ue.map=new P(o.x,o.y,et),Ue.map.texture.name=Xe.name+".shadowMap",Ue.camera.updateProjectionMatrix()}l.setRenderTarget(Ue.map),l.clear();const Ye=Ue.getViewportCount();for(let et=0;et<Ye;et++){const Rt=Ue.getViewport(et);u.set(a.x*Rt.x,a.y*Rt.y,a.x*Rt.z,a.y*Rt.w),fe.viewport(u),Ue.updateMatrices(Xe,et),r=Ue.getFrustum(),B(Y,q,Ue.camera,Xe,this.type)}!0!==Ue.isPointLightShadow&&this.type===ni&&k(Ue,q),Ue.needsUpdate=!1}A=this.type,I.needsUpdate=!1,l.setRenderTarget(ee,z,Z)}}function l0(l,e,t){const r=t.isWebGL2,f=new function o(){let ce=!1;const Lt=new L;let we=null;const ct=new L(0,0,0,0);return{setMask:function(xt){we!==xt&&!ce&&(l.colorMask(xt,xt,xt,xt),we=xt)},setLocked:function(xt){ce=xt},setClear:function(xt,Kn,Si,Li,ws){!0===ws&&(xt*=Li,Kn*=Li,Si*=Li),Lt.set(xt,Kn,Si,Li),!1===ct.equals(Lt)&&(l.clearColor(xt,Kn,Si,Li),ct.copy(Lt))},reset:function(){ce=!1,we=null,ct.set(-1,0,0,0)}}},p=new function a(){let ce=!1,Lt=null,we=null,ct=null;return{setTest:function(xt){xt?Wt(l.DEPTH_TEST):dn(l.DEPTH_TEST)},setMask:function(xt){Lt!==xt&&!ce&&(l.depthMask(xt),Lt=xt)},setFunc:function(xt){if(we!==xt){switch(xt){case 0:l.depthFunc(l.NEVER);break;case 1:l.depthFunc(l.ALWAYS);break;case 2:l.depthFunc(l.LESS);break;case 3:default:l.depthFunc(l.LEQUAL);break;case 4:l.depthFunc(l.EQUAL);break;case 5:l.depthFunc(l.GEQUAL);break;case 6:l.depthFunc(l.GREATER);break;case 7:l.depthFunc(l.NOTEQUAL)}we=xt}},setLocked:function(xt){ce=xt},setClear:function(xt){ct!==xt&&(l.clearDepth(xt),ct=xt)},reset:function(){ce=!1,Lt=null,we=null,ct=null}}},m=new function u(){let ce=!1,Lt=null,we=null,ct=null,xt=null,Kn=null,Si=null,Li=null,ws=null;return{setTest:function(Ui){ce||(Ui?Wt(l.STENCIL_TEST):dn(l.STENCIL_TEST))},setMask:function(Ui){Lt!==Ui&&!ce&&(l.stencilMask(Ui),Lt=Ui)},setFunc:function(Ui,va,ns){(we!==Ui||ct!==va||xt!==ns)&&(l.stencilFunc(Ui,va,ns),we=Ui,ct=va,xt=ns)},setOp:function(Ui,va,ns){(Kn!==Ui||Si!==va||Li!==ns)&&(l.stencilOp(Ui,va,ns),Kn=Ui,Si=va,Li=ns)},setLocked:function(Ui){ce=Ui},setClear:function(Ui){ws!==Ui&&(l.clearStencil(Ui),ws=Ui)},reset:function(){ce=!1,Lt=null,we=null,ct=null,xt=null,Kn=null,Si=null,Li=null,ws=null}}},v=new WeakMap,y=new WeakMap;let x={},w={},D=new WeakMap,N=[],I=null,A=!1,k=null,O=null,B=null,W=null,Y=null,q=null,ee=null,z=!1,Z=null,fe=null,He=null,he=null,pe=null;const ve=l.getParameter(l.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Xe=!1,Ue=0;const ze=l.getParameter(l.VERSION);-1!==ze.indexOf("WebGL")?(Ue=parseFloat(/^WebGL (\d)/.exec(ze)[1]),Xe=Ue>=1):-1!==ze.indexOf("OpenGL ES")&&(Ue=parseFloat(/^OpenGL ES (\d)/.exec(ze)[1]),Xe=Ue>=2);let Ye=null,et={};const Rt=l.getParameter(l.SCISSOR_BOX),ge=l.getParameter(l.VIEWPORT),tt=(new L).fromArray(Rt),mt=(new L).fromArray(ge);function Pt(ce,Lt,we,ct){const xt=new Uint8Array(4),Kn=l.createTexture();l.bindTexture(ce,Kn),l.texParameteri(ce,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(ce,l.TEXTURE_MAG_FILTER,l.NEAREST);for(let Si=0;Si<we;Si++)!r||ce!==l.TEXTURE_3D&&ce!==l.TEXTURE_2D_ARRAY?l.texImage2D(Lt+Si,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,xt):l.texImage3D(Lt,0,l.RGBA,1,1,ct,0,l.RGBA,l.UNSIGNED_BYTE,xt);return Kn}const Bt={};function Wt(ce){!0!==x[ce]&&(l.enable(ce),x[ce]=!0)}function dn(ce){!1!==x[ce]&&(l.disable(ce),x[ce]=!1)}Bt[l.TEXTURE_2D]=Pt(l.TEXTURE_2D,l.TEXTURE_2D,1),Bt[l.TEXTURE_CUBE_MAP]=Pt(l.TEXTURE_CUBE_MAP,l.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(Bt[l.TEXTURE_2D_ARRAY]=Pt(l.TEXTURE_2D_ARRAY,l.TEXTURE_2D_ARRAY,1,1),Bt[l.TEXTURE_3D]=Pt(l.TEXTURE_3D,l.TEXTURE_3D,1,1)),f.setClear(0,0,0,1),p.setClear(1),m.setClear(0),Wt(l.DEPTH_TEST),p.setFunc(3),Ze(!1),rn(1),Wt(l.CULL_FACE),Ge(0);const ne={100:l.FUNC_ADD,101:l.FUNC_SUBTRACT,102:l.FUNC_REVERSE_SUBTRACT};if(r)ne[103]=l.MIN,ne[104]=l.MAX;else{const ce=e.get("EXT_blend_minmax");null!==ce&&(ne[103]=ce.MIN_EXT,ne[104]=ce.MAX_EXT)}const vt={200:l.ZERO,201:l.ONE,202:l.SRC_COLOR,204:l.SRC_ALPHA,210:l.SRC_ALPHA_SATURATE,208:l.DST_COLOR,206:l.DST_ALPHA,203:l.ONE_MINUS_SRC_COLOR,205:l.ONE_MINUS_SRC_ALPHA,209:l.ONE_MINUS_DST_COLOR,207:l.ONE_MINUS_DST_ALPHA};function Ge(ce,Lt,we,ct,xt,Kn,Si,Li){if(0!==ce){if(!1===A&&(Wt(l.BLEND),A=!0),5===ce)xt=xt||Lt,Kn=Kn||we,Si=Si||ct,(Lt!==O||xt!==Y)&&(l.blendEquationSeparate(ne[Lt],ne[xt]),O=Lt,Y=xt),(we!==B||ct!==W||Kn!==q||Si!==ee)&&(l.blendFuncSeparate(vt[we],vt[ct],vt[Kn],vt[Si]),B=we,W=ct,q=Kn,ee=Si),k=ce,z=!1;else if(ce!==k||Li!==z){if((100!==O||100!==Y)&&(l.blendEquation(l.FUNC_ADD),O=100,Y=100),Li)switch(ce){case 1:l.blendFuncSeparate(l.ONE,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA);break;case 2:l.blendFunc(l.ONE,l.ONE);break;case 3:l.blendFuncSeparate(l.ZERO,l.ONE_MINUS_SRC_COLOR,l.ZERO,l.ONE);break;case 4:l.blendFuncSeparate(l.ZERO,l.SRC_COLOR,l.ZERO,l.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ce)}else switch(ce){case 1:l.blendFuncSeparate(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA,l.ONE,l.ONE_MINUS_SRC_ALPHA);break;case 2:l.blendFunc(l.SRC_ALPHA,l.ONE);break;case 3:l.blendFuncSeparate(l.ZERO,l.ONE_MINUS_SRC_COLOR,l.ZERO,l.ONE);break;case 4:l.blendFunc(l.ZERO,l.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ce)}B=null,W=null,q=null,ee=null,k=ce,z=Li}}else!0===A&&(dn(l.BLEND),A=!1)}function Ze(ce){Z!==ce&&(l.frontFace(ce?l.CW:l.CCW),Z=ce)}function rn(ce){0!==ce?(Wt(l.CULL_FACE),ce!==fe&&l.cullFace(1===ce?l.BACK:2===ce?l.FRONT:l.FRONT_AND_BACK)):dn(l.CULL_FACE),fe=ce}function Gt(ce,Lt,we){ce?(Wt(l.POLYGON_OFFSET_FILL),(he!==Lt||pe!==we)&&(l.polygonOffset(Lt,we),he=Lt,pe=we)):dn(l.POLYGON_OFFSET_FILL)}return{buffers:{color:f,depth:p,stencil:m},enable:Wt,disable:dn,bindFramebuffer:function ln(ce,Lt){return w[ce]!==Lt&&(l.bindFramebuffer(ce,Lt),w[ce]=Lt,r&&(ce===l.DRAW_FRAMEBUFFER&&(w[l.FRAMEBUFFER]=Lt),ce===l.FRAMEBUFFER&&(w[l.DRAW_FRAMEBUFFER]=Lt)),!0)},drawBuffers:function Wn(ce,Lt){let we=N,ct=!1;if(ce)if(we=D.get(Lt),void 0===we&&(we=[],D.set(Lt,we)),ce.isWebGLMultipleRenderTargets){const xt=ce.texture;if(we.length!==xt.length||we[0]!==l.COLOR_ATTACHMENT0){for(let Kn=0,Si=xt.length;Kn<Si;Kn++)we[Kn]=l.COLOR_ATTACHMENT0+Kn;we.length=xt.length,ct=!0}}else we[0]!==l.COLOR_ATTACHMENT0&&(we[0]=l.COLOR_ATTACHMENT0,ct=!0);else we[0]!==l.BACK&&(we[0]=l.BACK,ct=!0);ct&&(t.isWebGL2?l.drawBuffers(we):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(we))},useProgram:function fn(ce){return I!==ce&&(l.useProgram(ce),I=ce,!0)},setBlending:Ge,setMaterial:function yt(ce,Lt){2===ce.side?dn(l.CULL_FACE):Wt(l.CULL_FACE);let we=1===ce.side;Lt&&(we=!we),Ze(we),1===ce.blending&&!1===ce.transparent?Ge(0):Ge(ce.blending,ce.blendEquation,ce.blendSrc,ce.blendDst,ce.blendEquationAlpha,ce.blendSrcAlpha,ce.blendDstAlpha,ce.premultipliedAlpha),p.setFunc(ce.depthFunc),p.setTest(ce.depthTest),p.setMask(ce.depthWrite),f.setMask(ce.colorWrite);const ct=ce.stencilWrite;m.setTest(ct),ct&&(m.setMask(ce.stencilWriteMask),m.setFunc(ce.stencilFunc,ce.stencilRef,ce.stencilFuncMask),m.setOp(ce.stencilFail,ce.stencilZFail,ce.stencilZPass)),Gt(ce.polygonOffset,ce.polygonOffsetFactor,ce.polygonOffsetUnits),!0===ce.alphaToCoverage?Wt(l.SAMPLE_ALPHA_TO_COVERAGE):dn(l.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Ze,setCullFace:rn,setLineWidth:function Vt(ce){ce!==He&&(Xe&&l.lineWidth(ce),He=ce)},setPolygonOffset:Gt,setScissorTest:function Yt(ce){ce?Wt(l.SCISSOR_TEST):dn(l.SCISSOR_TEST)},activeTexture:function ei(ce){void 0===ce&&(ce=l.TEXTURE0+ve-1),Ye!==ce&&(l.activeTexture(ce),Ye=ce)},bindTexture:function zi(ce,Lt,we){void 0===we&&(we=null===Ye?l.TEXTURE0+ve-1:Ye);let ct=et[we];void 0===ct&&(ct={type:void 0,texture:void 0},et[we]=ct),(ct.type!==ce||ct.texture!==Lt)&&(Ye!==we&&(l.activeTexture(we),Ye=we),l.bindTexture(ce,Lt||Bt[ce]),ct.type=ce,ct.texture=Lt)},unbindTexture:function te(){const ce=et[Ye];void 0!==ce&&void 0!==ce.type&&(l.bindTexture(ce.type,null),ce.type=void 0,ce.texture=void 0)},compressedTexImage2D:function j(){try{l.compressedTexImage2D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},compressedTexImage3D:function Se(){try{l.compressedTexImage3D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},texImage2D:function ie(){try{l.texImage2D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},texImage3D:function Ke(){try{l.texImage3D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},updateUBOMapping:function Ct(ce,Lt){let we=y.get(Lt);void 0===we&&(we=new WeakMap,y.set(Lt,we));let ct=we.get(ce);void 0===ct&&(ct=l.getUniformBlockIndex(Lt,ce.name),we.set(ce,ct))},uniformBlockBinding:function An(ce,Lt){const ct=y.get(Lt).get(ce);v.get(Lt)!==ct&&(l.uniformBlockBinding(Lt,ct,ce.__bindingPointIndex),v.set(Lt,ct))},texStorage2D:function gt(){try{l.texStorage2D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},texStorage3D:function Te(){try{l.texStorage3D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},texSubImage2D:function dt(){try{l.texSubImage2D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},texSubImage3D:function rt(){try{l.texSubImage3D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},compressedTexSubImage2D:function pt(){try{l.compressedTexSubImage2D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},compressedTexSubImage3D:function Qt(){try{l.compressedTexSubImage3D.apply(l,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},scissor:function Ft(ce){!1===tt.equals(ce)&&(l.scissor(ce.x,ce.y,ce.z,ce.w),tt.copy(ce))},viewport:function St(ce){!1===mt.equals(ce)&&(l.viewport(ce.x,ce.y,ce.z,ce.w),mt.copy(ce))},reset:function ti(){l.disable(l.BLEND),l.disable(l.CULL_FACE),l.disable(l.DEPTH_TEST),l.disable(l.POLYGON_OFFSET_FILL),l.disable(l.SCISSOR_TEST),l.disable(l.STENCIL_TEST),l.disable(l.SAMPLE_ALPHA_TO_COVERAGE),l.blendEquation(l.FUNC_ADD),l.blendFunc(l.ONE,l.ZERO),l.blendFuncSeparate(l.ONE,l.ZERO,l.ONE,l.ZERO),l.colorMask(!0,!0,!0,!0),l.clearColor(0,0,0,0),l.depthMask(!0),l.depthFunc(l.LESS),l.clearDepth(1),l.stencilMask(4294967295),l.stencilFunc(l.ALWAYS,0,4294967295),l.stencilOp(l.KEEP,l.KEEP,l.KEEP),l.clearStencil(0),l.cullFace(l.BACK),l.frontFace(l.CCW),l.polygonOffset(0,0),l.activeTexture(l.TEXTURE0),l.bindFramebuffer(l.FRAMEBUFFER,null),!0===r&&(l.bindFramebuffer(l.DRAW_FRAMEBUFFER,null),l.bindFramebuffer(l.READ_FRAMEBUFFER,null)),l.useProgram(null),l.lineWidth(1),l.scissor(0,0,l.canvas.width,l.canvas.height),l.viewport(0,0,l.canvas.width,l.canvas.height),x={},Ye=null,et={},w={},D=new WeakMap,N=[],I=null,A=!1,k=null,O=null,B=null,W=null,Y=null,q=null,ee=null,z=!1,Z=null,fe=null,He=null,he=null,pe=null,tt.set(0,0,l.canvas.width,l.canvas.height),mt.set(0,0,l.canvas.width,l.canvas.height),f.reset(),p.reset(),m.reset()}}}function u0(l,e,t,r,o,a,u){const f=o.isWebGL2,p=o.maxTextures,m=o.maxCubemapSize,v=o.maxTextureSize,y=o.maxSamples,x=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,w=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),D=new WeakMap;let N;const I=new WeakMap;let A=!1;try{A=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function k(te,j){return A?new OffscreenCanvas(te,j):_r("canvas")}function O(te,j,Se,dt){let rt=1;if((te.width>dt||te.height>dt)&&(rt=dt/Math.max(te.width,te.height)),rt<1||!0===j){if(typeof HTMLImageElement<"u"&&te instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&te instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&te instanceof ImageBitmap){const pt=j?La:Math.floor,Qt=pt(rt*te.width),gt=pt(rt*te.height);void 0===N&&(N=k(Qt,gt));const Te=Se?k(Qt,gt):N;return Te.width=Qt,Te.height=gt,Te.getContext("2d").drawImage(te,0,0,Qt,gt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+te.width+"x"+te.height+") to ("+Qt+"x"+gt+")."),Te}return"data"in te&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+te.width+"x"+te.height+")."),te}return te}function B(te){return Pu(te.width)&&Pu(te.height)}function Y(te,j){return te.generateMipmaps&&j&&te.minFilter!==Zn&&te.minFilter!==Mi}function q(te){l.generateMipmap(te)}function ee(te,j,Se,dt,rt=!1){if(!1===f)return j;if(null!==te){if(void 0!==l[te])return l[te];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+te+"'")}let pt=j;return j===l.RED&&(Se===l.FLOAT&&(pt=l.R32F),Se===l.HALF_FLOAT&&(pt=l.R16F),Se===l.UNSIGNED_BYTE&&(pt=l.R8)),j===l.RED_INTEGER&&(Se===l.UNSIGNED_BYTE&&(pt=l.R8UI),Se===l.UNSIGNED_SHORT&&(pt=l.R16UI),Se===l.UNSIGNED_INT&&(pt=l.R32UI),Se===l.BYTE&&(pt=l.R8I),Se===l.SHORT&&(pt=l.R16I),Se===l.INT&&(pt=l.R32I)),j===l.RG&&(Se===l.FLOAT&&(pt=l.RG32F),Se===l.HALF_FLOAT&&(pt=l.RG16F),Se===l.UNSIGNED_BYTE&&(pt=l.RG8)),j===l.RGBA&&(Se===l.FLOAT&&(pt=l.RGBA32F),Se===l.HALF_FLOAT&&(pt=l.RGBA16F),Se===l.UNSIGNED_BYTE&&(pt=dt===_n&&!1===rt?l.SRGB8_ALPHA8:l.RGBA8),Se===l.UNSIGNED_SHORT_4_4_4_4&&(pt=l.RGBA4),Se===l.UNSIGNED_SHORT_5_5_5_1&&(pt=l.RGB5_A1)),(pt===l.R16F||pt===l.R32F||pt===l.RG16F||pt===l.RG32F||pt===l.RGBA16F||pt===l.RGBA32F)&&e.get("EXT_color_buffer_float"),pt}function z(te,j,Se){return!0===Y(te,Se)||te.isFramebufferTexture&&te.minFilter!==Zn&&te.minFilter!==Mi?Math.log2(Math.max(j.width,j.height))+1:void 0!==te.mipmaps&&te.mipmaps.length>0?te.mipmaps.length:te.isCompressedTexture&&Array.isArray(te.image)?j.mipmaps.length:1}function Z(te){return te===Zn||1004===te||1005===te?l.NEAREST:l.LINEAR}function fe(te){const j=te.target;j.removeEventListener("dispose",fe),function he(te){const j=r.get(te);if(void 0===j.__webglInit)return;const Se=te.source,dt=I.get(Se);if(dt){const rt=dt[j.__cacheKey];rt.usedTimes--,0===rt.usedTimes&&pe(te),0===Object.keys(dt).length&&I.delete(Se)}r.remove(te)}(j),j.isVideoTexture&&D.delete(j)}function He(te){const j=te.target;j.removeEventListener("dispose",He),function ve(te){const j=te.texture,Se=r.get(te),dt=r.get(j);if(void 0!==dt.__webglTexture&&(l.deleteTexture(dt.__webglTexture),u.memory.textures--),te.depthTexture&&te.depthTexture.dispose(),te.isWebGLCubeRenderTarget)for(let rt=0;rt<6;rt++){if(Array.isArray(Se.__webglFramebuffer[rt]))for(let pt=0;pt<Se.__webglFramebuffer[rt].length;pt++)l.deleteFramebuffer(Se.__webglFramebuffer[rt][pt]);else l.deleteFramebuffer(Se.__webglFramebuffer[rt]);Se.__webglDepthbuffer&&l.deleteRenderbuffer(Se.__webglDepthbuffer[rt])}else{if(Array.isArray(Se.__webglFramebuffer))for(let rt=0;rt<Se.__webglFramebuffer.length;rt++)l.deleteFramebuffer(Se.__webglFramebuffer[rt]);else l.deleteFramebuffer(Se.__webglFramebuffer);if(Se.__webglDepthbuffer&&l.deleteRenderbuffer(Se.__webglDepthbuffer),Se.__webglMultisampledFramebuffer&&l.deleteFramebuffer(Se.__webglMultisampledFramebuffer),Se.__webglColorRenderbuffer)for(let rt=0;rt<Se.__webglColorRenderbuffer.length;rt++)Se.__webglColorRenderbuffer[rt]&&l.deleteRenderbuffer(Se.__webglColorRenderbuffer[rt]);Se.__webglDepthRenderbuffer&&l.deleteRenderbuffer(Se.__webglDepthRenderbuffer)}if(te.isWebGLMultipleRenderTargets)for(let rt=0,pt=j.length;rt<pt;rt++){const Qt=r.get(j[rt]);Qt.__webglTexture&&(l.deleteTexture(Qt.__webglTexture),u.memory.textures--),r.remove(j[rt])}r.remove(j),r.remove(te)}(j)}function pe(te){const j=r.get(te);l.deleteTexture(j.__webglTexture),delete I.get(te.source)[j.__cacheKey],u.memory.textures--}let Xe=0;function et(te,j){const Se=r.get(te);if(te.isVideoTexture&&function ei(te){const j=u.render.frame;D.get(te)!==j&&(D.set(te,j),te.update())}(te),!1===te.isRenderTargetTexture&&te.version>0&&Se.__version!==te.version){const dt=te.image;if(null===dt)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==dt.complete)return void ln(Se,te,j);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(l.TEXTURE_2D,Se.__webglTexture,l.TEXTURE0+j)}const mt={[er]:l.REPEAT,[Mt]:l.CLAMP_TO_EDGE,1002:l.MIRRORED_REPEAT},Pt={[Zn]:l.NEAREST,1004:l.NEAREST_MIPMAP_NEAREST,1005:l.NEAREST_MIPMAP_LINEAR,[Mi]:l.LINEAR,1007:l.LINEAR_MIPMAP_NEAREST,[Or]:l.LINEAR_MIPMAP_LINEAR},Bt={512:l.NEVER,519:l.ALWAYS,513:l.LESS,515:l.LEQUAL,514:l.EQUAL,518:l.GEQUAL,516:l.GREATER,517:l.NOTEQUAL};function Wt(te,j,Se){if(Se?(l.texParameteri(te,l.TEXTURE_WRAP_S,mt[j.wrapS]),l.texParameteri(te,l.TEXTURE_WRAP_T,mt[j.wrapT]),(te===l.TEXTURE_3D||te===l.TEXTURE_2D_ARRAY)&&l.texParameteri(te,l.TEXTURE_WRAP_R,mt[j.wrapR]),l.texParameteri(te,l.TEXTURE_MAG_FILTER,Pt[j.magFilter]),l.texParameteri(te,l.TEXTURE_MIN_FILTER,Pt[j.minFilter])):(l.texParameteri(te,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(te,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),(te===l.TEXTURE_3D||te===l.TEXTURE_2D_ARRAY)&&l.texParameteri(te,l.TEXTURE_WRAP_R,l.CLAMP_TO_EDGE),(j.wrapS!==Mt||j.wrapT!==Mt)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),l.texParameteri(te,l.TEXTURE_MAG_FILTER,Z(j.magFilter)),l.texParameteri(te,l.TEXTURE_MIN_FILTER,Z(j.minFilter)),j.minFilter!==Zn&&j.minFilter!==Mi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),j.compareFunction&&(l.texParameteri(te,l.TEXTURE_COMPARE_MODE,l.COMPARE_REF_TO_TEXTURE),l.texParameteri(te,l.TEXTURE_COMPARE_FUNC,Bt[j.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const dt=e.get("EXT_texture_filter_anisotropic");if(j.magFilter===Zn||1005!==j.minFilter&&j.minFilter!==Or||j.type===_e&&!1===e.has("OES_texture_float_linear")||!1===f&&j.type===it&&!1===e.has("OES_texture_half_float_linear"))return;(j.anisotropy>1||r.get(j).__currentAnisotropy)&&(l.texParameterf(te,dt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(j.anisotropy,o.getMaxAnisotropy())),r.get(j).__currentAnisotropy=j.anisotropy)}}function dn(te,j){let Se=!1;void 0===te.__webglInit&&(te.__webglInit=!0,j.addEventListener("dispose",fe));const dt=j.source;let rt=I.get(dt);void 0===rt&&(rt={},I.set(dt,rt));const pt=function Ye(te){const j=[];return j.push(te.wrapS),j.push(te.wrapT),j.push(te.wrapR||0),j.push(te.magFilter),j.push(te.minFilter),j.push(te.anisotropy),j.push(te.internalFormat),j.push(te.format),j.push(te.type),j.push(te.generateMipmaps),j.push(te.premultiplyAlpha),j.push(te.flipY),j.push(te.unpackAlignment),j.push(te.colorSpace),j.join()}(j);if(pt!==te.__cacheKey){void 0===rt[pt]&&(rt[pt]={texture:l.createTexture(),usedTimes:0},u.memory.textures++,Se=!0),rt[pt].usedTimes++;const Qt=rt[te.__cacheKey];void 0!==Qt&&(rt[te.__cacheKey].usedTimes--,0===Qt.usedTimes&&pe(j)),te.__cacheKey=pt,te.__webglTexture=rt[pt].texture}return Se}function ln(te,j,Se){let dt=l.TEXTURE_2D;(j.isDataArrayTexture||j.isCompressedArrayTexture)&&(dt=l.TEXTURE_2D_ARRAY),j.isData3DTexture&&(dt=l.TEXTURE_3D);const rt=dn(te,j),pt=j.source;t.bindTexture(dt,te.__webglTexture,l.TEXTURE0+Se);const Qt=r.get(pt);if(pt.version!==Qt.__version||!0===rt){t.activeTexture(l.TEXTURE0+Se),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,j.flipY),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,j.premultiplyAlpha),l.pixelStorei(l.UNPACK_ALIGNMENT,j.unpackAlignment),l.pixelStorei(l.UNPACK_COLORSPACE_CONVERSION_WEBGL,l.NONE);const gt=function W(te){return!f&&(te.wrapS!==Mt||te.wrapT!==Mt||te.minFilter!==Zn&&te.minFilter!==Mi)}(j)&&!1===B(j.image);let Te=O(j.image,gt,!1,v);Te=zi(j,Te);const ie=B(Te)||f,Ke=a.convert(j.format,j.colorSpace);let Ct,Ft=a.convert(j.type),St=ee(j.internalFormat,Ke,Ft,j.colorSpace,j.isVideoTexture);Wt(dt,j,ie);const An=j.mipmaps,ti=f&&!0!==j.isVideoTexture,ce=void 0===Qt.__version||!0===rt,Lt=z(j,Te,ie);if(j.isDepthTexture)St=l.DEPTH_COMPONENT,f?St=j.type===_e?l.DEPTH_COMPONENT32F:j.type===ae?l.DEPTH_COMPONENT24:j.type===Mn?l.DEPTH24_STENCIL8:l.DEPTH_COMPONENT16:j.type===_e&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),j.format===yr&&St===l.DEPTH_COMPONENT&&1012!==j.type&&j.type!==ae&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),j.type=ae,Ft=a.convert(j.type)),j.format===yo&&St===l.DEPTH_COMPONENT&&(St=l.DEPTH_STENCIL,j.type!==Mn&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),j.type=Mn,Ft=a.convert(j.type))),ce&&(ti?t.texStorage2D(l.TEXTURE_2D,1,St,Te.width,Te.height):t.texImage2D(l.TEXTURE_2D,0,St,Te.width,Te.height,0,Ke,Ft,null));else if(j.isDataTexture)if(An.length>0&&ie){ti&&ce&&t.texStorage2D(l.TEXTURE_2D,Lt,St,An[0].width,An[0].height);for(let we=0,ct=An.length;we<ct;we++)Ct=An[we],ti?t.texSubImage2D(l.TEXTURE_2D,we,0,0,Ct.width,Ct.height,Ke,Ft,Ct.data):t.texImage2D(l.TEXTURE_2D,we,St,Ct.width,Ct.height,0,Ke,Ft,Ct.data);j.generateMipmaps=!1}else ti?(ce&&t.texStorage2D(l.TEXTURE_2D,Lt,St,Te.width,Te.height),t.texSubImage2D(l.TEXTURE_2D,0,0,0,Te.width,Te.height,Ke,Ft,Te.data)):t.texImage2D(l.TEXTURE_2D,0,St,Te.width,Te.height,0,Ke,Ft,Te.data);else if(j.isCompressedTexture)if(j.isCompressedArrayTexture){ti&&ce&&t.texStorage3D(l.TEXTURE_2D_ARRAY,Lt,St,An[0].width,An[0].height,Te.depth);for(let we=0,ct=An.length;we<ct;we++)Ct=An[we],j.format!==ui?null!==Ke?ti?t.compressedTexSubImage3D(l.TEXTURE_2D_ARRAY,we,0,0,0,Ct.width,Ct.height,Te.depth,Ke,Ct.data,0,0):t.compressedTexImage3D(l.TEXTURE_2D_ARRAY,we,St,Ct.width,Ct.height,Te.depth,0,Ct.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ti?t.texSubImage3D(l.TEXTURE_2D_ARRAY,we,0,0,0,Ct.width,Ct.height,Te.depth,Ke,Ft,Ct.data):t.texImage3D(l.TEXTURE_2D_ARRAY,we,St,Ct.width,Ct.height,Te.depth,0,Ke,Ft,Ct.data)}else{ti&&ce&&t.texStorage2D(l.TEXTURE_2D,Lt,St,An[0].width,An[0].height);for(let we=0,ct=An.length;we<ct;we++)Ct=An[we],j.format!==ui?null!==Ke?ti?t.compressedTexSubImage2D(l.TEXTURE_2D,we,0,0,Ct.width,Ct.height,Ke,Ct.data):t.compressedTexImage2D(l.TEXTURE_2D,we,St,Ct.width,Ct.height,0,Ct.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ti?t.texSubImage2D(l.TEXTURE_2D,we,0,0,Ct.width,Ct.height,Ke,Ft,Ct.data):t.texImage2D(l.TEXTURE_2D,we,St,Ct.width,Ct.height,0,Ke,Ft,Ct.data)}else if(j.isDataArrayTexture)ti?(ce&&t.texStorage3D(l.TEXTURE_2D_ARRAY,Lt,St,Te.width,Te.height,Te.depth),t.texSubImage3D(l.TEXTURE_2D_ARRAY,0,0,0,0,Te.width,Te.height,Te.depth,Ke,Ft,Te.data)):t.texImage3D(l.TEXTURE_2D_ARRAY,0,St,Te.width,Te.height,Te.depth,0,Ke,Ft,Te.data);else if(j.isData3DTexture)ti?(ce&&t.texStorage3D(l.TEXTURE_3D,Lt,St,Te.width,Te.height,Te.depth),t.texSubImage3D(l.TEXTURE_3D,0,0,0,0,Te.width,Te.height,Te.depth,Ke,Ft,Te.data)):t.texImage3D(l.TEXTURE_3D,0,St,Te.width,Te.height,Te.depth,0,Ke,Ft,Te.data);else if(j.isFramebufferTexture){if(ce)if(ti)t.texStorage2D(l.TEXTURE_2D,Lt,St,Te.width,Te.height);else{let we=Te.width,ct=Te.height;for(let xt=0;xt<Lt;xt++)t.texImage2D(l.TEXTURE_2D,xt,St,we,ct,0,Ke,Ft,null),we>>=1,ct>>=1}}else if(An.length>0&&ie){ti&&ce&&t.texStorage2D(l.TEXTURE_2D,Lt,St,An[0].width,An[0].height);for(let we=0,ct=An.length;we<ct;we++)Ct=An[we],ti?t.texSubImage2D(l.TEXTURE_2D,we,0,0,Ke,Ft,Ct):t.texImage2D(l.TEXTURE_2D,we,St,Ke,Ft,Ct);j.generateMipmaps=!1}else ti?(ce&&t.texStorage2D(l.TEXTURE_2D,Lt,St,Te.width,Te.height),t.texSubImage2D(l.TEXTURE_2D,0,0,0,Ke,Ft,Te)):t.texImage2D(l.TEXTURE_2D,0,St,Ke,Ft,Te);Y(j,ie)&&q(dt),Qt.__version=pt.version,j.onUpdate&&j.onUpdate(j)}te.__version=j.version}function fn(te,j,Se,dt,rt,pt){const Qt=a.convert(Se.format,Se.colorSpace),gt=a.convert(Se.type),Te=ee(Se.internalFormat,Qt,gt,Se.colorSpace);if(!r.get(j).__hasExternalTextures){const Ke=Math.max(1,j.width>>pt),Ft=Math.max(1,j.height>>pt);rt===l.TEXTURE_3D||rt===l.TEXTURE_2D_ARRAY?t.texImage3D(rt,pt,Te,Ke,Ft,j.depth,0,Qt,gt,null):t.texImage2D(rt,pt,Te,Ke,Ft,0,Qt,gt,null)}t.bindFramebuffer(l.FRAMEBUFFER,te),Yt(j)?x.framebufferTexture2DMultisampleEXT(l.FRAMEBUFFER,dt,rt,r.get(Se).__webglTexture,0,Gt(j)):(rt===l.TEXTURE_2D||rt>=l.TEXTURE_CUBE_MAP_POSITIVE_X&&rt<=l.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&l.framebufferTexture2D(l.FRAMEBUFFER,dt,rt,r.get(Se).__webglTexture,pt),t.bindFramebuffer(l.FRAMEBUFFER,null)}function ne(te,j,Se){if(l.bindRenderbuffer(l.RENDERBUFFER,te),j.depthBuffer&&!j.stencilBuffer){let dt=l.DEPTH_COMPONENT16;if(Se||Yt(j)){const rt=j.depthTexture;rt&&rt.isDepthTexture&&(rt.type===_e?dt=l.DEPTH_COMPONENT32F:rt.type===ae&&(dt=l.DEPTH_COMPONENT24));const pt=Gt(j);Yt(j)?x.renderbufferStorageMultisampleEXT(l.RENDERBUFFER,pt,dt,j.width,j.height):l.renderbufferStorageMultisample(l.RENDERBUFFER,pt,dt,j.width,j.height)}else l.renderbufferStorage(l.RENDERBUFFER,dt,j.width,j.height);l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,te)}else if(j.depthBuffer&&j.stencilBuffer){const dt=Gt(j);Se&&!1===Yt(j)?l.renderbufferStorageMultisample(l.RENDERBUFFER,dt,l.DEPTH24_STENCIL8,j.width,j.height):Yt(j)?x.renderbufferStorageMultisampleEXT(l.RENDERBUFFER,dt,l.DEPTH24_STENCIL8,j.width,j.height):l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_STENCIL,j.width,j.height),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.RENDERBUFFER,te)}else{const dt=!0===j.isWebGLMultipleRenderTargets?j.texture:[j.texture];for(let rt=0;rt<dt.length;rt++){const pt=dt[rt],Qt=a.convert(pt.format,pt.colorSpace),gt=a.convert(pt.type),Te=ee(pt.internalFormat,Qt,gt,pt.colorSpace),ie=Gt(j);Se&&!1===Yt(j)?l.renderbufferStorageMultisample(l.RENDERBUFFER,ie,Te,j.width,j.height):Yt(j)?x.renderbufferStorageMultisampleEXT(l.RENDERBUFFER,ie,Te,j.width,j.height):l.renderbufferStorage(l.RENDERBUFFER,Te,j.width,j.height)}}l.bindRenderbuffer(l.RENDERBUFFER,null)}function Ge(te){const j=r.get(te),Se=!0===te.isWebGLCubeRenderTarget;if(te.depthTexture&&!j.__autoAllocateDepthBuffer){if(Se)throw new Error("target.depthTexture not supported in Cube render targets");!function vt(te,j){if(j&&j.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(l.FRAMEBUFFER,te),!j.depthTexture||!j.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(j.depthTexture).__webglTexture||j.depthTexture.image.width!==j.width||j.depthTexture.image.height!==j.height)&&(j.depthTexture.image.width=j.width,j.depthTexture.image.height=j.height,j.depthTexture.needsUpdate=!0),et(j.depthTexture,0);const dt=r.get(j.depthTexture).__webglTexture,rt=Gt(j);if(j.depthTexture.format===yr)Yt(j)?x.framebufferTexture2DMultisampleEXT(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.TEXTURE_2D,dt,0,rt):l.framebufferTexture2D(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.TEXTURE_2D,dt,0);else{if(j.depthTexture.format!==yo)throw new Error("Unknown depthTexture format");Yt(j)?x.framebufferTexture2DMultisampleEXT(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.TEXTURE_2D,dt,0,rt):l.framebufferTexture2D(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.TEXTURE_2D,dt,0)}}(j.__webglFramebuffer,te)}else if(Se){j.__webglDepthbuffer=[];for(let dt=0;dt<6;dt++)t.bindFramebuffer(l.FRAMEBUFFER,j.__webglFramebuffer[dt]),j.__webglDepthbuffer[dt]=l.createRenderbuffer(),ne(j.__webglDepthbuffer[dt],te,!1)}else t.bindFramebuffer(l.FRAMEBUFFER,j.__webglFramebuffer),j.__webglDepthbuffer=l.createRenderbuffer(),ne(j.__webglDepthbuffer,te,!1);t.bindFramebuffer(l.FRAMEBUFFER,null)}function Gt(te){return Math.min(y,te.samples)}function Yt(te){const j=r.get(te);return f&&te.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==j.__useRenderToTexture}function zi(te,j){const Se=te.colorSpace,dt=te.format,rt=te.type;return!0===te.isCompressedTexture||!0===te.isVideoTexture||1035===te.format||Se!==Oi&&""!==Se&&(Se===_n||Se===Ta?!1===f?!0===e.has("EXT_sRGB")&&dt===ui?(te.format=1035,te.minFilter=Mi,te.generateMipmaps=!1):j=Ks.sRGBToLinear(j):(dt!==ui||rt!==lr)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Se)),j}this.allocateTextureUnit=function ze(){const te=Xe;return te>=p&&console.warn("THREE.WebGLTextures: Trying to use "+te+" texture units while this GPU supports only "+p),Xe+=1,te},this.resetTextureUnits=function Ue(){Xe=0},this.setTexture2D=et,this.setTexture2DArray=function Rt(te,j){const Se=r.get(te);te.version>0&&Se.__version!==te.version?ln(Se,te,j):t.bindTexture(l.TEXTURE_2D_ARRAY,Se.__webglTexture,l.TEXTURE0+j)},this.setTexture3D=function ge(te,j){const Se=r.get(te);te.version>0&&Se.__version!==te.version?ln(Se,te,j):t.bindTexture(l.TEXTURE_3D,Se.__webglTexture,l.TEXTURE0+j)},this.setTextureCube=function tt(te,j){const Se=r.get(te);te.version>0&&Se.__version!==te.version?function Wn(te,j,Se){if(6!==j.image.length)return;const dt=dn(te,j),rt=j.source;t.bindTexture(l.TEXTURE_CUBE_MAP,te.__webglTexture,l.TEXTURE0+Se);const pt=r.get(rt);if(rt.version!==pt.__version||!0===dt){t.activeTexture(l.TEXTURE0+Se),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,j.flipY),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,j.premultiplyAlpha),l.pixelStorei(l.UNPACK_ALIGNMENT,j.unpackAlignment),l.pixelStorei(l.UNPACK_COLORSPACE_CONVERSION_WEBGL,l.NONE);const Qt=j.isCompressedTexture||j.image[0].isCompressedTexture,gt=j.image[0]&&j.image[0].isDataTexture,Te=[];for(let we=0;we<6;we++)Te[we]=Qt||gt?gt?j.image[we].image:j.image[we]:O(j.image[we],!1,!0,m),Te[we]=zi(j,Te[we]);const ie=Te[0],Ke=B(ie)||f,Ft=a.convert(j.format,j.colorSpace),St=a.convert(j.type),Ct=ee(j.internalFormat,Ft,St,j.colorSpace),An=f&&!0!==j.isVideoTexture,ti=void 0===pt.__version||!0===dt;let Lt,ce=z(j,ie,Ke);if(Wt(l.TEXTURE_CUBE_MAP,j,Ke),Qt){An&&ti&&t.texStorage2D(l.TEXTURE_CUBE_MAP,ce,Ct,ie.width,ie.height);for(let we=0;we<6;we++){Lt=Te[we].mipmaps;for(let ct=0;ct<Lt.length;ct++){const xt=Lt[ct];j.format!==ui?null!==Ft?An?t.compressedTexSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+we,ct,0,0,xt.width,xt.height,Ft,xt.data):t.compressedTexImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+we,ct,Ct,xt.width,xt.height,0,xt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):An?t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+we,ct,0,0,xt.width,xt.height,Ft,St,xt.data):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+we,ct,Ct,xt.width,xt.height,0,Ft,St,xt.data)}}}else{Lt=j.mipmaps,An&&ti&&(Lt.length>0&&ce++,t.texStorage2D(l.TEXTURE_CUBE_MAP,ce,Ct,Te[0].width,Te[0].height));for(let we=0;we<6;we++)if(gt){An?t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+we,0,0,0,Te[we].width,Te[we].height,Ft,St,Te[we].data):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+we,0,Ct,Te[we].width,Te[we].height,0,Ft,St,Te[we].data);for(let ct=0;ct<Lt.length;ct++){const Kn=Lt[ct].image[we].image;An?t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+we,ct+1,0,0,Kn.width,Kn.height,Ft,St,Kn.data):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+we,ct+1,Ct,Kn.width,Kn.height,0,Ft,St,Kn.data)}}else{An?t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+we,0,0,0,Ft,St,Te[we]):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+we,0,Ct,Ft,St,Te[we]);for(let ct=0;ct<Lt.length;ct++){const xt=Lt[ct];An?t.texSubImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+we,ct+1,0,0,Ft,St,xt.image[we]):t.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+we,ct+1,Ct,Ft,St,xt.image[we])}}}Y(j,Ke)&&q(l.TEXTURE_CUBE_MAP),pt.__version=rt.version,j.onUpdate&&j.onUpdate(j)}te.__version=j.version}(Se,te,j):t.bindTexture(l.TEXTURE_CUBE_MAP,Se.__webglTexture,l.TEXTURE0+j)},this.rebindTextures=function yt(te,j,Se){const dt=r.get(te);void 0!==j&&fn(dt.__webglFramebuffer,te,te.texture,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,0),void 0!==Se&&Ge(te)},this.setupRenderTarget=function Ze(te){const j=te.texture,Se=r.get(te),dt=r.get(j);te.addEventListener("dispose",He),!0!==te.isWebGLMultipleRenderTargets&&(void 0===dt.__webglTexture&&(dt.__webglTexture=l.createTexture()),dt.__version=j.version,u.memory.textures++);const rt=!0===te.isWebGLCubeRenderTarget,pt=!0===te.isWebGLMultipleRenderTargets,Qt=B(te)||f;if(rt){Se.__webglFramebuffer=[];for(let gt=0;gt<6;gt++)if(f&&j.mipmaps&&j.mipmaps.length>0){Se.__webglFramebuffer[gt]=[];for(let Te=0;Te<j.mipmaps.length;Te++)Se.__webglFramebuffer[gt][Te]=l.createFramebuffer()}else Se.__webglFramebuffer[gt]=l.createFramebuffer()}else{if(f&&j.mipmaps&&j.mipmaps.length>0){Se.__webglFramebuffer=[];for(let gt=0;gt<j.mipmaps.length;gt++)Se.__webglFramebuffer[gt]=l.createFramebuffer()}else Se.__webglFramebuffer=l.createFramebuffer();if(pt)if(o.drawBuffers){const gt=te.texture;for(let Te=0,ie=gt.length;Te<ie;Te++){const Ke=r.get(gt[Te]);void 0===Ke.__webglTexture&&(Ke.__webglTexture=l.createTexture(),u.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(f&&te.samples>0&&!1===Yt(te)){const gt=pt?j:[j];Se.__webglMultisampledFramebuffer=l.createFramebuffer(),Se.__webglColorRenderbuffer=[],t.bindFramebuffer(l.FRAMEBUFFER,Se.__webglMultisampledFramebuffer);for(let Te=0;Te<gt.length;Te++){const ie=gt[Te];Se.__webglColorRenderbuffer[Te]=l.createRenderbuffer(),l.bindRenderbuffer(l.RENDERBUFFER,Se.__webglColorRenderbuffer[Te]);const Ke=a.convert(ie.format,ie.colorSpace),Ft=a.convert(ie.type),St=ee(ie.internalFormat,Ke,Ft,ie.colorSpace,!0===te.isXRRenderTarget),Ct=Gt(te);l.renderbufferStorageMultisample(l.RENDERBUFFER,Ct,St,te.width,te.height),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+Te,l.RENDERBUFFER,Se.__webglColorRenderbuffer[Te])}l.bindRenderbuffer(l.RENDERBUFFER,null),te.depthBuffer&&(Se.__webglDepthRenderbuffer=l.createRenderbuffer(),ne(Se.__webglDepthRenderbuffer,te,!0)),t.bindFramebuffer(l.FRAMEBUFFER,null)}}if(rt){t.bindTexture(l.TEXTURE_CUBE_MAP,dt.__webglTexture),Wt(l.TEXTURE_CUBE_MAP,j,Qt);for(let gt=0;gt<6;gt++)if(f&&j.mipmaps&&j.mipmaps.length>0)for(let Te=0;Te<j.mipmaps.length;Te++)fn(Se.__webglFramebuffer[gt][Te],te,j,l.COLOR_ATTACHMENT0,l.TEXTURE_CUBE_MAP_POSITIVE_X+gt,Te);else fn(Se.__webglFramebuffer[gt],te,j,l.COLOR_ATTACHMENT0,l.TEXTURE_CUBE_MAP_POSITIVE_X+gt,0);Y(j,Qt)&&q(l.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(pt){const gt=te.texture;for(let Te=0,ie=gt.length;Te<ie;Te++){const Ke=gt[Te],Ft=r.get(Ke);t.bindTexture(l.TEXTURE_2D,Ft.__webglTexture),Wt(l.TEXTURE_2D,Ke,Qt),fn(Se.__webglFramebuffer,te,Ke,l.COLOR_ATTACHMENT0+Te,l.TEXTURE_2D,0),Y(Ke,Qt)&&q(l.TEXTURE_2D)}t.unbindTexture()}else{let gt=l.TEXTURE_2D;if((te.isWebGL3DRenderTarget||te.isWebGLArrayRenderTarget)&&(f?gt=te.isWebGL3DRenderTarget?l.TEXTURE_3D:l.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(gt,dt.__webglTexture),Wt(gt,j,Qt),f&&j.mipmaps&&j.mipmaps.length>0)for(let Te=0;Te<j.mipmaps.length;Te++)fn(Se.__webglFramebuffer[Te],te,j,l.COLOR_ATTACHMENT0,gt,Te);else fn(Se.__webglFramebuffer,te,j,l.COLOR_ATTACHMENT0,gt,0);Y(j,Qt)&&q(gt),t.unbindTexture()}te.depthBuffer&&Ge(te)},this.updateRenderTargetMipmap=function rn(te){const j=B(te)||f,Se=!0===te.isWebGLMultipleRenderTargets?te.texture:[te.texture];for(let dt=0,rt=Se.length;dt<rt;dt++){const pt=Se[dt];if(Y(pt,j)){const Qt=te.isWebGLCubeRenderTarget?l.TEXTURE_CUBE_MAP:l.TEXTURE_2D,gt=r.get(pt).__webglTexture;t.bindTexture(Qt,gt),q(Qt),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Vt(te){if(f&&te.samples>0&&!1===Yt(te)){const j=te.isWebGLMultipleRenderTargets?te.texture:[te.texture],Se=te.width,dt=te.height;let rt=l.COLOR_BUFFER_BIT;const pt=[],Qt=te.stencilBuffer?l.DEPTH_STENCIL_ATTACHMENT:l.DEPTH_ATTACHMENT,gt=r.get(te),Te=!0===te.isWebGLMultipleRenderTargets;if(Te)for(let ie=0;ie<j.length;ie++)t.bindFramebuffer(l.FRAMEBUFFER,gt.__webglMultisampledFramebuffer),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+ie,l.RENDERBUFFER,null),t.bindFramebuffer(l.FRAMEBUFFER,gt.__webglFramebuffer),l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0+ie,l.TEXTURE_2D,null,0);t.bindFramebuffer(l.READ_FRAMEBUFFER,gt.__webglMultisampledFramebuffer),t.bindFramebuffer(l.DRAW_FRAMEBUFFER,gt.__webglFramebuffer);for(let ie=0;ie<j.length;ie++){pt.push(l.COLOR_ATTACHMENT0+ie),te.depthBuffer&&pt.push(Qt);const Ke=void 0!==gt.__ignoreDepthValues&&gt.__ignoreDepthValues;if(!1===Ke&&(te.depthBuffer&&(rt|=l.DEPTH_BUFFER_BIT),te.stencilBuffer&&(rt|=l.STENCIL_BUFFER_BIT)),Te&&l.framebufferRenderbuffer(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.RENDERBUFFER,gt.__webglColorRenderbuffer[ie]),!0===Ke&&(l.invalidateFramebuffer(l.READ_FRAMEBUFFER,[Qt]),l.invalidateFramebuffer(l.DRAW_FRAMEBUFFER,[Qt])),Te){const Ft=r.get(j[ie]).__webglTexture;l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,Ft,0)}l.blitFramebuffer(0,0,Se,dt,0,0,Se,dt,rt,l.NEAREST),w&&l.invalidateFramebuffer(l.READ_FRAMEBUFFER,pt)}if(t.bindFramebuffer(l.READ_FRAMEBUFFER,null),t.bindFramebuffer(l.DRAW_FRAMEBUFFER,null),Te)for(let ie=0;ie<j.length;ie++){t.bindFramebuffer(l.FRAMEBUFFER,gt.__webglMultisampledFramebuffer),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+ie,l.RENDERBUFFER,gt.__webglColorRenderbuffer[ie]);const Ke=r.get(j[ie]).__webglTexture;t.bindFramebuffer(l.FRAMEBUFFER,gt.__webglFramebuffer),l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0+ie,l.TEXTURE_2D,Ke,0)}t.bindFramebuffer(l.DRAW_FRAMEBUFFER,gt.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=Ge,this.setupFrameBufferTexture=fn,this.useMultisampledRTT=Yt}function d0(l,e,t){const r=t.isWebGL2;return{convert:function o(a,u=""){let f;const p=u===_n||u===Ta?1:0;if(a===lr)return l.UNSIGNED_BYTE;if(1017===a)return l.UNSIGNED_SHORT_4_4_4_4;if(1018===a)return l.UNSIGNED_SHORT_5_5_5_1;if(1010===a)return l.BYTE;if(1011===a)return l.SHORT;if(1012===a)return l.UNSIGNED_SHORT;if(1013===a)return l.INT;if(a===ae)return l.UNSIGNED_INT;if(a===_e)return l.FLOAT;if(a===it)return r?l.HALF_FLOAT:(f=e.get("OES_texture_half_float"),null!==f?f.HALF_FLOAT_OES:null);if(1021===a)return l.ALPHA;if(a===ui)return l.RGBA;if(1024===a)return l.LUMINANCE;if(1025===a)return l.LUMINANCE_ALPHA;if(a===yr)return l.DEPTH_COMPONENT;if(a===yo)return l.DEPTH_STENCIL;if(1035===a)return f=e.get("EXT_sRGB"),null!==f?f.SRGB_ALPHA_EXT:null;if(1028===a)return l.RED;if(1029===a)return l.RED_INTEGER;if(1030===a)return l.RG;if(1031===a)return l.RG_INTEGER;if(1033===a)return l.RGBA_INTEGER;if(33776===a||33777===a||33778===a||33779===a)if(1===p){if(f=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===f)return null;if(33776===a)return f.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===a)return f.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===a)return f.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===a)return f.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(f=e.get("WEBGL_compressed_texture_s3tc"),null===f)return null;if(33776===a)return f.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===a)return f.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===a)return f.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===a)return f.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===a||35841===a||35842===a||35843===a){if(f=e.get("WEBGL_compressed_texture_pvrtc"),null===f)return null;if(35840===a)return f.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===a)return f.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===a)return f.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===a)return f.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===a)return f=e.get("WEBGL_compressed_texture_etc1"),null!==f?f.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===a||37496===a){if(f=e.get("WEBGL_compressed_texture_etc"),null===f)return null;if(37492===a)return 1===p?f.COMPRESSED_SRGB8_ETC2:f.COMPRESSED_RGB8_ETC2;if(37496===a)return 1===p?f.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:f.COMPRESSED_RGBA8_ETC2_EAC}if(37808===a||37809===a||37810===a||37811===a||37812===a||37813===a||37814===a||37815===a||37816===a||37817===a||37818===a||37819===a||37820===a||37821===a){if(f=e.get("WEBGL_compressed_texture_astc"),null===f)return null;if(37808===a)return 1===p?f.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:f.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===a)return 1===p?f.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:f.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===a)return 1===p?f.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:f.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===a)return 1===p?f.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:f.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===a)return 1===p?f.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:f.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===a)return 1===p?f.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:f.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===a)return 1===p?f.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:f.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===a)return 1===p?f.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:f.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===a)return 1===p?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:f.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===a)return 1===p?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:f.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===a)return 1===p?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:f.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===a)return 1===p?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:f.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===a)return 1===p?f.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:f.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===a)return 1===p?f.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:f.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===a||36494===a||36495===a){if(f=e.get("EXT_texture_compression_bptc"),null===f)return null;if(36492===a)return 1===p?f.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:f.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===a)return f.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===a)return f.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===a||36284===a||36285===a||36286===a){if(f=e.get("EXT_texture_compression_rgtc"),null===f)return null;if(36492===a)return f.COMPRESSED_RED_RGTC1_EXT;if(36284===a)return f.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===a)return f.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===a)return f.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return a===Mn?r?l.UNSIGNED_INT_24_8:(f=e.get("WEBGL_depth_texture"),null!==f?f.UNSIGNED_INT_24_8_WEBGL:null):void 0!==l[a]?l[a]:null}}}class Xg extends xr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class da extends sn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const nE={type:"move"};class Yg{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new da,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new da,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new $,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new $),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new da,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new $,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new $),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,r){let o=null,a=null,u=null;const f=this._targetRay,p=this._grip,m=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(m&&e.hand){u=!0;for(const N of e.hand.values()){const I=t.getJointPose(N,r),A=this._getHandJoint(m,N);null!==I&&(A.matrix.fromArray(I.transform.matrix),A.matrix.decompose(A.position,A.rotation,A.scale),A.matrixWorldNeedsUpdate=!0,A.jointRadius=I.radius),A.visible=null!==I}const x=m.joints["index-finger-tip"].position.distanceTo(m.joints["thumb-tip"].position),w=.02,D=.005;m.inputState.pinching&&x>w+D?(m.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!m.inputState.pinching&&x<=w-D&&(m.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==p&&e.gripSpace&&(a=t.getPose(e.gripSpace,r),null!==a&&(p.matrix.fromArray(a.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.matrixWorldNeedsUpdate=!0,a.linearVelocity?(p.hasLinearVelocity=!0,p.linearVelocity.copy(a.linearVelocity)):p.hasLinearVelocity=!1,a.angularVelocity?(p.hasAngularVelocity=!0,p.angularVelocity.copy(a.angularVelocity)):p.hasAngularVelocity=!1));null!==f&&(o=t.getPose(e.targetRaySpace,r),null===o&&null!==a&&(o=a),null!==o&&(f.matrix.fromArray(o.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,o.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(o.linearVelocity)):f.hasLinearVelocity=!1,o.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(o.angularVelocity)):f.hasAngularVelocity=!1,this.dispatchEvent(nE)))}return null!==f&&(f.visible=null!==o),null!==p&&(p.visible=null!==a),null!==m&&(m.visible=null!==u),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const r=new da;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}class f0 extends b{constructor(e,t,r,o,a,u,f,p,m,v){if((v=void 0!==v?v:yr)!==yr&&v!==yo)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&v===yr&&(r=ae),void 0===r&&v===yo&&(r=Mn),super(null,o,a,u,f,p,v,r,m),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==f?f:Zn,this.minFilter=void 0!==p?p:Zn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class h0 extends Pi{constructor(e,t){var r;super();const o=this;let a=null,u=1,f=null,p="local-floor",m=1,v=null,y=null,x=null,w=null,D=null,N=null;const I=t.getContextAttributes();let A=null,k=null;const O=[],B=[],W=new xr;W.layers.enable(1),W.viewport=new L;const Y=new xr;Y.layers.enable(2),Y.viewport=new L;const q=[W,Y],ee=new Xg;ee.layers.enable(1),ee.layers.enable(2);let z=null,Z=null;function fe(ge){const tt=B.indexOf(ge.inputSource);if(-1===tt)return;const mt=O[tt];void 0!==mt&&(mt.update(ge.inputSource,ge.frame,v||f),mt.dispatchEvent({type:ge.type,data:ge.inputSource}))}function He(){a.removeEventListener("select",fe),a.removeEventListener("selectstart",fe),a.removeEventListener("selectend",fe),a.removeEventListener("squeeze",fe),a.removeEventListener("squeezestart",fe),a.removeEventListener("squeezeend",fe),a.removeEventListener("end",He),a.removeEventListener("inputsourceschange",he);for(let ge=0;ge<O.length;ge++){const tt=B[ge];null!==tt&&(B[ge]=null,O[ge].disconnect(tt))}z=null,Z=null,e.setRenderTarget(A),D=null,w=null,x=null,a=null,k=null,Rt.stop(),o.isPresenting=!1,o.dispatchEvent({type:"sessionend"})}function he(ge){for(let tt=0;tt<ge.removed.length;tt++){const mt=ge.removed[tt],Pt=B.indexOf(mt);Pt>=0&&(B[Pt]=null,O[Pt].disconnect(mt))}for(let tt=0;tt<ge.added.length;tt++){const mt=ge.added[tt];let Pt=B.indexOf(mt);if(-1===Pt){for(let Wt=0;Wt<O.length;Wt++){if(Wt>=B.length){B.push(mt),Pt=Wt;break}if(null===B[Wt]){B[Wt]=mt,Pt=Wt;break}}if(-1===Pt)break}const Bt=O[Pt];Bt&&Bt.connect(mt)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ge){let tt=O[ge];return void 0===tt&&(tt=new Yg,O[ge]=tt),tt.getTargetRaySpace()},this.getControllerGrip=function(ge){let tt=O[ge];return void 0===tt&&(tt=new Yg,O[ge]=tt),tt.getGripSpace()},this.getHand=function(ge){let tt=O[ge];return void 0===tt&&(tt=new Yg,O[ge]=tt),tt.getHandSpace()},this.setFramebufferScaleFactor=function(ge){u=ge,!0===o.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ge){p=ge,!0===o.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return v||f},this.setReferenceSpace=function(ge){v=ge},this.getBaseLayer=function(){return null!==w?w:D},this.getBinding=function(){return x},this.getFrame=function(){return N},this.getSession=function(){return a},this.setSession=function(ge){return(r=r||function Tn(l){return function(){var e=this,t=arguments;return new Promise(function(r,o){var a=l.apply(e,t);function u(p){Tt(a,r,o,u,f,"next",p)}function f(p){Tt(a,r,o,u,f,"throw",p)}u(void 0)})}}(function*(tt){if(a=tt,null!==a){if(A=e.getRenderTarget(),a.addEventListener("select",fe),a.addEventListener("selectstart",fe),a.addEventListener("selectend",fe),a.addEventListener("squeeze",fe),a.addEventListener("squeezestart",fe),a.addEventListener("squeezeend",fe),a.addEventListener("end",He),a.addEventListener("inputsourceschange",he),!0!==I.xrCompatible&&(yield t.makeXRCompatible()),void 0===a.renderState.layers||!1===e.capabilities.isWebGL2)D=new XRWebGLLayer(a,t,{antialias:void 0!==a.renderState.layers||I.antialias,alpha:!0,depth:I.depth,stencil:I.stencil,framebufferScaleFactor:u}),a.updateRenderState({baseLayer:D}),k=new P(D.framebufferWidth,D.framebufferHeight,{format:ui,type:lr,colorSpace:e.outputColorSpace,stencilBuffer:I.stencil});else{let mt=null,Pt=null,Bt=null;I.depth&&(Bt=I.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,mt=I.stencil?yo:yr,Pt=I.stencil?Mn:ae);const Wt={colorFormat:t.RGBA8,depthFormat:Bt,scaleFactor:u};x=new XRWebGLBinding(a,t),w=x.createProjectionLayer(Wt),a.updateRenderState({layers:[w]}),k=new P(w.textureWidth,w.textureHeight,{format:ui,type:lr,depthTexture:new f0(w.textureWidth,w.textureHeight,Pt,void 0,void 0,void 0,void 0,void 0,void 0,mt),stencilBuffer:I.stencil,colorSpace:e.outputColorSpace,samples:I.antialias?4:0}),e.properties.get(k).__ignoreDepthValues=w.ignoreDepthValues}k.isXRRenderTarget=!0,this.setFoveation(m),v=null,f=yield a.requestReferenceSpace(p),Rt.setContext(a),Rt.start(),o.isPresenting=!0,o.dispatchEvent({type:"sessionstart"})}})).apply(this,arguments)},this.getEnvironmentBlendMode=function(){if(null!==a)return a.environmentBlendMode};const pe=new $,ve=new $;function Ue(ge,tt){null===tt?ge.matrixWorld.copy(ge.matrix):ge.matrixWorld.multiplyMatrices(tt.matrixWorld,ge.matrix),ge.matrixWorldInverse.copy(ge.matrixWorld).invert()}this.updateCamera=function(ge){if(null===a)return;ee.near=Y.near=W.near=ge.near,ee.far=Y.far=W.far=ge.far,(z!==ee.near||Z!==ee.far)&&(a.updateRenderState({depthNear:ee.near,depthFar:ee.far}),z=ee.near,Z=ee.far);const tt=ge.parent,mt=ee.cameras;Ue(ee,tt);for(let Pt=0;Pt<mt.length;Pt++)Ue(mt[Pt],tt);2===mt.length?function Xe(ge,tt,mt){pe.setFromMatrixPosition(tt.matrixWorld),ve.setFromMatrixPosition(mt.matrixWorld);const Pt=pe.distanceTo(ve),Bt=tt.projectionMatrix.elements,Wt=mt.projectionMatrix.elements,dn=Bt[14]/(Bt[10]-1),ln=Bt[14]/(Bt[10]+1),Wn=(Bt[9]+1)/Bt[5],fn=(Bt[9]-1)/Bt[5],ne=(Bt[8]-1)/Bt[0],vt=(Wt[8]+1)/Wt[0],Ge=dn*ne,yt=dn*vt,Ze=Pt/(-ne+vt),rn=Ze*-ne;tt.matrixWorld.decompose(ge.position,ge.quaternion,ge.scale),ge.translateX(rn),ge.translateZ(Ze),ge.matrixWorld.compose(ge.position,ge.quaternion,ge.scale),ge.matrixWorldInverse.copy(ge.matrixWorld).invert();const Vt=dn+Ze,Gt=ln+Ze;ge.projectionMatrix.makePerspective(Ge-rn,yt+(Pt-rn),Wn*ln/Gt*Vt,fn*ln/Gt*Vt,Vt,Gt),ge.projectionMatrixInverse.copy(ge.projectionMatrix).invert()}(ee,W,Y):ee.projectionMatrix.copy(W.projectionMatrix),function ze(ge,tt,mt){null===mt?ge.matrix.copy(tt.matrixWorld):(ge.matrix.copy(mt.matrixWorld),ge.matrix.invert(),ge.matrix.multiply(tt.matrixWorld)),ge.matrix.decompose(ge.position,ge.quaternion,ge.scale),ge.updateMatrixWorld(!0),ge.projectionMatrix.copy(tt.projectionMatrix),ge.projectionMatrixInverse.copy(tt.projectionMatrixInverse),ge.isPerspectiveCamera&&(ge.fov=2*Gn*Math.atan(1/ge.projectionMatrix.elements[5]),ge.zoom=1)}(ge,ee,tt)},this.getCamera=function(){return ee},this.getFoveation=function(){if(null!==w||null!==D)return m},this.setFoveation=function(ge){m=ge,null!==w&&(w.fixedFoveation=ge),null!==D&&void 0!==D.fixedFoveation&&(D.fixedFoveation=ge)};let Ye=null;const Rt=new Zh;Rt.setAnimationLoop(function et(ge,tt){if(y=tt.getViewerPose(v||f),N=tt,null!==y){const mt=y.views;null!==D&&(e.setRenderTargetFramebuffer(k,D.framebuffer),e.setRenderTarget(k));let Pt=!1;mt.length!==ee.cameras.length&&(ee.cameras.length=0,Pt=!0);for(let Bt=0;Bt<mt.length;Bt++){const Wt=mt[Bt];let dn=null;if(null!==D)dn=D.getViewport(Wt);else{const Wn=x.getViewSubImage(w,Wt);dn=Wn.viewport,0===Bt&&(e.setRenderTargetTextures(k,Wn.colorTexture,w.ignoreDepthValues?void 0:Wn.depthStencilTexture),e.setRenderTarget(k))}let ln=q[Bt];void 0===ln&&(ln=new xr,ln.layers.enable(Bt),ln.viewport=new L,q[Bt]=ln),ln.matrix.fromArray(Wt.transform.matrix),ln.matrix.decompose(ln.position,ln.quaternion,ln.scale),ln.projectionMatrix.fromArray(Wt.projectionMatrix),ln.projectionMatrixInverse.copy(ln.projectionMatrix).invert(),ln.viewport.set(dn.x,dn.y,dn.width,dn.height),0===Bt&&(ee.matrix.copy(ln.matrix),ee.matrix.decompose(ee.position,ee.quaternion,ee.scale)),!0===Pt&&ee.cameras.push(ln)}}for(let mt=0;mt<O.length;mt++){const Pt=B[mt],Bt=O[mt];null!==Pt&&void 0!==Bt&&Bt.update(Pt,tt,v||f)}Ye&&Ye(ge,tt),tt.detectedPlanes&&o.dispatchEvent({type:"planesdetected",data:tt}),N=null}),this.setAnimationLoop=function(ge){Ye=ge},this.dispose=function(){}}}function iE(l,e){function t(I,A){!0===I.matrixAutoUpdate&&I.updateMatrix(),A.value.copy(I.matrix)}function a(I,A){I.opacity.value=A.opacity,A.color&&I.diffuse.value.copy(A.color),A.emissive&&I.emissive.value.copy(A.emissive).multiplyScalar(A.emissiveIntensity),A.map&&(I.map.value=A.map,t(A.map,I.mapTransform)),A.alphaMap&&(I.alphaMap.value=A.alphaMap,t(A.alphaMap,I.alphaMapTransform)),A.bumpMap&&(I.bumpMap.value=A.bumpMap,t(A.bumpMap,I.bumpMapTransform),I.bumpScale.value=A.bumpScale,1===A.side&&(I.bumpScale.value*=-1)),A.normalMap&&(I.normalMap.value=A.normalMap,t(A.normalMap,I.normalMapTransform),I.normalScale.value.copy(A.normalScale),1===A.side&&I.normalScale.value.negate()),A.displacementMap&&(I.displacementMap.value=A.displacementMap,t(A.displacementMap,I.displacementMapTransform),I.displacementScale.value=A.displacementScale,I.displacementBias.value=A.displacementBias),A.emissiveMap&&(I.emissiveMap.value=A.emissiveMap,t(A.emissiveMap,I.emissiveMapTransform)),A.specularMap&&(I.specularMap.value=A.specularMap,t(A.specularMap,I.specularMapTransform)),A.alphaTest>0&&(I.alphaTest.value=A.alphaTest);const k=e.get(A).envMap;if(k&&(I.envMap.value=k,I.flipEnvMap.value=k.isCubeTexture&&!1===k.isRenderTargetTexture?-1:1,I.reflectivity.value=A.reflectivity,I.ior.value=A.ior,I.refractionRatio.value=A.refractionRatio),A.lightMap){I.lightMap.value=A.lightMap;const O=!0===l._useLegacyLights?Math.PI:1;I.lightMapIntensity.value=A.lightMapIntensity*O,t(A.lightMap,I.lightMapTransform)}A.aoMap&&(I.aoMap.value=A.aoMap,I.aoMapIntensity.value=A.aoMapIntensity,t(A.aoMap,I.aoMapTransform))}return{refreshFogUniforms:function r(I,A){A.color.getRGB(I.fogColor.value,qh(l)),A.isFog?(I.fogNear.value=A.near,I.fogFar.value=A.far):A.isFogExp2&&(I.fogDensity.value=A.density)},refreshMaterialUniforms:function o(I,A,k,O,B){A.isMeshBasicMaterial||A.isMeshLambertMaterial?a(I,A):A.isMeshToonMaterial?(a(I,A),function y(I,A){A.gradientMap&&(I.gradientMap.value=A.gradientMap)}(I,A)):A.isMeshPhongMaterial?(a(I,A),function v(I,A){I.specular.value.copy(A.specular),I.shininess.value=Math.max(A.shininess,1e-4)}(I,A)):A.isMeshStandardMaterial?(a(I,A),function x(I,A){I.metalness.value=A.metalness,A.metalnessMap&&(I.metalnessMap.value=A.metalnessMap,t(A.metalnessMap,I.metalnessMapTransform)),I.roughness.value=A.roughness,A.roughnessMap&&(I.roughnessMap.value=A.roughnessMap,t(A.roughnessMap,I.roughnessMapTransform)),e.get(A).envMap&&(I.envMapIntensity.value=A.envMapIntensity)}(I,A),A.isMeshPhysicalMaterial&&function w(I,A,k){I.ior.value=A.ior,A.sheen>0&&(I.sheenColor.value.copy(A.sheenColor).multiplyScalar(A.sheen),I.sheenRoughness.value=A.sheenRoughness,A.sheenColorMap&&(I.sheenColorMap.value=A.sheenColorMap,t(A.sheenColorMap,I.sheenColorMapTransform)),A.sheenRoughnessMap&&(I.sheenRoughnessMap.value=A.sheenRoughnessMap,t(A.sheenRoughnessMap,I.sheenRoughnessMapTransform))),A.clearcoat>0&&(I.clearcoat.value=A.clearcoat,I.clearcoatRoughness.value=A.clearcoatRoughness,A.clearcoatMap&&(I.clearcoatMap.value=A.clearcoatMap,t(A.clearcoatMap,I.clearcoatMapTransform)),A.clearcoatRoughnessMap&&(I.clearcoatRoughnessMap.value=A.clearcoatRoughnessMap,t(A.clearcoatRoughnessMap,I.clearcoatRoughnessMapTransform)),A.clearcoatNormalMap&&(I.clearcoatNormalMap.value=A.clearcoatNormalMap,t(A.clearcoatNormalMap,I.clearcoatNormalMapTransform),I.clearcoatNormalScale.value.copy(A.clearcoatNormalScale),1===A.side&&I.clearcoatNormalScale.value.negate())),A.iridescence>0&&(I.iridescence.value=A.iridescence,I.iridescenceIOR.value=A.iridescenceIOR,I.iridescenceThicknessMinimum.value=A.iridescenceThicknessRange[0],I.iridescenceThicknessMaximum.value=A.iridescenceThicknessRange[1],A.iridescenceMap&&(I.iridescenceMap.value=A.iridescenceMap,t(A.iridescenceMap,I.iridescenceMapTransform)),A.iridescenceThicknessMap&&(I.iridescenceThicknessMap.value=A.iridescenceThicknessMap,t(A.iridescenceThicknessMap,I.iridescenceThicknessMapTransform))),A.transmission>0&&(I.transmission.value=A.transmission,I.transmissionSamplerMap.value=k.texture,I.transmissionSamplerSize.value.set(k.width,k.height),A.transmissionMap&&(I.transmissionMap.value=A.transmissionMap,t(A.transmissionMap,I.transmissionMapTransform)),I.thickness.value=A.thickness,A.thicknessMap&&(I.thicknessMap.value=A.thicknessMap,t(A.thicknessMap,I.thicknessMapTransform)),I.attenuationDistance.value=A.attenuationDistance,I.attenuationColor.value.copy(A.attenuationColor)),A.anisotropy>0&&(I.anisotropyVector.value.set(A.anisotropy*Math.cos(A.anisotropyRotation),A.anisotropy*Math.sin(A.anisotropyRotation)),A.anisotropyMap&&(I.anisotropyMap.value=A.anisotropyMap,t(A.anisotropyMap,I.anisotropyMapTransform))),I.specularIntensity.value=A.specularIntensity,I.specularColor.value.copy(A.specularColor),A.specularColorMap&&(I.specularColorMap.value=A.specularColorMap,t(A.specularColorMap,I.specularColorMapTransform)),A.specularIntensityMap&&(I.specularIntensityMap.value=A.specularIntensityMap,t(A.specularIntensityMap,I.specularIntensityMapTransform))}(I,A,B)):A.isMeshMatcapMaterial?(a(I,A),function D(I,A){A.matcap&&(I.matcap.value=A.matcap)}(I,A)):A.isMeshDepthMaterial?a(I,A):A.isMeshDistanceMaterial?(a(I,A),function N(I,A){const k=e.get(A).light;I.referencePosition.value.setFromMatrixPosition(k.matrixWorld),I.nearDistance.value=k.shadow.camera.near,I.farDistance.value=k.shadow.camera.far}(I,A)):A.isMeshNormalMaterial?a(I,A):A.isLineBasicMaterial?(function u(I,A){I.diffuse.value.copy(A.color),I.opacity.value=A.opacity,A.map&&(I.map.value=A.map,t(A.map,I.mapTransform))}(I,A),A.isLineDashedMaterial&&function f(I,A){I.dashSize.value=A.dashSize,I.totalSize.value=A.dashSize+A.gapSize,I.scale.value=A.scale}(I,A)):A.isPointsMaterial?function p(I,A,k,O){I.diffuse.value.copy(A.color),I.opacity.value=A.opacity,I.size.value=A.size*k,I.scale.value=.5*O,A.map&&(I.map.value=A.map,t(A.map,I.uvTransform)),A.alphaMap&&(I.alphaMap.value=A.alphaMap,t(A.alphaMap,I.alphaMapTransform)),A.alphaTest>0&&(I.alphaTest.value=A.alphaTest)}(I,A,k,O):A.isSpriteMaterial?function m(I,A){I.diffuse.value.copy(A.color),I.opacity.value=A.opacity,I.rotation.value=A.rotation,A.map&&(I.map.value=A.map,t(A.map,I.mapTransform)),A.alphaMap&&(I.alphaMap.value=A.alphaMap,t(A.alphaMap,I.alphaMapTransform)),A.alphaTest>0&&(I.alphaTest.value=A.alphaTest)}(I,A):A.isShadowMaterial?(I.color.value.copy(A.color),I.opacity.value=A.opacity):A.isShaderMaterial&&(A.uniformsNeedUpdate=!1)}}}function rE(l,e,t,r){let o={},a={},u=[];const f=t.isWebGL2?l.getParameter(l.MAX_UNIFORM_BUFFER_BINDINGS):0;function w(k,O,B){const W=k.value;if(void 0===B[O]){if("number"==typeof W)B[O]=W;else{const Y=Array.isArray(W)?W:[W],q=[];for(let ee=0;ee<Y.length;ee++)q.push(Y[ee].clone());B[O]=q}return!0}if("number"==typeof W){if(B[O]!==W)return B[O]=W,!0}else{const Y=Array.isArray(B[O])?B[O]:[B[O]],q=Array.isArray(W)?W:[W];for(let ee=0;ee<Y.length;ee++){const z=Y[ee];if(!1===z.equals(q[ee]))return z.copy(q[ee]),!0}}return!1}function N(k){const O={boundary:0,storage:0};return"number"==typeof k?(O.boundary=4,O.storage=4):k.isVector2?(O.boundary=8,O.storage=8):k.isVector3||k.isColor?(O.boundary=16,O.storage=12):k.isVector4?(O.boundary=16,O.storage=16):k.isMatrix3?(O.boundary=48,O.storage=48):k.isMatrix4?(O.boundary=64,O.storage=64):k.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",k),O}function I(k){const O=k.target;O.removeEventListener("dispose",I);const B=u.indexOf(O.__bindingPointIndex);u.splice(B,1),l.deleteBuffer(o[O.id]),delete o[O.id],delete a[O.id]}return{bind:function p(k,O){r.uniformBlockBinding(k,O.program)},update:function m(k,O){let B=o[k.id];void 0===B&&(function D(k){const O=k.uniforms;let B=0;let Y=0;for(let q=0,ee=O.length;q<ee;q++){const z=O[q],Z={boundary:0,storage:0},fe=Array.isArray(z.value)?z.value:[z.value];for(let He=0,he=fe.length;He<he;He++){const ve=N(fe[He]);Z.boundary+=ve.boundary,Z.storage+=ve.storage}z.__data=new Float32Array(Z.storage/Float32Array.BYTES_PER_ELEMENT),z.__offset=B,q>0&&(Y=B%16,0!==Y&&16-Y-Z.boundary<0&&(B+=16-Y,z.__offset=B)),B+=Z.storage}Y=B%16,Y>0&&(B+=16-Y),k.__size=B,k.__cache={}}(k),B=function v(k){const O=function y(){for(let k=0;k<f;k++)if(-1===u.indexOf(k))return u.push(k),k;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();k.__bindingPointIndex=O;const B=l.createBuffer(),W=k.__size,Y=k.usage;return l.bindBuffer(l.UNIFORM_BUFFER,B),l.bufferData(l.UNIFORM_BUFFER,W,Y),l.bindBuffer(l.UNIFORM_BUFFER,null),l.bindBufferBase(l.UNIFORM_BUFFER,O,B),B}(k),o[k.id]=B,k.addEventListener("dispose",I)),r.updateUBOMapping(k,O.program);const Y=e.render.frame;a[k.id]!==Y&&(function x(k){const B=k.uniforms,W=k.__cache;l.bindBuffer(l.UNIFORM_BUFFER,o[k.id]);for(let Y=0,q=B.length;Y<q;Y++){const ee=B[Y];if(!0===w(ee,Y,W)){const z=ee.__offset,Z=Array.isArray(ee.value)?ee.value:[ee.value];let fe=0;for(let He=0;He<Z.length;He++){const he=Z[He],pe=N(he);"number"==typeof he?(ee.__data[0]=he,l.bufferSubData(l.UNIFORM_BUFFER,z+fe,ee.__data)):he.isMatrix3?(ee.__data[0]=he.elements[0],ee.__data[1]=he.elements[1],ee.__data[2]=he.elements[2],ee.__data[3]=he.elements[0],ee.__data[4]=he.elements[3],ee.__data[5]=he.elements[4],ee.__data[6]=he.elements[5],ee.__data[7]=he.elements[0],ee.__data[8]=he.elements[6],ee.__data[9]=he.elements[7],ee.__data[10]=he.elements[8],ee.__data[11]=he.elements[0]):(he.toArray(ee.__data,fe),fe+=pe.storage/Float32Array.BYTES_PER_ELEMENT)}l.bufferSubData(l.UNIFORM_BUFFER,z,ee.__data)}}l.bindBuffer(l.UNIFORM_BUFFER,null)}(k),a[k.id]=Y)},dispose:function A(){for(const k in o)l.deleteBuffer(o[k]);u=[],o={},a={}}}}class fd{constructor(e={}){const{canvas:t=Wc(),context:r=null,depth:o=!0,stencil:a=!0,alpha:u=!1,antialias:f=!1,premultipliedAlpha:p=!0,preserveDrawingBuffer:m=!1,powerPreference:v="default",failIfMajorPerformanceCaveat:y=!1}=e;let x;this.isWebGLRenderer=!0,x=null!==r?r.getContextAttributes().alpha:u;const w=new Uint32Array(4),D=new Int32Array(4);let N=null,I=null;const A=[],k=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=_n,this._useLegacyLights=!1,this.toneMapping=Tr,this.toneMappingExposure=1;const O=this;let B=!1,W=0,Y=0,q=null,ee=-1,z=null;const Z=new L,fe=new L;let He=null;const he=new It(0);let pe=0,ve=t.width,Xe=t.height,Ue=1,ze=null,Ye=null;const et=new L(0,0,ve,Xe),Rt=new L(0,0,ve,Xe);let ge=!1;const tt=new df;let mt=!1,Pt=!1,Bt=null;const Wt=new Ht,dn=new Re,ln=new $,Wn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function fn(){return null===q?Ue:1}let Ge,yt,Ze,rn,Vt,Gt,Yt,ei,zi,te,j,Se,dt,rt,pt,Qt,gt,Te,ie,Ke,Ft,St,Ct,An,ne=r;function vt(Q,me){for(let Oe=0;Oe<Q.length;Oe++){const Fe=t.getContext(Q[Oe],me);if(null!==Fe)return Fe}return null}try{const Q={alpha:!0,depth:o,stencil:a,antialias:f,premultipliedAlpha:p,preserveDrawingBuffer:m,powerPreference:v,failIfMajorPerformanceCaveat:y};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r156"),t.addEventListener("webglcontextlost",Lt,!1),t.addEventListener("webglcontextrestored",we,!1),t.addEventListener("webglcontextcreationerror",ct,!1),null===ne){const me=["webgl2","webgl","experimental-webgl"];if(!0===O.isWebGL1Renderer&&me.shift(),ne=vt(me,Q),null===ne)throw vt(me)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&ne instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===ne.getShaderPrecisionFormat&&(ne.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Q){throw console.error("THREE.WebGLRenderer: "+Q.message),Q}function ti(){Ge=new Rf(ne),yt=new U_(ne,Ge,e),Ge.init(yt),St=new d0(ne,Ge,yt),Ze=new l0(ne,Ge,yt),rn=new up(ne),Vt=new Vg,Gt=new u0(ne,Ge,Ze,Vt,yt,St,rn),Yt=new dg(O),ei=new pg(O),zi=new qu(ne,yt),Ct=new O_(ne,Ge,zi,yt),te=new nd(ne,zi,rn,Ct),j=new id(ne,te,zi,rn),ie=new dp(ne,yt,Gt),Qt=new k_(Vt),Se=new Tp(O,Yt,ei,Ge,yt,Ct,Qt),dt=new iE(O,Vt),rt=new Ap,pt=new Dp(Ge,yt),Te=new N_(O,Yt,ei,Ze,j,x,p),gt=new c0(O,j,yt),An=new rE(ne,rn,yt,Ze),Ke=new F_(ne,Ge,rn,yt),Ft=new mg(ne,Ge,rn,yt),rn.programs=Se.programs,O.capabilities=yt,O.extensions=Ge,O.properties=Vt,O.renderLists=rt,O.shadowMap=gt,O.state=Ze,O.info=rn}ti();const ce=new h0(O,ne);function Lt(Q){Q.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),B=!0}function we(){console.log("THREE.WebGLRenderer: Context Restored."),B=!1;const Q=rn.autoReset,me=gt.enabled,Oe=gt.autoUpdate,xe=gt.needsUpdate,Fe=gt.type;ti(),rn.autoReset=Q,gt.enabled=me,gt.autoUpdate=Oe,gt.needsUpdate=xe,gt.type=Fe}function ct(Q){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Q.statusMessage)}function xt(Q){const me=Q.target;me.removeEventListener("dispose",xt),function Kn(Q){(function Si(Q){const me=Vt.get(Q).programs;void 0!==me&&(me.forEach(function(Oe){Se.releaseProgram(Oe)}),Q.isShaderMaterial&&Se.releaseShaderCache(Q))})(Q),Vt.remove(Q)}(me)}this.xr=ce,this.getContext=function(){return ne},this.getContextAttributes=function(){return ne.getContextAttributes()},this.forceContextLoss=function(){const Q=Ge.get("WEBGL_lose_context");Q&&Q.loseContext()},this.forceContextRestore=function(){const Q=Ge.get("WEBGL_lose_context");Q&&Q.restoreContext()},this.getPixelRatio=function(){return Ue},this.setPixelRatio=function(Q){void 0!==Q&&(Ue=Q,this.setSize(ve,Xe,!1))},this.getSize=function(Q){return Q.set(ve,Xe)},this.setSize=function(Q,me,Oe=!0){ce.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(ve=Q,Xe=me,t.width=Math.floor(Q*Ue),t.height=Math.floor(me*Ue),!0===Oe&&(t.style.width=Q+"px",t.style.height=me+"px"),this.setViewport(0,0,Q,me))},this.getDrawingBufferSize=function(Q){return Q.set(ve*Ue,Xe*Ue).floor()},this.setDrawingBufferSize=function(Q,me,Oe){ve=Q,Xe=me,Ue=Oe,t.width=Math.floor(Q*Oe),t.height=Math.floor(me*Oe),this.setViewport(0,0,Q,me)},this.getCurrentViewport=function(Q){return Q.copy(Z)},this.getViewport=function(Q){return Q.copy(et)},this.setViewport=function(Q,me,Oe,xe){Q.isVector4?et.set(Q.x,Q.y,Q.z,Q.w):et.set(Q,me,Oe,xe),Ze.viewport(Z.copy(et).multiplyScalar(Ue).floor())},this.getScissor=function(Q){return Q.copy(Rt)},this.setScissor=function(Q,me,Oe,xe){Q.isVector4?Rt.set(Q.x,Q.y,Q.z,Q.w):Rt.set(Q,me,Oe,xe),Ze.scissor(fe.copy(Rt).multiplyScalar(Ue).floor())},this.getScissorTest=function(){return ge},this.setScissorTest=function(Q){Ze.setScissorTest(ge=Q)},this.setOpaqueSort=function(Q){ze=Q},this.setTransparentSort=function(Q){Ye=Q},this.getClearColor=function(Q){return Q.copy(Te.getClearColor())},this.setClearColor=function(){Te.setClearColor.apply(Te,arguments)},this.getClearAlpha=function(){return Te.getClearAlpha()},this.setClearAlpha=function(){Te.setClearAlpha.apply(Te,arguments)},this.clear=function(Q=!0,me=!0,Oe=!0){let xe=0;if(Q){let Fe=!1;if(null!==q){const Xt=q.texture.format;Fe=1033===Xt||1031===Xt||1029===Xt}if(Fe){const Xt=q.texture.type,vn=Xt===lr||Xt===ae||1012===Xt||Xt===Mn||1017===Xt||1018===Xt,Cn=Te.getClearColor(),bn=Te.getClearAlpha(),Jn=Cn.r,wn=Cn.g,Ln=Cn.b;vn?(w[0]=Jn,w[1]=wn,w[2]=Ln,w[3]=bn,ne.clearBufferuiv(ne.COLOR,0,w)):(D[0]=Jn,D[1]=wn,D[2]=Ln,D[3]=bn,ne.clearBufferiv(ne.COLOR,0,D))}else xe|=ne.COLOR_BUFFER_BIT}me&&(xe|=ne.DEPTH_BUFFER_BIT),Oe&&(xe|=ne.STENCIL_BUFFER_BIT),ne.clear(xe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Lt,!1),t.removeEventListener("webglcontextrestored",we,!1),t.removeEventListener("webglcontextcreationerror",ct,!1),rt.dispose(),pt.dispose(),Vt.dispose(),Yt.dispose(),ei.dispose(),j.dispose(),Ct.dispose(),An.dispose(),Se.dispose(),ce.dispose(),ce.removeEventListener("sessionstart",Ui),ce.removeEventListener("sessionend",va),Bt&&(Bt.dispose(),Bt=null),ns.stop()},this.renderBufferDirect=function(Q,me,Oe,xe,Fe,Xt){null===me&&(me=Wn);const vn=Fe.isMesh&&Fe.matrixWorld.determinant()<0,Cn=function Lh(Q,me,Oe,xe,Fe){!0!==me.isScene&&(me=Wn),Gt.resetTextureUnits();const Xt=me.fog,Cn=null===q?O.outputColorSpace:!0===q.isXRRenderTarget?q.texture.colorSpace:Oi,bn=(xe.isMeshStandardMaterial?ei:Yt).get(xe.envMap||(xe.isMeshStandardMaterial?me.environment:null)),Jn=!0===xe.vertexColors&&!!Oe.attributes.color&&4===Oe.attributes.color.itemSize,wn=!!Oe.attributes.tangent&&(!!xe.normalMap||xe.anisotropy>0),Ln=!!Oe.morphAttributes.position,qi=!!Oe.morphAttributes.normal,Zi=!!Oe.morphAttributes.color;let ho=Tr;xe.toneMapped&&(null===q||!0===q.isXRRenderTarget)&&(ho=O.toneMapping);const ya=Oe.morphAttributes.position||Oe.morphAttributes.normal||Oe.morphAttributes.color,gr=void 0!==ya?ya.length:0,Qn=Vt.get(xe),Im=I.state.lights;!0!==mt||!0!==Pt&&Q===z||Qt.setState(xe,Q,Q===z&&xe.id===ee);let Ki=!1;xe.version===Qn.__version?(Qn.needsLights&&Qn.lightsStateVersion!==Im.state.version||Qn.outputColorSpace!==Cn||Fe.isInstancedMesh&&!1===Qn.instancing||!Fe.isInstancedMesh&&!0===Qn.instancing||Fe.isSkinnedMesh&&!1===Qn.skinning||!Fe.isSkinnedMesh&&!0===Qn.skinning||Fe.isInstancedMesh&&!0===Qn.instancingColor&&null===Fe.instanceColor||Fe.isInstancedMesh&&!1===Qn.instancingColor&&null!==Fe.instanceColor||Qn.envMap!==bn||!0===xe.fog&&Qn.fog!==Xt||void 0!==Qn.numClippingPlanes&&(Qn.numClippingPlanes!==Qt.numPlanes||Qn.numIntersection!==Qt.numIntersection)||Qn.vertexAlphas!==Jn||Qn.vertexTangents!==wn||Qn.morphTargets!==Ln||Qn.morphNormals!==qi||Qn.morphColors!==Zi||Qn.toneMapping!==ho||!0===yt.isWebGL2&&Qn.morphTargetsCount!==gr)&&(Ki=!0):(Ki=!0,Qn.__version=xe.version);let El=Qn.currentProgram;!0===Ki&&(El=Cm(xe,me,Fe));let Rm=!1,Au=!1,Pm=!1;const ds=El.getUniforms(),Sl=Qn.uniforms;if(Ze.useProgram(El.program)&&(Rm=!0,Au=!0,Pm=!0),xe.id!==ee&&(ee=xe.id,Au=!0),Rm||z!==Q){ds.setValue(ne,"projectionMatrix",Q.projectionMatrix),ds.setValue(ne,"viewMatrix",Q.matrixWorldInverse);const Hs=ds.map.cameraPosition;void 0!==Hs&&Hs.setValue(ne,ln.setFromMatrixPosition(Q.matrixWorld)),yt.logarithmicDepthBuffer&&ds.setValue(ne,"logDepthBufFC",2/(Math.log(Q.far+1)/Math.LN2)),(xe.isMeshPhongMaterial||xe.isMeshToonMaterial||xe.isMeshLambertMaterial||xe.isMeshBasicMaterial||xe.isMeshStandardMaterial||xe.isShaderMaterial)&&ds.setValue(ne,"isOrthographic",!0===Q.isOrthographicCamera),z!==Q&&(z=Q,Au=!0,Pm=!0)}if(Fe.isSkinnedMesh){ds.setOptional(ne,Fe,"bindMatrix"),ds.setOptional(ne,Fe,"bindMatrixInverse");const Hs=Fe.skeleton;Hs&&(yt.floatVertexTextures?(null===Hs.boneTexture&&Hs.computeBoneTexture(),ds.setValue(ne,"boneTexture",Hs.boneTexture,Gt),ds.setValue(ne,"boneTextureSize",Hs.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Xd=Oe.morphAttributes;if((void 0!==Xd.position||void 0!==Xd.normal||void 0!==Xd.color&&!0===yt.isWebGL2)&&ie.update(Fe,Oe,El),(Au||Qn.receiveShadow!==Fe.receiveShadow)&&(Qn.receiveShadow=Fe.receiveShadow,ds.setValue(ne,"receiveShadow",Fe.receiveShadow)),xe.isMeshGouraudMaterial&&null!==xe.envMap&&(Sl.envMap.value=bn,Sl.flipEnvMap.value=bn.isCubeTexture&&!1===bn.isRenderTargetTexture?-1:1),Au&&(ds.setValue(ne,"toneMappingExposure",O.toneMappingExposure),Qn.needsLights&&function TM(Q,me){Q.ambientLightColor.needsUpdate=me,Q.lightProbe.needsUpdate=me,Q.directionalLights.needsUpdate=me,Q.directionalLightShadows.needsUpdate=me,Q.pointLights.needsUpdate=me,Q.pointLightShadows.needsUpdate=me,Q.spotLights.needsUpdate=me,Q.spotLightShadows.needsUpdate=me,Q.rectAreaLights.needsUpdate=me,Q.hemisphereLights.needsUpdate=me}(Sl,Pm),Xt&&!0===xe.fog&&dt.refreshFogUniforms(Sl,Xt),dt.refreshMaterialUniforms(Sl,xe,Ue,Xe,Bt),ad.upload(ne,Qn.uniformsList,Sl,Gt)),xe.isShaderMaterial&&!0===xe.uniformsNeedUpdate&&(ad.upload(ne,Qn.uniformsList,Sl,Gt),xe.uniformsNeedUpdate=!1),xe.isSpriteMaterial&&ds.setValue(ne,"center",Fe.center),ds.setValue(ne,"modelViewMatrix",Fe.modelViewMatrix),ds.setValue(ne,"normalMatrix",Fe.normalMatrix),ds.setValue(ne,"modelMatrix",Fe.matrixWorld),xe.isShaderMaterial||xe.isRawShaderMaterial){const Hs=xe.uniformsGroups;for(let Nh=0,CM=Hs.length;Nh<CM;Nh++)if(yt.isWebGL2){const Dy=Hs[Nh];An.update(Dy,El),An.bind(Dy,El)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return El}(Q,me,Oe,xe,Fe);Ze.setMaterial(xe,vn);let bn=Oe.index,Jn=1;if(!0===xe.wireframe){if(bn=te.getWireframeAttribute(Oe),void 0===bn)return;Jn=2}const wn=Oe.drawRange,Ln=Oe.attributes.position;let qi=wn.start*Jn,Zi=(wn.start+wn.count)*Jn;null!==Xt&&(qi=Math.max(qi,Xt.start*Jn),Zi=Math.min(Zi,(Xt.start+Xt.count)*Jn)),null!==bn?(qi=Math.max(qi,0),Zi=Math.min(Zi,bn.count)):null!=Ln&&(qi=Math.max(qi,0),Zi=Math.min(Zi,Ln.count));const ho=Zi-qi;if(ho<0||ho===1/0)return;Ct.setup(Fe,xe,Cn,Oe,bn);let ya,gr=Ke;if(null!==bn&&(ya=zi.get(bn),gr=Ft,gr.setIndex(ya)),Fe.isMesh)!0===xe.wireframe?(Ze.setLineWidth(xe.wireframeLinewidth*fn()),gr.setMode(ne.LINES)):gr.setMode(ne.TRIANGLES);else if(Fe.isLine){let Qn=xe.linewidth;void 0===Qn&&(Qn=1),Ze.setLineWidth(Qn*fn()),gr.setMode(Fe.isLineSegments?ne.LINES:Fe.isLineLoop?ne.LINE_LOOP:ne.LINE_STRIP)}else Fe.isPoints?gr.setMode(ne.POINTS):Fe.isSprite&&gr.setMode(ne.TRIANGLES);if(Fe.isInstancedMesh)gr.renderInstances(qi,ho,Fe.count);else if(Oe.isInstancedBufferGeometry){const Im=Math.min(Oe.instanceCount,void 0!==Oe._maxInstanceCount?Oe._maxInstanceCount:1/0);gr.renderInstances(qi,ho,Im)}else gr.render(qi,ho)},this.compile=function(Q,me){function Oe(xe,Fe,Xt){!0===xe.transparent&&2===xe.side&&!1===xe.forceSinglePass?(xe.side=1,xe.needsUpdate=!0,Cm(xe,Fe,Xt),xe.side=0,xe.needsUpdate=!0,Cm(xe,Fe,Xt),xe.side=2):Cm(xe,Fe,Xt)}I=pt.get(Q),I.init(),k.push(I),Q.traverseVisible(function(xe){xe.isLight&&xe.layers.test(me.layers)&&(I.pushLight(xe),xe.castShadow&&I.pushShadow(xe))}),I.setupLights(O._useLegacyLights),Q.traverse(function(xe){const Fe=xe.material;if(Fe)if(Array.isArray(Fe))for(let Xt=0;Xt<Fe.length;Xt++)Oe(Fe[Xt],Q,xe);else Oe(Fe,Q,xe)}),k.pop(),I=null};let Li=null;function Ui(){ns.stop()}function va(){ns.start()}const ns=new Zh;function Ay(Q,me,Oe,xe){if(!1===Q.visible)return;if(Q.layers.test(me.layers))if(Q.isGroup)Oe=Q.renderOrder;else if(Q.isLOD)!0===Q.autoUpdate&&Q.update(me);else if(Q.isLight)I.pushLight(Q),Q.castShadow&&I.pushShadow(Q);else if(Q.isSprite){if(!Q.frustumCulled||tt.intersectsSprite(Q)){xe&&ln.setFromMatrixPosition(Q.matrixWorld).applyMatrix4(Wt);const vn=j.update(Q),Cn=Q.material;Cn.visible&&N.push(Q,vn,Cn,Oe,ln.z,null)}}else if((Q.isMesh||Q.isLine||Q.isPoints)&&(!Q.frustumCulled||tt.intersectsObject(Q))){const vn=j.update(Q),Cn=Q.material;if(xe&&(void 0!==Q.boundingSphere?(null===Q.boundingSphere&&Q.computeBoundingSphere(),ln.copy(Q.boundingSphere.center)):(null===vn.boundingSphere&&vn.computeBoundingSphere(),ln.copy(vn.boundingSphere.center)),ln.applyMatrix4(Q.matrixWorld).applyMatrix4(Wt)),Array.isArray(Cn)){const bn=vn.groups;for(let Jn=0,wn=bn.length;Jn<wn;Jn++){const Ln=bn[Jn],qi=Cn[Ln.materialIndex];qi&&qi.visible&&N.push(Q,vn,qi,Oe,ln.z,Ln)}}else Cn.visible&&N.push(Q,vn,Cn,Oe,ln.z,null)}const Xt=Q.children;for(let vn=0,Cn=Xt.length;vn<Cn;vn++)Ay(Xt[vn],me,Oe,xe)}function Cy(Q,me,Oe,xe){const Fe=Q.opaque,Xt=Q.transmissive,vn=Q.transparent;I.setupLightsView(Oe),!0===mt&&Qt.setGlobalState(O.clippingPlanes,Oe),Xt.length>0&&function NE(Q,me,Oe,xe){const Fe=yt.isWebGL2;null===Bt&&(Bt=new P(1,1,{generateMipmaps:!0,type:Ge.has("EXT_color_buffer_half_float")?it:lr,minFilter:Or,samples:Fe?4:0})),O.getDrawingBufferSize(dn),Fe?Bt.setSize(dn.x,dn.y):Bt.setSize(La(dn.x),La(dn.y));const Xt=O.getRenderTarget();O.setRenderTarget(Bt),O.getClearColor(he),pe=O.getClearAlpha(),pe<1&&O.setClearColor(16777215,.5),O.clear();const vn=O.toneMapping;O.toneMapping=Tr,Am(Q,Oe,xe),Gt.updateMultisampleRenderTarget(Bt),Gt.updateRenderTargetMipmap(Bt);let Cn=!1;for(let bn=0,Jn=me.length;bn<Jn;bn++){const wn=me[bn],Ln=wn.object,qi=wn.geometry,Zi=wn.material,ho=wn.group;if(2===Zi.side&&Ln.layers.test(xe.layers)){const ya=Zi.side;Zi.side=1,Zi.needsUpdate=!0,wM(Ln,Oe,xe,qi,Zi,ho),Zi.side=ya,Zi.needsUpdate=!0,Cn=!0}}!0===Cn&&(Gt.updateMultisampleRenderTarget(Bt),Gt.updateRenderTargetMipmap(Bt)),O.setRenderTarget(Xt),O.setClearColor(he,pe),O.toneMapping=vn}(Fe,Xt,me,Oe),xe&&Ze.viewport(Z.copy(xe)),Fe.length>0&&Am(Fe,me,Oe),Xt.length>0&&Am(Xt,me,Oe),vn.length>0&&Am(vn,me,Oe),Ze.buffers.depth.setTest(!0),Ze.buffers.depth.setMask(!0),Ze.buffers.color.setMask(!0),Ze.setPolygonOffset(!1)}function Am(Q,me,Oe){const xe=!0===me.isScene?me.overrideMaterial:null;for(let Fe=0,Xt=Q.length;Fe<Xt;Fe++){const vn=Q[Fe],Cn=vn.object,bn=vn.geometry,Jn=null===xe?vn.material:xe,wn=vn.group;Cn.layers.test(Oe.layers)&&wM(Cn,me,Oe,bn,Jn,wn)}}function wM(Q,me,Oe,xe,Fe,Xt){Q.onBeforeRender(O,me,Oe,xe,Fe,Xt),Q.modelViewMatrix.multiplyMatrices(Oe.matrixWorldInverse,Q.matrixWorld),Q.normalMatrix.getNormalMatrix(Q.modelViewMatrix),Fe.onBeforeRender(O,me,Oe,xe,Q,Xt),!0===Fe.transparent&&2===Fe.side&&!1===Fe.forceSinglePass?(Fe.side=1,Fe.needsUpdate=!0,O.renderBufferDirect(Oe,me,xe,Fe,Q,Xt),Fe.side=0,Fe.needsUpdate=!0,O.renderBufferDirect(Oe,me,xe,Fe,Q,Xt),Fe.side=2):O.renderBufferDirect(Oe,me,xe,Fe,Q,Xt),Q.onAfterRender(O,me,Oe,xe,Fe,Xt)}function Cm(Q,me,Oe){!0!==me.isScene&&(me=Wn);const xe=Vt.get(Q),Fe=I.state.lights,vn=Fe.state.version,Cn=Se.getParameters(Q,Fe.state,I.state.shadowsArray,me,Oe),bn=Se.getProgramCacheKey(Cn);let Jn=xe.programs;xe.environment=Q.isMeshStandardMaterial?me.environment:null,xe.fog=me.fog,xe.envMap=(Q.isMeshStandardMaterial?ei:Yt).get(Q.envMap||xe.environment),void 0===Jn&&(Q.addEventListener("dispose",xt),Jn=new Map,xe.programs=Jn);let wn=Jn.get(bn);if(void 0!==wn){if(xe.currentProgram===wn&&xe.lightsStateVersion===vn)return Dm(Q,Cn),wn}else Cn.uniforms=Se.getUniforms(Q),Q.onBuild(Oe,Cn,O),Q.onBeforeCompile(Cn,O),wn=Se.acquireProgram(Cn,bn),Jn.set(bn,wn),xe.uniforms=Cn.uniforms;const Ln=xe.uniforms;(!Q.isShaderMaterial&&!Q.isRawShaderMaterial||!0===Q.clipping)&&(Ln.clippingPlanes=Qt.uniform),Dm(Q,Cn),xe.needsLights=function AM(Q){return Q.isMeshLambertMaterial||Q.isMeshToonMaterial||Q.isMeshPhongMaterial||Q.isMeshStandardMaterial||Q.isShadowMaterial||Q.isShaderMaterial&&!0===Q.lights}(Q),xe.lightsStateVersion=vn,xe.needsLights&&(Ln.ambientLightColor.value=Fe.state.ambient,Ln.lightProbe.value=Fe.state.probe,Ln.directionalLights.value=Fe.state.directional,Ln.directionalLightShadows.value=Fe.state.directionalShadow,Ln.spotLights.value=Fe.state.spot,Ln.spotLightShadows.value=Fe.state.spotShadow,Ln.rectAreaLights.value=Fe.state.rectArea,Ln.ltc_1.value=Fe.state.rectAreaLTC1,Ln.ltc_2.value=Fe.state.rectAreaLTC2,Ln.pointLights.value=Fe.state.point,Ln.pointLightShadows.value=Fe.state.pointShadow,Ln.hemisphereLights.value=Fe.state.hemi,Ln.directionalShadowMap.value=Fe.state.directionalShadowMap,Ln.directionalShadowMatrix.value=Fe.state.directionalShadowMatrix,Ln.spotShadowMap.value=Fe.state.spotShadowMap,Ln.spotLightMatrix.value=Fe.state.spotLightMatrix,Ln.spotLightMap.value=Fe.state.spotLightMap,Ln.pointShadowMap.value=Fe.state.pointShadowMap,Ln.pointShadowMatrix.value=Fe.state.pointShadowMatrix);const qi=wn.getUniforms(),Zi=ad.seqWithValue(qi.seq,Ln);return xe.currentProgram=wn,xe.uniformsList=Zi,wn}function Dm(Q,me){const Oe=Vt.get(Q);Oe.outputColorSpace=me.outputColorSpace,Oe.instancing=me.instancing,Oe.instancingColor=me.instancingColor,Oe.skinning=me.skinning,Oe.morphTargets=me.morphTargets,Oe.morphNormals=me.morphNormals,Oe.morphColors=me.morphColors,Oe.morphTargetsCount=me.morphTargetsCount,Oe.numClippingPlanes=me.numClippingPlanes,Oe.numIntersection=me.numClipIntersection,Oe.vertexAlphas=me.vertexAlphas,Oe.vertexTangents=me.vertexTangents,Oe.toneMapping=me.toneMapping}ns.setAnimationLoop(function ws(Q){Li&&Li(Q)}),typeof self<"u"&&ns.setContext(self),this.setAnimationLoop=function(Q){Li=Q,ce.setAnimationLoop(Q),null===Q?ns.stop():ns.start()},ce.addEventListener("sessionstart",Ui),ce.addEventListener("sessionend",va),this.render=function(Q,me){if(void 0===me||!0===me.isCamera){if(!0!==B){if(!0===Q.matrixWorldAutoUpdate&&Q.updateMatrixWorld(),null===me.parent&&!0===me.matrixWorldAutoUpdate&&me.updateMatrixWorld(),!0===ce.enabled&&!0===ce.isPresenting&&(!0===ce.cameraAutoUpdate&&ce.updateCamera(me),me=ce.getCamera()),!0===Q.isScene&&Q.onBeforeRender(O,Q,me,q),I=pt.get(Q,k.length),I.init(),k.push(I),Wt.multiplyMatrices(me.projectionMatrix,me.matrixWorldInverse),tt.setFromProjectionMatrix(Wt),Pt=this.localClippingEnabled,mt=Qt.init(this.clippingPlanes,Pt),N=rt.get(Q,A.length),N.init(),A.push(N),Ay(Q,me,0,O.sortObjects),N.finish(),!0===O.sortObjects&&N.sort(ze,Ye),this.info.render.frame++,!0===mt&&Qt.beginShadows(),gt.render(I.state.shadowsArray,Q,me),!0===mt&&Qt.endShadows(),!0===this.info.autoReset&&this.info.reset(),Te.render(N,Q),I.setupLights(O._useLegacyLights),me.isArrayCamera){const xe=me.cameras;for(let Fe=0,Xt=xe.length;Fe<Xt;Fe++){const vn=xe[Fe];Cy(N,Q,vn,vn.viewport)}}else Cy(N,Q,me);null!==q&&(Gt.updateMultisampleRenderTarget(q),Gt.updateRenderTargetMipmap(q)),!0===Q.isScene&&Q.onAfterRender(O,Q,me),Ct.resetDefaultState(),ee=-1,z=null,k.pop(),I=k.length>0?k[k.length-1]:null,A.pop(),N=A.length>0?A[A.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return W},this.getActiveMipmapLevel=function(){return Y},this.getRenderTarget=function(){return q},this.setRenderTargetTextures=function(Q,me,Oe){Vt.get(Q.texture).__webglTexture=me,Vt.get(Q.depthTexture).__webglTexture=Oe;const xe=Vt.get(Q);xe.__hasExternalTextures=!0,xe.__hasExternalTextures&&(xe.__autoAllocateDepthBuffer=void 0===Oe,xe.__autoAllocateDepthBuffer||!0===Ge.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),xe.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Q,me){const Oe=Vt.get(Q);Oe.__webglFramebuffer=me,Oe.__useDefaultFramebuffer=void 0===me},this.setRenderTarget=function(Q,me=0,Oe=0){q=Q,W=me,Y=Oe;let xe=!0,Fe=null,Xt=!1,vn=!1;if(Q){const bn=Vt.get(Q);void 0!==bn.__useDefaultFramebuffer?(Ze.bindFramebuffer(ne.FRAMEBUFFER,null),xe=!1):void 0===bn.__webglFramebuffer?Gt.setupRenderTarget(Q):bn.__hasExternalTextures&&Gt.rebindTextures(Q,Vt.get(Q.texture).__webglTexture,Vt.get(Q.depthTexture).__webglTexture);const Jn=Q.texture;(Jn.isData3DTexture||Jn.isDataArrayTexture||Jn.isCompressedArrayTexture)&&(vn=!0);const wn=Vt.get(Q).__webglFramebuffer;Q.isWebGLCubeRenderTarget?(Fe=Array.isArray(wn[me])?wn[me][Oe]:wn[me],Xt=!0):Fe=yt.isWebGL2&&Q.samples>0&&!1===Gt.useMultisampledRTT(Q)?Vt.get(Q).__webglMultisampledFramebuffer:Array.isArray(wn)?wn[Oe]:wn,Z.copy(Q.viewport),fe.copy(Q.scissor),He=Q.scissorTest}else Z.copy(et).multiplyScalar(Ue).floor(),fe.copy(Rt).multiplyScalar(Ue).floor(),He=ge;if(Ze.bindFramebuffer(ne.FRAMEBUFFER,Fe)&&yt.drawBuffers&&xe&&Ze.drawBuffers(Q,Fe),Ze.viewport(Z),Ze.scissor(fe),Ze.setScissorTest(He),Xt){const bn=Vt.get(Q.texture);ne.framebufferTexture2D(ne.FRAMEBUFFER,ne.COLOR_ATTACHMENT0,ne.TEXTURE_CUBE_MAP_POSITIVE_X+me,bn.__webglTexture,Oe)}else if(vn){const bn=Vt.get(Q.texture);ne.framebufferTextureLayer(ne.FRAMEBUFFER,ne.COLOR_ATTACHMENT0,bn.__webglTexture,Oe||0,me||0)}ee=-1},this.readRenderTargetPixels=function(Q,me,Oe,xe,Fe,Xt,vn){if(!Q||!Q.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Cn=Vt.get(Q).__webglFramebuffer;if(Q.isWebGLCubeRenderTarget&&void 0!==vn&&(Cn=Cn[vn]),Cn){Ze.bindFramebuffer(ne.FRAMEBUFFER,Cn);try{const bn=Q.texture,Jn=bn.format,wn=bn.type;if(Jn!==ui&&St.convert(Jn)!==ne.getParameter(ne.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Ln=wn===it&&(Ge.has("EXT_color_buffer_half_float")||yt.isWebGL2&&Ge.has("EXT_color_buffer_float"));if(!(wn===lr||St.convert(wn)===ne.getParameter(ne.IMPLEMENTATION_COLOR_READ_TYPE)||wn===_e&&(yt.isWebGL2||Ge.has("OES_texture_float")||Ge.has("WEBGL_color_buffer_float"))||Ln))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");me>=0&&me<=Q.width-xe&&Oe>=0&&Oe<=Q.height-Fe&&ne.readPixels(me,Oe,xe,Fe,St.convert(Jn),St.convert(wn),Xt)}finally{const bn=null!==q?Vt.get(q).__webglFramebuffer:null;Ze.bindFramebuffer(ne.FRAMEBUFFER,bn)}}},this.copyFramebufferToTexture=function(Q,me,Oe=0){const xe=Math.pow(2,-Oe),Fe=Math.floor(me.image.width*xe),Xt=Math.floor(me.image.height*xe);Gt.setTexture2D(me,0),ne.copyTexSubImage2D(ne.TEXTURE_2D,Oe,0,0,Q.x,Q.y,Fe,Xt),Ze.unbindTexture()},this.copyTextureToTexture=function(Q,me,Oe,xe=0){const Fe=me.image.width,Xt=me.image.height,vn=St.convert(Oe.format),Cn=St.convert(Oe.type);Gt.setTexture2D(Oe,0),ne.pixelStorei(ne.UNPACK_FLIP_Y_WEBGL,Oe.flipY),ne.pixelStorei(ne.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Oe.premultiplyAlpha),ne.pixelStorei(ne.UNPACK_ALIGNMENT,Oe.unpackAlignment),me.isDataTexture?ne.texSubImage2D(ne.TEXTURE_2D,xe,Q.x,Q.y,Fe,Xt,vn,Cn,me.image.data):me.isCompressedTexture?ne.compressedTexSubImage2D(ne.TEXTURE_2D,xe,Q.x,Q.y,me.mipmaps[0].width,me.mipmaps[0].height,vn,me.mipmaps[0].data):ne.texSubImage2D(ne.TEXTURE_2D,xe,Q.x,Q.y,vn,Cn,me.image),0===xe&&Oe.generateMipmaps&&ne.generateMipmap(ne.TEXTURE_2D),Ze.unbindTexture()},this.copyTextureToTexture3D=function(Q,me,Oe,xe,Fe=0){if(O.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Xt=Q.max.x-Q.min.x+1,vn=Q.max.y-Q.min.y+1,Cn=Q.max.z-Q.min.z+1,bn=St.convert(xe.format),Jn=St.convert(xe.type);let wn;if(xe.isData3DTexture)Gt.setTexture3D(xe,0),wn=ne.TEXTURE_3D;else{if(!xe.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Gt.setTexture2DArray(xe,0),wn=ne.TEXTURE_2D_ARRAY}ne.pixelStorei(ne.UNPACK_FLIP_Y_WEBGL,xe.flipY),ne.pixelStorei(ne.UNPACK_PREMULTIPLY_ALPHA_WEBGL,xe.premultiplyAlpha),ne.pixelStorei(ne.UNPACK_ALIGNMENT,xe.unpackAlignment);const Ln=ne.getParameter(ne.UNPACK_ROW_LENGTH),qi=ne.getParameter(ne.UNPACK_IMAGE_HEIGHT),Zi=ne.getParameter(ne.UNPACK_SKIP_PIXELS),ho=ne.getParameter(ne.UNPACK_SKIP_ROWS),ya=ne.getParameter(ne.UNPACK_SKIP_IMAGES),gr=Oe.isCompressedTexture?Oe.mipmaps[0]:Oe.image;ne.pixelStorei(ne.UNPACK_ROW_LENGTH,gr.width),ne.pixelStorei(ne.UNPACK_IMAGE_HEIGHT,gr.height),ne.pixelStorei(ne.UNPACK_SKIP_PIXELS,Q.min.x),ne.pixelStorei(ne.UNPACK_SKIP_ROWS,Q.min.y),ne.pixelStorei(ne.UNPACK_SKIP_IMAGES,Q.min.z),Oe.isDataTexture||Oe.isData3DTexture?ne.texSubImage3D(wn,Fe,me.x,me.y,me.z,Xt,vn,Cn,bn,Jn,gr.data):Oe.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ne.compressedTexSubImage3D(wn,Fe,me.x,me.y,me.z,Xt,vn,Cn,bn,gr.data)):ne.texSubImage3D(wn,Fe,me.x,me.y,me.z,Xt,vn,Cn,bn,Jn,gr),ne.pixelStorei(ne.UNPACK_ROW_LENGTH,Ln),ne.pixelStorei(ne.UNPACK_IMAGE_HEIGHT,qi),ne.pixelStorei(ne.UNPACK_SKIP_PIXELS,Zi),ne.pixelStorei(ne.UNPACK_SKIP_ROWS,ho),ne.pixelStorei(ne.UNPACK_SKIP_IMAGES,ya),0===Fe&&xe.generateMipmaps&&ne.generateMipmap(wn),Ze.unbindTexture()},this.initTexture=function(Q){Q.isCubeTexture?Gt.setTextureCube(Q,0):Q.isData3DTexture?Gt.setTexture3D(Q,0):Q.isDataArrayTexture||Q.isCompressedArrayTexture?Gt.setTexture2DArray(Q,0):Gt.setTexture2D(Q,0),Ze.unbindTexture()},this.resetState=function(){W=0,Y=0,q=null,Ze.reset(),Ct.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return bo}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===_n?$s:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===$s?_n:Oi}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class p0 extends fd{}).prototype.isWebGL1Renderer=!0;class sl extends sn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class md{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Rr()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let o=0,a=this.stride;o<a;o++)this.array[e+o]=t.array[r+o];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Rr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Rr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Wr=new $;class Fo{constructor(e,t,r,o=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=o}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Wr.fromBufferAttribute(this,t),Wr.applyMatrix4(e),this.setXYZ(t,Wr.x,Wr.y,Wr.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Wr.fromBufferAttribute(this,t),Wr.applyNormalMatrix(e),this.setXYZ(t,Wr.x,Wr.y,Wr.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Wr.fromBufferAttribute(this,t),Wr.transformDirection(e),this.setXYZ(t,Wr.x,Wr.y,Wr.z);return this}setX(e,t){return this.normalized&&(t=En(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=En(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=En(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=En(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Hr(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Hr(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Hr(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Hr(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=En(t,this.array),r=En(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,o){return e=e*this.data.stride+this.offset,this.normalized&&(t=En(t,this.array),r=En(r,this.array),o=En(o,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=o,this}setXYZW(e,t,r,o,a){return e=e*this.data.stride+this.offset,this.normalized&&(t=En(t,this.array),r=En(r,this.array),o=En(o,this.array),a=En(a,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=o,this.data.array[e+3]=a,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const o=r*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[o+a])}return new H(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Fo(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const o=r*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[o+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const zf=new $,Kg=new L,Lp=new L,Np=new $,_d=new Ht,cu=new $,Gf=new zr,Jg=new Ht,Wf=new Ps;class g0 extends pr{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ht,this.bindMatrixInverse=new Ht,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Xn),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)cu.fromBufferAttribute(t,r),this.applyBoneTransform(r,cu),this.boundingBox.expandByPoint(cu)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new zr),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)cu.fromBufferAttribute(t,r),this.applyBoneTransform(r,cu),this.boundingSphere.expandByPoint(cu)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const o=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),Gf.copy(this.boundingSphere),Gf.applyMatrix4(o),!1!==e.ray.intersectsSphere(Gf)&&(Jg.copy(o).invert(),Wf.copy(e.ray).applyMatrix4(Jg),(null===this.boundingBox||!1!==Wf.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,Wf)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new L,t=this.geometry.attributes.skinWeight;for(let r=0,o=t.count;r<o;r++){e.fromBufferAttribute(t,r);const a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const r=this.skeleton,o=this.geometry;Kg.fromBufferAttribute(o.attributes.skinIndex,e),Lp.fromBufferAttribute(o.attributes.skinWeight,e),zf.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let a=0;a<4;a++){const u=Lp.getComponent(a);if(0!==u){const f=Kg.getComponent(a);_d.multiplyMatrices(r.bones[f].matrixWorld,r.boneInverses[f]),t.addScaledVector(Np.copy(zf).applyMatrix4(_d),u)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class Op extends sn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class gc extends b{constructor(e=null,t=1,r=1,o,a,u,f,p,m=Zn,v=Zn,y,x){super(null,u,f,p,m,v,o,a,y,x),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Qg=new Ht,lu=new Ht;class vc{constructor(e=[],t=[]){this.uuid=Rr(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,o=this.bones.length;r<o;r++)this.boneInverses.push(new Ht)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const r=new Ht;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,o=this.boneTexture;for(let a=0,u=e.length;a<u;a++)Qg.multiplyMatrices(e[a]?e[a].matrixWorld:lu,t[a]),Qg.toArray(r,16*a);null!==o&&(o.needsUpdate=!0)}clone(){return new vc(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=ef(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new gc(t,e,e,ui,_e);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const o=this.bones[t];if(o.name===e)return o}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,o=e.bones.length;r<o;r++){const a=e.bones[r];let u=t[a];void 0===u&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),u=new Op),this.bones.push(u),this.boneInverses.push((new Ht).fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let o=0,a=t.length;o<a;o++)e.bones.push(t[o].uuid),e.boneInverses.push(r[o].toArray());return e}}class Md extends H{constructor(e,t,r,o=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=o}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const cl=new Ht,ev=new Ht,jf=[],tv=new Xn,nv=new Ht,xd=new pr,ll=new zr;class v0 extends pr{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Md(new Float32Array(16*r),16),this.instanceColor=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let o=0;o<r;o++)this.setMatrixAt(o,nv)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Xn),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,cl),tv.copy(e.boundingBox).applyMatrix4(cl),this.boundingBox.union(tv)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new zr),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,cl),ll.copy(e.boundingSphere).applyMatrix4(cl),this.boundingSphere.union(ll)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const r=this.matrixWorld,o=this.count;if(xd.geometry=this.geometry,xd.material=this.material,void 0!==xd.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),ll.copy(this.boundingSphere),ll.applyMatrix4(r),!1!==e.ray.intersectsSphere(ll)))for(let a=0;a<o;a++){this.getMatrixAt(a,cl),ev.multiplyMatrices(r,cl),xd.matrixWorld=ev,xd.raycast(e,jf);for(let u=0,f=jf.length;u<f;u++){const p=jf[u];p.instanceId=a,p.object=this,t.push(p)}jf.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Md(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class es extends Ms{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new It(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Fp=new $,iv=new $,rv=new Ht,$f=new Ps,Xf=new zr;class yc extends sn{constructor(e=new Bn,t=new es){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,r=[0];for(let o=1,a=t.count;o<a;o++)Fp.fromBufferAttribute(t,o-1),iv.fromBufferAttribute(t,o),r[o]=r[o-1],r[o]+=Fp.distanceTo(iv);e.setAttribute("lineDistance",new Ot(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,o=this.matrixWorld,a=e.params.Line.threshold,u=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),Xf.copy(r.boundingSphere),Xf.applyMatrix4(o),Xf.radius+=a,!1===e.ray.intersectsSphere(Xf))return;rv.copy(o).invert(),$f.copy(e.ray).applyMatrix4(rv);const f=a/((this.scale.x+this.scale.y+this.scale.z)/3),p=f*f,m=new $,v=new $,y=new $,x=new $,w=this.isLineSegments?2:1,D=r.index,I=r.attributes.position;if(null!==D)for(let O=Math.max(0,u.start),B=Math.min(D.count,u.start+u.count)-1;O<B;O+=w){const W=D.getX(O),Y=D.getX(O+1);if(m.fromBufferAttribute(I,W),v.fromBufferAttribute(I,Y),$f.distanceSqToSegment(m,v,x,y)>p)continue;x.applyMatrix4(this.matrixWorld);const ee=e.ray.origin.distanceTo(x);ee<e.near||ee>e.far||t.push({distance:ee,point:y.clone().applyMatrix4(this.matrixWorld),index:O,face:null,faceIndex:null,object:this})}else for(let O=Math.max(0,u.start),B=Math.min(I.count,u.start+u.count)-1;O<B;O+=w){if(m.fromBufferAttribute(I,O),v.fromBufferAttribute(I,O+1),$f.distanceSqToSegment(m,v,x,y)>p)continue;x.applyMatrix4(this.matrixWorld);const Y=e.ray.origin.distanceTo(x);Y<e.near||Y>e.far||t.push({distance:Y,point:y.clone().applyMatrix4(this.matrixWorld),index:O,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const o=t[r[0]];if(void 0!==o){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,u=o.length;a<u;a++){const f=o[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=a}}}}}const sv=new $,ov=new $;class av extends yc{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,r=[];for(let o=0,a=t.count;o<a;o+=2)sv.fromBufferAttribute(t,o),ov.fromBufferAttribute(t,o+1),r[o]=0===o?0:r[o-1],r[o+1]=r[o]+sv.distanceTo(ov);e.setAttribute("lineDistance",new Ot(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Up extends yc{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Yf extends Ms{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new It(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const so=new Ht,Ed=new Ps,qf=new zr,kp=new $;class cv extends sn{constructor(e=new Bn,t=new Yf){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,o=this.matrixWorld,a=e.params.Points.threshold,u=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),qf.copy(r.boundingSphere),qf.applyMatrix4(o),qf.radius+=a,!1===e.ray.intersectsSphere(qf))return;so.copy(o).invert(),Ed.copy(e.ray).applyMatrix4(so);const f=a/((this.scale.x+this.scale.y+this.scale.z)/3),p=f*f,m=r.index,y=r.attributes.position;if(null!==m)for(let D=Math.max(0,u.start),N=Math.min(m.count,u.start+u.count);D<N;D++){const I=m.getX(D);kp.fromBufferAttribute(y,I),Zf(kp,I,p,o,e,t,this)}else for(let D=Math.max(0,u.start),N=Math.min(y.count,u.start+u.count);D<N;D++)kp.fromBufferAttribute(y,D),Zf(kp,D,p,o,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const o=t[r[0]];if(void 0!==o){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,u=o.length;a<u;a++){const f=o[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=a}}}}}function Zf(l,e,t,r,o,a,u){const f=Ed.distanceSqToPoint(l);if(f<t){const p=new $;Ed.closestPointToPoint(l,p),p.applyMatrix4(r);const m=o.ray.origin.distanceTo(p);if(m<o.near||m>o.far)return;a.push({distance:m,distanceToRay:Math.sqrt(f),point:p,index:e,face:null,object:u})}}class mh extends Ms{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new It(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new It(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Re(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class pa extends mh{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Re(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Vi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new It(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new It(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new It(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}function Bs(l,e,t){return vh(l)?new l.constructor(l.subarray(e,void 0!==t?t:l.length)):l.slice(e,t)}function Mc(l,e,t){return!l||!t&&l.constructor===e?l:"number"==typeof e.BYTES_PER_ELEMENT?new e(l):Array.prototype.slice.call(l)}function vh(l){return ArrayBuffer.isView(l)&&!(l instanceof DataView)}function rm(l){const t=l.length,r=new Array(t);for(let o=0;o!==t;++o)r[o]=o;return r.sort(function e(o,a){return l[o]-l[a]}),r}function Pd(l,e,t){const r=l.length,o=new l.constructor(r);for(let a=0,u=0;u!==r;++a){const f=t[a]*e;for(let p=0;p!==e;++p)o[u++]=l[f+p]}return o}function ko(l,e,t,r){let o=1,a=l[0];for(;void 0!==a&&void 0===a[r];)a=l[o++];if(void 0===a)return;let u=a[r];if(void 0!==u)if(Array.isArray(u))do{u=a[r],void 0!==u&&(e.push(a.time),t.push.apply(t,u)),a=l[o++]}while(void 0!==a);else if(void 0!==u.toArray)do{u=a[r],void 0!==u&&(e.push(a.time),u.toArray(t,t.length)),a=l[o++]}while(void 0!==a);else do{u=a[r],void 0!==u&&(e.push(a.time),t.push(u)),a=l[o++]}while(void 0!==a)}class Ld{constructor(e,t,r,o){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==o?o:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,o=t[r],a=t[r-1];e:{t:{let u;n:{i:if(!(e<o)){for(let f=r+2;;){if(void 0===o){if(e<a)break i;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===f)break;if(a=o,o=t[++r],e<o)break t}u=t.length;break n}if(e>=a)break e;{const f=t[1];e<f&&(r=2,a=f);for(let p=r-2;;){if(void 0===a)return this._cachedIndex=0,this.copySampleValue_(0);if(r===p)break;if(o=a,a=t[--r-1],e>=a)break t}u=r,r=0}}for(;r<u;){const f=r+u>>>1;e<t[f]?u=f:r=f+1}if(o=t[r],a=t[r-1],void 0===a)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===o)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,a,o)}return this.interpolate_(r,a,e,o)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,o=this.valueSize,a=e*o;for(let u=0;u!==o;++u)t[u]=r[a+u];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Rv extends Ld{constructor(e,t,r,o){super(e,t,r,o),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,r){const o=this.parameterPositions;let a=e-2,u=e+1,f=o[a],p=o[u];if(void 0===f)switch(this.getSettings_().endingStart){case 2401:a=e,f=2*t-r;break;case 2402:a=o.length-2,f=t+o[a]-o[a+1];break;default:a=e,f=r}if(void 0===p)switch(this.getSettings_().endingEnd){case 2401:u=e,p=2*r-t;break;case 2402:u=1,p=r+o[1]-o[0];break;default:u=e-1,p=t}const m=.5*(r-t),v=this.valueSize;this._weightPrev=m/(t-f),this._weightNext=m/(p-r),this._offsetPrev=a*v,this._offsetNext=u*v}interpolate_(e,t,r,o){const a=this.resultBuffer,u=this.sampleValues,f=this.valueSize,p=e*f,m=p-f,v=this._offsetPrev,y=this._offsetNext,x=this._weightPrev,w=this._weightNext,D=(r-t)/(o-t),N=D*D,I=N*D,A=-x*I+2*x*N-x*D,k=(1+x)*I+(-1.5-2*x)*N+(-.5+x)*D+1,O=(-1-w)*I+(1.5+w)*N+.5*D,B=w*I-w*N;for(let W=0;W!==f;++W)a[W]=A*u[v+W]+k*u[m+W]+O*u[p+W]+B*u[y+W];return a}}class Pv extends Ld{constructor(e,t,r,o){super(e,t,r,o)}interpolate_(e,t,r,o){const a=this.resultBuffer,u=this.sampleValues,f=this.valueSize,p=e*f,m=p-f,v=(r-t)/(o-t),y=1-v;for(let x=0;x!==f;++x)a[x]=u[m+x]*y+u[p+x]*v;return a}}class yh extends Ld{constructor(e,t,r,o){super(e,t,r,o)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ss{constructor(e,t,r,o){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Mc(t,this.TimeBufferType),this.values=Mc(r,this.ValueBufferType),this.setInterpolation(o||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:Mc(e.times,Array),values:Mc(e.values,Array)};const o=e.getInterpolation();o!==e.DefaultInterpolation&&(r.interpolation=o)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new yh(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Pv(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Rv(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Ds:t=this.InterpolantFactoryMethodDiscrete;break;case qr:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(r);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ds;case this.InterpolantFactoryMethodLinear:return qr;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let r=0,o=t.length;r!==o;++r)t[r]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let r=0,o=t.length;r!==o;++r)t[r]*=e}return this}trim(e,t){const r=this.times,o=r.length;let a=0,u=o-1;for(;a!==o&&r[a]<e;)++a;for(;-1!==u&&r[u]>t;)--u;if(++u,0!==a||u!==o){a>=u&&(u=Math.max(u,1),a=u-1);const f=this.getValueSize();this.times=Bs(r,a,u),this.values=Bs(this.values,a*f,u*f)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,o=this.values,a=r.length;0===a&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let u=null;for(let f=0;f!==a;f++){const p=r[f];if("number"==typeof p&&isNaN(p)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,f,p),e=!1;break}if(null!==u&&u>p){console.error("THREE.KeyframeTrack: Out of order keys.",this,f,p,u),e=!1;break}u=p}if(void 0!==o&&vh(o))for(let f=0,p=o.length;f!==p;++f){const m=o[f];if(isNaN(m)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,f,m),e=!1;break}}return e}optimize(){const e=Bs(this.times),t=Bs(this.values),r=this.getValueSize(),o=2302===this.getInterpolation(),a=e.length-1;let u=1;for(let f=1;f<a;++f){let p=!1;const m=e[f];if(m!==e[f+1]&&(1!==f||m!==e[0]))if(o)p=!0;else{const y=f*r,x=y-r,w=y+r;for(let D=0;D!==r;++D){const N=t[y+D];if(N!==t[x+D]||N!==t[w+D]){p=!0;break}}}if(p){if(f!==u){e[u]=e[f];const y=f*r,x=u*r;for(let w=0;w!==r;++w)t[x+w]=t[y+w]}++u}}if(a>0){e[u]=e[a];for(let f=a*r,p=u*r,m=0;m!==r;++m)t[p+m]=t[f+m];++u}return u!==e.length?(this.times=Bs(e,0,u),this.values=Bs(t,0,u*r)):(this.times=e,this.values=t),this}clone(){const e=Bs(this.times,0),t=Bs(this.values,0),o=new(0,this.constructor)(this.name,e,t);return o.createInterpolant=this.createInterpolant,o}}Ss.prototype.TimeBufferType=Float32Array,Ss.prototype.ValueBufferType=Float32Array,Ss.prototype.DefaultInterpolation=qr;class hl extends Ss{}hl.prototype.ValueTypeName="bool",hl.prototype.ValueBufferType=Array,hl.prototype.DefaultInterpolation=Ds,hl.prototype.InterpolantFactoryMethodLinear=void 0,hl.prototype.InterpolantFactoryMethodSmooth=void 0;class Nd extends Ss{}Nd.prototype.ValueTypeName="color";class Od extends Ss{}Od.prototype.ValueTypeName="number";class P0 extends Ld{constructor(e,t,r,o){super(e,t,r,o)}interpolate_(e,t,r,o){const a=this.resultBuffer,u=this.sampleValues,f=this.valueSize,p=(r-t)/(o-t);let m=e*f;for(let v=m+f;m!==v;m+=4)pn.slerpFlat(a,0,u,m-f,u,m,p);return a}}class xc extends Ss{InterpolantFactoryMethodLinear(e){return new P0(this.times,this.values,this.getValueSize(),e)}}xc.prototype.ValueTypeName="quaternion",xc.prototype.DefaultInterpolation=qr,xc.prototype.InterpolantFactoryMethodSmooth=void 0;class pl extends Ss{}pl.prototype.ValueTypeName="string",pl.prototype.ValueBufferType=Array,pl.prototype.DefaultInterpolation=Ds,pl.prototype.InterpolantFactoryMethodLinear=void 0,pl.prototype.InterpolantFactoryMethodSmooth=void 0;class yu extends Ss{}yu.prototype.ValueTypeName="vector";class Fd{constructor(e,t=-1,r,o=2500){this.name=e,this.tracks=r,this.duration=t,this.blendMode=o,this.uuid=Rr(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,o=1/(e.fps||1);for(let u=0,f=r.length;u!==f;++u)t.push(Nv(r[u]).scale(o));const a=new this(e.name,e.duration,t,e.blendMode);return a.uuid=e.uuid,a}static toJSON(e){const t=[],r=e.tracks,o={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let a=0,u=r.length;a!==u;++a)t.push(Ss.toJSON(r[a]));return o}static CreateFromMorphTargetSequence(e,t,r,o){const a=t.length,u=[];for(let f=0;f<a;f++){let p=[],m=[];p.push((f+a-1)%a,f,(f+1)%a),m.push(0,1,0);const v=rm(p);p=Pd(p,1,v),m=Pd(m,1,v),!o&&0===p[0]&&(p.push(a),m.push(m[0])),u.push(new Od(".morphTargetInfluences["+t[f].name+"]",p,m).scale(1/r))}return new this(e,-1,u)}static findByName(e,t){let r=e;Array.isArray(e)||(r=e.geometry&&e.geometry.animations||e.animations);for(let o=0;o<r.length;o++)if(r[o].name===t)return r[o];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const o={},a=/^([\w-]*?)([\d]+)$/;for(let f=0,p=e.length;f<p;f++){const m=e[f],v=m.name.match(a);if(v&&v.length>1){const y=v[1];let x=o[y];x||(o[y]=x=[]),x.push(m)}}const u=[];for(const f in o)u.push(this.CreateFromMorphTargetSequence(f,o[f],t,r));return u}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(y,x,w,D,N){if(0!==w.length){const I=[],A=[];ko(w,I,A,D),0!==I.length&&N.push(new y(x,I,A))}},o=[],a=e.name||"default",u=e.fps||30,f=e.blendMode;let p=e.length||-1;const m=e.hierarchy||[];for(let y=0;y<m.length;y++){const x=m[y].keys;if(x&&0!==x.length)if(x[0].morphTargets){const w={};let D;for(D=0;D<x.length;D++)if(x[D].morphTargets)for(let N=0;N<x[D].morphTargets.length;N++)w[x[D].morphTargets[N]]=-1;for(const N in w){const I=[],A=[];for(let k=0;k!==x[D].morphTargets.length;++k){const O=x[D];I.push(O.time),A.push(O.morphTarget===N?1:0)}o.push(new Od(".morphTargetInfluence["+N+"]",I,A))}p=w.length*u}else{const w=".bones["+t[y].name+"]";r(yu,w+".position",x,"pos",o),r(xc,w+".quaternion",x,"rot",o),r(yu,w+".scale",x,"scl",o)}}return 0===o.length?null:new this(a,p,o,f)}resetDuration(){let t=0;for(let r=0,o=this.tracks.length;r!==o;++r){const a=this.tracks[r];t=Math.max(t,a.times[a.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Nv(l){if(void 0===l.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function Lv(l){switch(l.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Od;case"vector":case"vector2":case"vector3":case"vector4":return yu;case"color":return Nd;case"quaternion":return xc;case"bool":case"boolean":return hl;case"string":return pl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+l)}(l.type);if(void 0===l.times){const t=[],r=[];ko(l.keys,t,r,"value"),l.times=t,l.values=r}return void 0!==e.parse?e.parse(l):new e(l.name,l.times,l.values,l.interpolation)}const ma={enabled:!1,files:{},add:function(l,e){!1!==this.enabled&&(this.files[l]=e)},get:function(l){if(!1!==this.enabled)return this.files[l]},remove:function(l){delete this.files[l]},clear:function(){this.files={}}};class Ov{constructor(e,t,r){const o=this;let p,a=!1,u=0,f=0;const m=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(v){f++,!1===a&&void 0!==o.onStart&&o.onStart(v,u,f),a=!0},this.itemEnd=function(v){u++,void 0!==o.onProgress&&o.onProgress(v,u,f),u===f&&(a=!1,void 0!==o.onLoad&&o.onLoad())},this.itemError=function(v){void 0!==o.onError&&o.onError(v)},this.resolveURL=function(v){return p?p(v):v},this.setURLModifier=function(v){return p=v,this},this.addHandler=function(v,y){return m.push(v,y),this},this.removeHandler=function(v){const y=m.indexOf(v);return-1!==y&&m.splice(y,2),this},this.getHandler=function(v){for(let y=0,x=m.length;y<x;y+=2){const w=m[y],D=m[y+1];if(w.global&&(w.lastIndex=0),w.test(v))return D}return null}}}const Fv=new Ov;let _u=(()=>{class l{constructor(t){this.manager=void 0!==t?t:Fv,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,r){const o=this;return new Promise(function(a,u){o.load(t,a,r,u)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return l.DEFAULT_MATERIAL_NAME="__DEFAULT",l})();const Wa={};class L0 extends Error{constructor(e,t){super(e),this.response=t}}class bs extends _u{constructor(e){super(e)}load(e,t,r,o){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const a=ma.get(e);if(void 0!==a)return this.manager.itemStart(e),setTimeout(()=>{t&&t(a),this.manager.itemEnd(e)},0),a;if(void 0!==Wa[e])return void Wa[e].push({onLoad:t,onProgress:r,onError:o});Wa[e]=[],Wa[e].push({onLoad:t,onProgress:r,onError:o});const u=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),f=this.mimeType,p=this.responseType;fetch(u).then(m=>{if(200===m.status||0===m.status){if(0===m.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===m.body||void 0===m.body.getReader)return m;const v=Wa[e],y=m.body.getReader(),x=m.headers.get("Content-Length")||m.headers.get("X-File-Size"),w=x?parseInt(x):0,D=0!==w;let N=0;const I=new ReadableStream({start(A){!function k(){y.read().then(({done:O,value:B})=>{if(O)A.close();else{N+=B.byteLength;const W=new ProgressEvent("progress",{lengthComputable:D,loaded:N,total:w});for(let Y=0,q=v.length;Y<q;Y++){const ee=v[Y];ee.onProgress&&ee.onProgress(W)}A.enqueue(B),k()}})}()}});return new Response(I)}throw new L0(`fetch for "${m.url}" responded with ${m.status}: ${m.statusText}`,m)}).then(m=>{switch(p){case"arraybuffer":return m.arrayBuffer();case"blob":return m.blob();case"document":return m.text().then(v=>(new DOMParser).parseFromString(v,f));case"json":return m.json();default:if(void 0===f)return m.text();{const y=/charset="?([^;"\s]*)"?/i.exec(f),x=y&&y[1]?y[1].toLowerCase():void 0,w=new TextDecoder(x);return m.arrayBuffer().then(D=>w.decode(D))}}}).then(m=>{ma.add(e,m);const v=Wa[e];delete Wa[e];for(let y=0,x=v.length;y<x;y++){const w=v[y];w.onLoad&&w.onLoad(m)}}).catch(m=>{const v=Wa[e];if(void 0===v)throw this.manager.itemError(e),m;delete Wa[e];for(let y=0,x=v.length;y<x;y++){const w=v[y];w.onError&&w.onError(m)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class _h extends _u{constructor(e){super(e)}load(e,t,r,o){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,u=ma.get(e);if(void 0!==u)return a.manager.itemStart(e),setTimeout(function(){t&&t(u),a.manager.itemEnd(e)},0),u;const f=_r("img");function p(){v(),ma.add(e,this),t&&t(this),a.manager.itemEnd(e)}function m(y){v(),o&&o(y),a.manager.itemError(e),a.manager.itemEnd(e)}function v(){f.removeEventListener("load",p,!1),f.removeEventListener("error",m,!1)}return f.addEventListener("load",p,!1),f.addEventListener("error",m,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(f.crossOrigin=this.crossOrigin),a.manager.itemStart(e),f.src=e,f}}class N0 extends _u{constructor(e){super(e)}load(e,t,r,o){const a=new b,u=new _h(this.manager);return u.setCrossOrigin(this.crossOrigin),u.setPath(this.path),u.load(e,function(f){a.image=f,a.needsUpdate=!0,void 0!==t&&t(a)},r,o),a}}class sm extends sn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new It(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const Mh=new Ht,om=new $,Uv=new $;class Mu{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Re(512,512),this.map=null,this.mapPass=null,this.matrix=new Ht,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new df,this._frameExtents=new Re(1,1),this._viewportCount=1,this._viewports=[new L(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;om.setFromMatrixPosition(e.matrixWorld),t.position.copy(om),Uv.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Uv),t.updateMatrixWorld(),Mh.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Mh),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(Mh)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class F0 extends Mu{constructor(){super(new xr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,r=2*Gn*e.angle*this.focus,o=this.mapSize.width/this.mapSize.height,a=e.distance||t.far;(r!==t.fov||o!==t.aspect||a!==t.far)&&(t.fov=r,t.aspect=o,t.far=a,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class kv extends sm{constructor(e,t,r=0,o=Math.PI/3,a=0,u=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(sn.DEFAULT_UP),this.updateMatrix(),this.target=new sn,this.distance=r,this.angle=o,this.penumbra=a,this.decay=u,this.map=null,this.shadow=new F0}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const Bv=new Ht,Ud=new $,am=new $;class U0 extends Mu{constructor(){super(new xr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Re(4,2),this._viewportCount=6,this._viewports=[new L(2,1,1,1),new L(0,1,1,1),new L(3,1,1,1),new L(1,1,1,1),new L(3,0,1,1),new L(1,0,1,1)],this._cubeDirections=[new $(1,0,0),new $(-1,0,0),new $(0,0,1),new $(0,0,-1),new $(0,1,0),new $(0,-1,0)],this._cubeUps=[new $(0,1,0),new $(0,1,0),new $(0,1,0),new $(0,1,0),new $(0,0,1),new $(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,o=this.matrix,a=e.distance||r.far;a!==r.far&&(r.far=a,r.updateProjectionMatrix()),Ud.setFromMatrixPosition(e.matrixWorld),r.position.copy(Ud),am.copy(r.position),am.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(am),r.updateMatrixWorld(),o.makeTranslation(-Ud.x,-Ud.y,-Ud.z),Bv.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Bv)}}class Hv extends sm{constructor(e,t,r=0,o=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=o,this.shadow=new U0}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Vv extends Mu{constructor(){super(new tl(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class xh extends sm{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(sn.DEFAULT_UP),this.updateMatrix(),this.target=new sn,this.shadow=new Vv}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Ec{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let r=0,o=e.length;r<o;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class ts extends _u{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,o){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,u=ma.get(e);if(void 0!==u)return a.manager.itemStart(e),setTimeout(function(){t&&t(u),a.manager.itemEnd(e)},0),u;const f={};f.credentials="anonymous"===this.crossOrigin?"same-origin":"include",f.headers=this.requestHeader,fetch(e,f).then(function(p){return p.blob()}).then(function(p){return createImageBitmap(p,Object.assign(a.options,{colorSpaceConversion:"none"}))}).then(function(p){ma.add(e,p),t&&t(p),a.manager.itemEnd(e)}).catch(function(p){o&&o(p),a.manager.itemError(e),a.manager.itemEnd(e)}),a.manager.itemStart(e)}}const Zv="\\[\\]\\.:\\/",pE=new RegExp("["+Zv+"]","g"),lm="[^"+Zv+"]",$0="[^"+Zv.replace("\\.","")+"]",q0=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",lm)+/(WCOD+)?/.source.replace("WCOD",$0)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",lm)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",lm)+"$"),Z0=["material","materials","bones","map"];class um{constructor(e,t,r){const o=r||yi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,o)}getValue(e,t){this.bind();const o=this._bindings[this._targetGroup.nCachedObjects_];void 0!==o&&o.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let o=this._targetGroup.nCachedObjects_,a=r.length;o!==a;++o)r[o].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}let yi=(()=>{class l{constructor(t,r,o){this.path=r,this.parsedPath=o||l.parseTrackName(r),this.node=l.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,r,o){return t&&t.isAnimationObjectGroup?new l.Composite(t,r,o):new l(t,r,o)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(pE,"")}static parseTrackName(t){const r=q0.exec(t);if(null===r)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const o={nodeName:r[2],objectName:r[3],objectIndex:r[4],propertyName:r[5],propertyIndex:r[6]},a=o.nodeName&&o.nodeName.lastIndexOf(".");if(void 0!==a&&-1!==a){const u=o.nodeName.substring(a+1);-1!==Z0.indexOf(u)&&(o.nodeName=o.nodeName.substring(0,a),o.objectName=u)}if(null===o.propertyName||0===o.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return o}static findNode(t,r){if(void 0===r||""===r||"."===r||-1===r||r===t.name||r===t.uuid)return t;if(t.skeleton){const o=t.skeleton.getBoneByName(r);if(void 0!==o)return o}if(t.children){const o=function(u){for(let f=0;f<u.length;f++){const p=u[f];if(p.name===r||p.uuid===r)return p;const m=o(p.children);if(m)return m}return null},a=o(t.children);if(a)return a}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,r){t[r]=this.targetObject[this.propertyName]}_getValue_array(t,r){const o=this.resolvedProperty;for(let a=0,u=o.length;a!==u;++a)t[r++]=o[a]}_getValue_arrayElement(t,r){t[r]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,r){this.resolvedProperty.toArray(t,r)}_setValue_direct(t,r){this.targetObject[this.propertyName]=t[r]}_setValue_direct_setNeedsUpdate(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,r){const o=this.resolvedProperty;for(let a=0,u=o.length;a!==u;++a)o[a]=t[r++]}_setValue_array_setNeedsUpdate(t,r){const o=this.resolvedProperty;for(let a=0,u=o.length;a!==u;++a)o[a]=t[r++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,r){const o=this.resolvedProperty;for(let a=0,u=o.length;a!==u;++a)o[a]=t[r++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,r){this.resolvedProperty[this.propertyIndex]=t[r]}_setValue_arrayElement_setNeedsUpdate(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,r){this.resolvedProperty.fromArray(t,r)}_setValue_fromArray_setNeedsUpdate(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,r){this.bind(),this.getValue(t,r)}_setValue_unbound(t,r){this.bind(),this.setValue(t,r)}bind(){let t=this.node;const r=this.parsedPath,o=r.objectName,a=r.propertyName;let u=r.propertyIndex;if(t||(t=l.findNode(this.rootNode,r.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(o){let v=r.objectIndex;switch(o){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let y=0;y<t.length;y++)if(t[y].name===v){v=y;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[o])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[o]}if(void 0!==v){if(void 0===t[v])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[v]}}const f=t[a];if(void 0===f)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+r.nodeName+"."+a+" but it wasn't found.",t);let p=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?p=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(p=this.Versioning.MatrixWorldNeedsUpdate);let m=this.BindingType.Direct;if(void 0!==u){if("morphTargetInfluences"===a){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[u]&&(u=t.morphTargetDictionary[u])}m=this.BindingType.ArrayElement,this.resolvedProperty=f,this.propertyIndex=u}else void 0!==f.fromArray&&void 0!==f.toArray?(m=this.BindingType.HasFromToArray,this.resolvedProperty=f):Array.isArray(f)?(m=this.BindingType.EntireArray,this.resolvedProperty=f):this.propertyName=a;this.getValue=this.GetterByBindingType[m],this.setValue=this.SetterByBindingTypeAndVersioning[m][p]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return l.Composite=um,l})();yi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},yi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},yi.prototype.GetterByBindingType=[yi.prototype._getValue_direct,yi.prototype._getValue_array,yi.prototype._getValue_arrayElement,yi.prototype._getValue_toArray],yi.prototype.SetterByBindingTypeAndVersioning=[[yi.prototype._setValue_direct,yi.prototype._setValue_direct_setNeedsUpdate,yi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[yi.prototype._setValue_array,yi.prototype._setValue_array_setNeedsUpdate,yi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[yi.prototype._setValue_arrayElement,yi.prototype._setValue_arrayElement_setNeedsUpdate,yi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[yi.prototype._setValue_fromArray,yi.prototype._setValue_fromArray_setNeedsUpdate,yi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class zd{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(Vi(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}function vm(l,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),l;if(2===e||1===e){let t=l.getIndex();if(null===t){const u=[],f=l.getAttribute("position");if(void 0===f)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),l;for(let p=0;p<f.count;p++)u.push(p);l.setIndex(u),t=l.getIndex()}const r=t.count-2,o=[];if(2===e)for(let u=1;u<=r;u++)o.push(t.getX(0)),o.push(t.getX(u)),o.push(t.getX(u+1));else for(let u=0;u<r;u++)u%2==0?(o.push(t.getX(u)),o.push(t.getX(u+1)),o.push(t.getX(u+2))):(o.push(t.getX(u+2)),o.push(t.getX(u+1)),o.push(t.getX(u)));o.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const a=l.clone();return a.setIndex(o),a.clearGroups(),a}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),l}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"156"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="156");class ly extends _u{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new ym(t)}),this.register(function(t){return new pM(t)}),this.register(function(t){return new dy(t)}),this.register(function(t){return new mM(t)}),this.register(function(t){return new _m(t)}),this.register(function(t){return new fM(t)}),this.register(function(t){return new Mm(t)}),this.register(function(t){return new PE(t)}),this.register(function(t){return new dM(t)}),this.register(function(t){return new LE(t)}),this.register(function(t){return new _l(t)}),this.register(function(t){return new hM(t)}),this.register(function(t){return new Ac(t)}),this.register(function(t){return new wr(t)}),this.register(function(t){return new fy(t)})}load(e,t,r,o){const a=this;let u;u=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:Ec.extractUrlBase(e),this.manager.itemStart(e);const f=function(m){o?o(m):console.error(m),a.manager.itemError(e),a.manager.itemEnd(e)},p=new bs(this.manager);p.setPath(this.path),p.setResponseType("arraybuffer"),p.setRequestHeader(this.requestHeader),p.setWithCredentials(this.withCredentials),p.load(e,function(m){try{a.parse(m,u,function(v){t(v),a.manager.itemEnd(e)},f)}catch(v){f(v)}},r,f)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,o){let a;const u={},f={},p=new TextDecoder;if("string"==typeof e)a=JSON.parse(e);else if(e instanceof ArrayBuffer)if(p.decode(new Uint8Array(e,0,4))===hy){try{u[Yn.KHR_BINARY_GLTF]=new gM(e)}catch(y){return void(o&&o(y))}a=JSON.parse(u[Yn.KHR_BINARY_GLTF].content)}else a=JSON.parse(p.decode(e));else a=e;if(void 0===a.asset||a.asset.version[0]<2)return void(o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const m=new EM(a,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});m.fileLoader.setRequestHeader(this.requestHeader);for(let v=0;v<this.pluginCallbacks.length;v++){const y=this.pluginCallbacks[v](m);f[y.name]=y,u[y.name]=!0}if(a.extensionsUsed)for(let v=0;v<a.extensionsUsed.length;++v){const y=a.extensionsUsed[v],x=a.extensionsRequired||[];switch(y){case Yn.KHR_MATERIALS_UNLIT:u[y]=new uM;break;case Yn.KHR_DRACO_MESH_COMPRESSION:u[y]=new py(a,this.dracoLoader);break;case Yn.KHR_TEXTURE_TRANSFORM:u[y]=new my;break;case Yn.KHR_MESH_QUANTIZATION:u[y]=new Tu;break;default:x.indexOf(y)>=0&&void 0===f[y]&&console.warn('THREE.GLTFLoader: Unknown extension "'+y+'".')}}m.setExtensions(u),m.setPlugins(f),m.parse(r,o)}parseAsync(e,t){const r=this;return new Promise(function(o,a){r.parse(e,t,o,a)})}}function uy(){let l={};return{get:function(e){return l[e]},add:function(e,t){l[e]=t},remove:function(e){delete l[e]},removeAll:function(){l={}}}}const Yn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Ac{constructor(e){this.parser=e,this.name=Yn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let r=0,o=t.length;r<o;r++){const a=t[r];a.extensions&&a.extensions[this.name]&&void 0!==a.extensions[this.name].light&&e._addNodeRef(this.cache,a.extensions[this.name].light)}}_loadLight(e){const t=this.parser,r="light:"+e;let o=t.cache.get(r);if(o)return o;const a=t.json,p=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e];let m;const v=new It(16777215);void 0!==p.color&&v.setRGB(p.color[0],p.color[1],p.color[2],Oi);const y=void 0!==p.range?p.range:0;switch(p.type){case"directional":m=new xh(v),m.target.position.set(0,0,-1),m.add(m.target);break;case"point":m=new Hv(v),m.distance=y;break;case"spot":m=new kv(v),m.distance=y,p.spot=p.spot||{},p.spot.innerConeAngle=void 0!==p.spot.innerConeAngle?p.spot.innerConeAngle:0,p.spot.outerConeAngle=void 0!==p.spot.outerConeAngle?p.spot.outerConeAngle:Math.PI/4,m.angle=p.spot.outerConeAngle,m.penumbra=1-p.spot.innerConeAngle/p.spot.outerConeAngle,m.target.position.set(0,0,-1),m.add(m.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+p.type)}return m.position.set(0,0,0),m.decay=2,ja(m,p),void 0!==p.intensity&&(m.intensity=p.intensity),m.name=t.createUniqueName(p.name||"light_"+e),o=Promise.resolve(m),t.cache.add(r,o),o}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,r=this.parser,a=r.json.nodes[e],f=(a.extensions&&a.extensions[this.name]||{}).light;return void 0===f?null:this._loadLight(f).then(function(p){return r._getNodeRef(t.cache,f,p)})}}class uM{constructor(){this.name=Yn.KHR_MATERIALS_UNLIT}getMaterialType(){return cs}extendParams(e,t,r){const o=[];e.color=new It(1,1,1),e.opacity=1;const a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){const u=a.baseColorFactor;e.color.setRGB(u[0],u[1],u[2],Oi),e.opacity=u[3]}void 0!==a.baseColorTexture&&o.push(r.assignTexture(e,"map",a.baseColorTexture,_n))}return Promise.all(o)}}class dM{constructor(e){this.parser=e,this.name=Yn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=o.extensions[this.name].emissiveStrength;return void 0!==a&&(t.emissiveIntensity=a),Promise.resolve()}}class ym{constructor(e){this.parser=e,this.name=Yn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?pa:null}extendMaterialParams(e,t){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=[],u=o.extensions[this.name];if(void 0!==u.clearcoatFactor&&(t.clearcoat=u.clearcoatFactor),void 0!==u.clearcoatTexture&&a.push(r.assignTexture(t,"clearcoatMap",u.clearcoatTexture)),void 0!==u.clearcoatRoughnessFactor&&(t.clearcoatRoughness=u.clearcoatRoughnessFactor),void 0!==u.clearcoatRoughnessTexture&&a.push(r.assignTexture(t,"clearcoatRoughnessMap",u.clearcoatRoughnessTexture)),void 0!==u.clearcoatNormalTexture&&(a.push(r.assignTexture(t,"clearcoatNormalMap",u.clearcoatNormalTexture)),void 0!==u.clearcoatNormalTexture.scale)){const f=u.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Re(f,f)}return Promise.all(a)}}class _l{constructor(e){this.parser=e,this.name=Yn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?pa:null}extendMaterialParams(e,t){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=[],u=o.extensions[this.name];return void 0!==u.iridescenceFactor&&(t.iridescence=u.iridescenceFactor),void 0!==u.iridescenceTexture&&a.push(r.assignTexture(t,"iridescenceMap",u.iridescenceTexture)),void 0!==u.iridescenceIor&&(t.iridescenceIOR=u.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==u.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=u.iridescenceThicknessMinimum),void 0!==u.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=u.iridescenceThicknessMaximum),void 0!==u.iridescenceThicknessTexture&&a.push(r.assignTexture(t,"iridescenceThicknessMap",u.iridescenceThicknessTexture)),Promise.all(a)}}class _m{constructor(e){this.parser=e,this.name=Yn.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?pa:null}extendMaterialParams(e,t){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=[];t.sheenColor=new It(0,0,0),t.sheenRoughness=0,t.sheen=1;const u=o.extensions[this.name];if(void 0!==u.sheenColorFactor){const f=u.sheenColorFactor;t.sheenColor.setRGB(f[0],f[1],f[2],Oi)}return void 0!==u.sheenRoughnessFactor&&(t.sheenRoughness=u.sheenRoughnessFactor),void 0!==u.sheenColorTexture&&a.push(r.assignTexture(t,"sheenColorMap",u.sheenColorTexture,_n)),void 0!==u.sheenRoughnessTexture&&a.push(r.assignTexture(t,"sheenRoughnessMap",u.sheenRoughnessTexture)),Promise.all(a)}}class fM{constructor(e){this.parser=e,this.name=Yn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?pa:null}extendMaterialParams(e,t){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=[],u=o.extensions[this.name];return void 0!==u.transmissionFactor&&(t.transmission=u.transmissionFactor),void 0!==u.transmissionTexture&&a.push(r.assignTexture(t,"transmissionMap",u.transmissionTexture)),Promise.all(a)}}class Mm{constructor(e){this.parser=e,this.name=Yn.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?pa:null}extendMaterialParams(e,t){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=[],u=o.extensions[this.name];t.thickness=void 0!==u.thicknessFactor?u.thicknessFactor:0,void 0!==u.thicknessTexture&&a.push(r.assignTexture(t,"thicknessMap",u.thicknessTexture)),t.attenuationDistance=u.attenuationDistance||1/0;const f=u.attenuationColor||[1,1,1];return t.attenuationColor=(new It).setRGB(f[0],f[1],f[2],Oi),Promise.all(a)}}class PE{constructor(e){this.parser=e,this.name=Yn.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?pa:null}extendMaterialParams(e,t){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=o.extensions[this.name];return t.ior=void 0!==a.ior?a.ior:1.5,Promise.resolve()}}class LE{constructor(e){this.parser=e,this.name=Yn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?pa:null}extendMaterialParams(e,t){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=[],u=o.extensions[this.name];t.specularIntensity=void 0!==u.specularFactor?u.specularFactor:1,void 0!==u.specularTexture&&a.push(r.assignTexture(t,"specularIntensityMap",u.specularTexture));const f=u.specularColorFactor||[1,1,1];return t.specularColor=(new It).setRGB(f[0],f[1],f[2],Oi),void 0!==u.specularColorTexture&&a.push(r.assignTexture(t,"specularColorMap",u.specularColorTexture,_n)),Promise.all(a)}}class hM{constructor(e){this.parser=e,this.name=Yn.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?pa:null}extendMaterialParams(e,t){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=[],u=o.extensions[this.name];return void 0!==u.anisotropyStrength&&(t.anisotropy=u.anisotropyStrength),void 0!==u.anisotropyRotation&&(t.anisotropyRotation=u.anisotropyRotation),void 0!==u.anisotropyTexture&&a.push(r.assignTexture(t,"anisotropyMap",u.anisotropyTexture)),Promise.all(a)}}class pM{constructor(e){this.parser=e,this.name=Yn.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,r=t.json,o=r.textures[e];if(!o.extensions||!o.extensions[this.name])return null;const a=o.extensions[this.name],u=t.options.ktx2Loader;if(!u){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,a.source,u)}}class dy{constructor(e){this.parser=e,this.name=Yn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,o=r.json,a=o.textures[e];if(!a.extensions||!a.extensions[t])return null;const u=a.extensions[t],f=o.images[u.source];let p=r.textureLoader;if(f.uri){const m=r.options.manager.getHandler(f.uri);null!==m&&(p=m)}return this.detectSupport().then(function(m){if(m)return r.loadTextureImage(e,u.source,p);if(o.extensionsRequired&&o.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class mM{constructor(e){this.parser=e,this.name=Yn.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,o=r.json,a=o.textures[e];if(!a.extensions||!a.extensions[t])return null;const u=a.extensions[t],f=o.images[u.source];let p=r.textureLoader;if(f.uri){const m=r.options.manager.getHandler(f.uri);null!==m&&(p=m)}return this.detectSupport().then(function(m){if(m)return r.loadTextureImage(e,u.source,p);if(o.extensionsRequired&&o.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class wr{constructor(e){this.name=Yn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const o=r.extensions[this.name],a=this.parser.getDependency("buffer",o.buffer),u=this.parser.options.meshoptDecoder;if(!u||!u.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return a.then(function(f){const v=o.count,y=o.byteStride,x=new Uint8Array(f,o.byteOffset||0,o.byteLength||0);return u.decodeGltfBufferAsync?u.decodeGltfBufferAsync(v,y,x,o.mode,o.filter).then(function(w){return w.buffer}):u.ready.then(function(){const w=new ArrayBuffer(v*y);return u.decodeGltfBuffer(new Uint8Array(w),v,y,x,o.mode,o.filter),w})})}return null}}class fy{constructor(e){this.name=Yn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||void 0===r.mesh)return null;const o=t.meshes[r.mesh];for(const m of o.primitives)if(m.mode!==lo.TRIANGLES&&m.mode!==lo.TRIANGLE_STRIP&&m.mode!==lo.TRIANGLE_FAN&&void 0!==m.mode)return null;const u=r.extensions[this.name].attributes,f=[],p={};for(const m in u)f.push(this.parser.getDependency("accessor",u[m]).then(v=>(p[m]=v,p[m])));return f.length<1?null:(f.push(this.parser.createNodeMesh(e)),Promise.all(f).then(m=>{const v=m.pop(),y=v.isGroup?v.children:[v],x=m[0].count,w=[];for(const D of y){const N=new Ht,I=new $,A=new pn,k=new $(1,1,1),O=new v0(D.geometry,D.material,x);for(let B=0;B<x;B++)p.TRANSLATION&&I.fromBufferAttribute(p.TRANSLATION,B),p.ROTATION&&A.fromBufferAttribute(p.ROTATION,B),p.SCALE&&k.fromBufferAttribute(p.SCALE,B),O.setMatrixAt(B,N.compose(I,A,k));for(const B in p)"TRANSLATION"!==B&&"ROTATION"!==B&&"SCALE"!==B&&D.geometry.setAttribute(B,p[B]);sn.prototype.copy.call(O,D),this.parser.assignFinalMaterial(O),w.push(O)}return v.isGroup?(v.clear(),v.add(...w),v):w[0]}))}}const hy="glTF";class gM{constructor(e){this.name=Yn.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),r=new TextDecoder;if(this.header={magic:r.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==hy)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const o=this.header.length-12,a=new DataView(e,12);let u=0;for(;u<o;){const f=a.getUint32(u,!0);u+=4;const p=a.getUint32(u,!0);if(u+=4,1313821514===p){const m=new Uint8Array(e,12+u,f);this.content=r.decode(m)}else if(5130562===p){const m=12+u;this.body=e.slice(m,m+f)}u+=f}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class py{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Yn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const r=this.json,o=this.dracoLoader,a=e.extensions[this.name].bufferView,u=e.extensions[this.name].attributes,f={},p={},m={};for(const v in u){const y=uo[v]||v.toLowerCase();f[y]=u[v]}for(const v in e.attributes){const y=uo[v]||v.toLowerCase();if(void 0!==u[v]){const x=r.accessors[e.attributes[v]];m[y]=Ml[x.componentType].name,p[y]=!0===x.normalized}}return t.getDependency("bufferView",a).then(function(v){return new Promise(function(y){o.decodeDracoFile(v,function(x){for(const w in x.attributes){const N=p[w];void 0!==N&&(x.attributes[w].normalized=N)}y(x)},f,m)})})}}class my{constructor(){this.name=Yn.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Tu{constructor(){this.name=Yn.KHR_MESH_QUANTIZATION}}class gy extends Ld{constructor(e,t,r,o){super(e,t,r,o)}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,o=this.valueSize,a=e*o*3+o;for(let u=0;u!==o;u++)t[u]=r[a+u];return t}interpolate_(e,t,r,o){const a=this.resultBuffer,u=this.sampleValues,f=this.valueSize,p=2*f,m=3*f,v=o-t,y=(r-t)/v,x=y*y,w=x*y,D=e*m,N=D-m,I=-2*w+3*x,A=w-x,k=1-I,O=A-x+y;for(let B=0;B!==f;B++)a[B]=k*u[N+B+f]+O*(u[N+B+p]*v)+I*u[D+B+f]+A*(u[D+B]*v);return a}}const vM=new pn;class vy extends gy{interpolate_(e,t,r,o){const a=super.interpolate_(e,t,r,o);return vM.fromArray(a).normalize().toArray(a),a}}const lo={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Ml={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},yM={9728:Zn,9729:Mi,9984:1004,9985:1007,9986:1005,9987:Or},Em={33071:Mt,33648:1002,10497:er},Rh={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},uo={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Cc={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},_M={CUBICSPLINE:void 0,LINEAR:qr,STEP:Ds};function $r(l,e,t){for(const r in t.extensions)void 0===l[r]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=t.extensions[r])}function ja(l,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(l.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function MM(l,e){if(l.updateMorphTargets(),void 0!==e.weights)for(let t=0,r=e.weights.length;t<r;t++)l.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(l.morphTargetInfluences.length===t.length){l.morphTargetDictionary={};for(let r=0,o=t.length;r<o;r++)l.morphTargetDictionary[t[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function xM(l){let e;const t=l.extensions&&l.extensions[Yn.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+Sm(t.attributes):l.indices+":"+Sm(l.attributes)+":"+l.mode,void 0!==l.targets)for(let r=0,o=l.targets.length;r<o;r++)e+=":"+Sm(l.targets[r]);return e}function Sm(l){let e="";const t=Object.keys(l).sort();for(let r=0,o=t.length;r<o;r++)e+=t[r]+":"+l[t[r]]+";";return e}function bm(l){switch(l){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const $d=new Ht;class EM{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new uy,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,o=!1,a=-1;typeof navigator<"u"&&(r=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),o=navigator.userAgent.indexOf("Firefox")>-1,a=o?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||r||o&&a<98?new N0(this.options.manager):new ts(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new bs(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const r=this,o=this.json,a=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(u){return u._markDefs&&u._markDefs()}),Promise.all(this._invokeAll(function(u){return u.beforeRoot&&u.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(u){const f={scene:u[0][o.scene||0],scenes:u[0],animations:u[1],cameras:u[2],asset:o.asset,parser:r,userData:{}};$r(a,f,o),ja(f,o),Promise.all(r._invokeAll(function(p){return p.afterRoot&&p.afterRoot(f)})).then(function(){e(f)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let o=0,a=t.length;o<a;o++){const u=t[o].joints;for(let f=0,p=u.length;f<p;f++)e[u[f]].isBone=!0}for(let o=0,a=e.length;o<a;o++){const u=e[o];void 0!==u.mesh&&(this._addNodeRef(this.meshCache,u.mesh),void 0!==u.skin&&(r[u.mesh].isSkinnedMesh=!0)),void 0!==u.camera&&this._addNodeRef(this.cameraCache,u.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;const o=r.clone(),a=(u,f)=>{const p=this.associations.get(u);null!=p&&this.associations.set(f,p);for(const[m,v]of u.children.entries())a(v,f.children[m])};return a(r,o),o.name+="_instance_"+e.uses[t]++,o}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){const o=e(t[r]);if(o)return o}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const r=[];for(let o=0;o<t.length;o++){const a=e(t[o]);a&&r.push(a)}return r}getDependency(e,t){const r=e+":"+t;let o=this.cache.get(r);if(!o){switch(e){case"scene":o=this.loadScene(t);break;case"node":o=this._invokeOne(function(a){return a.loadNode&&a.loadNode(t)});break;case"mesh":o=this._invokeOne(function(a){return a.loadMesh&&a.loadMesh(t)});break;case"accessor":o=this.loadAccessor(t);break;case"bufferView":o=this._invokeOne(function(a){return a.loadBufferView&&a.loadBufferView(t)});break;case"buffer":o=this.loadBuffer(t);break;case"material":o=this._invokeOne(function(a){return a.loadMaterial&&a.loadMaterial(t)});break;case"texture":o=this._invokeOne(function(a){return a.loadTexture&&a.loadTexture(t)});break;case"skin":o=this.loadSkin(t);break;case"animation":o=this._invokeOne(function(a){return a.loadAnimation&&a.loadAnimation(t)});break;case"camera":o=this.loadCamera(t);break;default:if(o=this._invokeOne(function(a){return a!=this&&a.getDependency&&a.getDependency(e,t)}),!o)throw new Error("Unknown type: "+e)}this.cache.add(r,o)}return o}getDependencies(e){let t=this.cache.get(e);if(!t){const r=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(a,u){return r.getDependency(e,u)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[Yn.KHR_BINARY_GLTF].body);const o=this.options;return new Promise(function(a,u){r.load(Ec.resolveURL(t.uri,o.path),a,void 0,function(){u(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(r){const a=t.byteOffset||0;return r.slice(a,a+(t.byteLength||0))})}loadAccessor(e){const t=this,r=this.json,o=this.json.accessors[e];if(void 0===o.bufferView&&void 0===o.sparse){const u=Rh[o.type],p=!0===o.normalized,m=new(0,Ml[o.componentType])(o.count*u);return Promise.resolve(new H(m,u,p))}const a=[];return a.push(void 0!==o.bufferView?this.getDependency("bufferView",o.bufferView):null),void 0!==o.sparse&&(a.push(this.getDependency("bufferView",o.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",o.sparse.values.bufferView))),Promise.all(a).then(function(u){const f=u[0],p=Rh[o.type],m=Ml[o.componentType],v=m.BYTES_PER_ELEMENT,x=o.byteOffset||0,w=void 0!==o.bufferView?r.bufferViews[o.bufferView].byteStride:void 0,D=!0===o.normalized;let N,I;if(w&&w!==v*p){const A=Math.floor(x/w),k="InterleavedBuffer:"+o.bufferView+":"+o.componentType+":"+A+":"+o.count;let O=t.cache.get(k);O||(N=new m(f,A*w,o.count*w/v),O=new md(N,w/v),t.cache.add(k,O)),I=new Fo(O,p,x%w/v,D)}else N=null===f?new m(o.count*p):new m(f,x,o.count*p),I=new H(N,p,D);if(void 0!==o.sparse){const B=o.sparse.values.byteOffset||0,W=new(0,Ml[o.sparse.indices.componentType])(u[1],o.sparse.indices.byteOffset||0,o.sparse.count*Rh.SCALAR),Y=new m(u[2],B,o.sparse.count*p);null!==f&&(I=new H(I.array.slice(),I.itemSize,I.normalized));for(let q=0,ee=W.length;q<ee;q++){const z=W[q];if(I.setX(z,Y[q*p]),p>=2&&I.setY(z,Y[q*p+1]),p>=3&&I.setZ(z,Y[q*p+2]),p>=4&&I.setW(z,Y[q*p+3]),p>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return I})}loadTexture(e){const t=this.json,a=t.textures[e].source,u=t.images[a];let f=this.textureLoader;if(u.uri){const p=this.options.manager.getHandler(u.uri);null!==p&&(f=p)}return this.loadTextureImage(e,a,f)}loadTextureImage(e,t,r){const o=this,a=this.json,u=a.textures[e],f=a.images[t],p=(f.uri||f.bufferView)+":"+u.sampler;if(this.textureCache[p])return this.textureCache[p];const m=this.loadImageSource(t,r).then(function(v){v.flipY=!1,v.name=u.name||f.name||"",""===v.name&&"string"==typeof f.uri&&!1===f.uri.startsWith("data:image/")&&(v.name=f.uri);const x=(a.samplers||{})[u.sampler]||{};return v.magFilter=yM[x.magFilter]||Mi,v.minFilter=yM[x.minFilter]||Or,v.wrapS=Em[x.wrapS]||er,v.wrapT=Em[x.wrapT]||er,o.associations.set(v,{textures:e}),v}).catch(function(){return null});return this.textureCache[p]=m,m}loadImageSource(e,t){const o=this.json,a=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(y=>y.clone());const u=o.images[e],f=self.URL||self.webkitURL;let p=u.uri||"",m=!1;if(void 0!==u.bufferView)p=this.getDependency("bufferView",u.bufferView).then(function(y){m=!0;const x=new Blob([y],{type:u.mimeType});return p=f.createObjectURL(x),p});else if(void 0===u.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const v=Promise.resolve(p).then(function(y){return new Promise(function(x,w){let D=x;!0===t.isImageBitmapLoader&&(D=function(N){const I=new b(N);I.needsUpdate=!0,x(I)}),t.load(Ec.resolveURL(y,a.path),D,void 0,w)})}).then(function(y){return!0===m&&f.revokeObjectURL(p),y.userData.mimeType=u.mimeType||function wm(l){return l.search(/\.jpe?g($|\?)/i)>0||0===l.search(/^data\:image\/jpeg/)?"image/jpeg":l.search(/\.webp($|\?)/i)>0||0===l.search(/^data\:image\/webp/)?"image/webp":"image/png"}(u.uri),y}).catch(function(y){throw console.error("THREE.GLTFLoader: Couldn't load texture",p),y});return this.sourceCache[e]=v,v}assignTexture(e,t,r,o){const a=this;return this.getDependency("texture",r.index).then(function(u){if(!u)return null;if(void 0!==r.texCoord&&r.texCoord>0&&((u=u.clone()).channel=r.texCoord),a.extensions[Yn.KHR_TEXTURE_TRANSFORM]){const f=void 0!==r.extensions?r.extensions[Yn.KHR_TEXTURE_TRANSFORM]:void 0;if(f){const p=a.associations.get(u);u=a.extensions[Yn.KHR_TEXTURE_TRANSFORM].extendTexture(u,f),a.associations.set(u,p)}}return void 0!==o&&(u.colorSpace=o),e[t]=u,u})}assignFinalMaterial(e){const t=e.geometry;let r=e.material;const o=void 0===t.attributes.tangent,a=void 0!==t.attributes.color,u=void 0===t.attributes.normal;if(e.isPoints){const f="PointsMaterial:"+r.uuid;let p=this.cache.get(f);p||(p=new Yf,Ms.prototype.copy.call(p,r),p.color.copy(r.color),p.map=r.map,p.sizeAttenuation=!1,this.cache.add(f,p)),r=p}else if(e.isLine){const f="LineBasicMaterial:"+r.uuid;let p=this.cache.get(f);p||(p=new es,Ms.prototype.copy.call(p,r),p.color.copy(r.color),p.map=r.map,this.cache.add(f,p)),r=p}if(o||a||u){let f="ClonedMaterial:"+r.uuid+":";o&&(f+="derivative-tangents:"),a&&(f+="vertex-colors:"),u&&(f+="flat-shading:");let p=this.cache.get(f);p||(p=r.clone(),a&&(p.vertexColors=!0),u&&(p.flatShading=!0),o&&(p.normalScale&&(p.normalScale.y*=-1),p.clearcoatNormalScale&&(p.clearcoatNormalScale.y*=-1)),this.cache.add(f,p),this.associations.set(p,this.associations.get(r))),r=p}e.material=r}getMaterialType(){return mh}loadMaterial(e){const t=this,o=this.extensions,a=this.json.materials[e];let u;const f={},m=[];if((a.extensions||{})[Yn.KHR_MATERIALS_UNLIT]){const y=o[Yn.KHR_MATERIALS_UNLIT];u=y.getMaterialType(),m.push(y.extendParams(f,a,t))}else{const y=a.pbrMetallicRoughness||{};if(f.color=new It(1,1,1),f.opacity=1,Array.isArray(y.baseColorFactor)){const x=y.baseColorFactor;f.color.setRGB(x[0],x[1],x[2],Oi),f.opacity=x[3]}void 0!==y.baseColorTexture&&m.push(t.assignTexture(f,"map",y.baseColorTexture,_n)),f.metalness=void 0!==y.metallicFactor?y.metallicFactor:1,f.roughness=void 0!==y.roughnessFactor?y.roughnessFactor:1,void 0!==y.metallicRoughnessTexture&&(m.push(t.assignTexture(f,"metalnessMap",y.metallicRoughnessTexture)),m.push(t.assignTexture(f,"roughnessMap",y.metallicRoughnessTexture))),u=this._invokeOne(function(x){return x.getMaterialType&&x.getMaterialType(e)}),m.push(Promise.all(this._invokeAll(function(x){return x.extendMaterialParams&&x.extendMaterialParams(e,f)})))}!0===a.doubleSided&&(f.side=2);const v=a.alphaMode||"OPAQUE";if("BLEND"===v?(f.transparent=!0,f.depthWrite=!1):(f.transparent=!1,"MASK"===v&&(f.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&u!==cs&&(m.push(t.assignTexture(f,"normalMap",a.normalTexture)),f.normalScale=new Re(1,1),void 0!==a.normalTexture.scale)){const y=a.normalTexture.scale;f.normalScale.set(y,y)}if(void 0!==a.occlusionTexture&&u!==cs&&(m.push(t.assignTexture(f,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(f.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&u!==cs){const y=a.emissiveFactor;f.emissive=(new It).setRGB(y[0],y[1],y[2],Oi)}return void 0!==a.emissiveTexture&&u!==cs&&m.push(t.assignTexture(f,"emissiveMap",a.emissiveTexture,_n)),Promise.all(m).then(function(){const y=new u(f);return a.name&&(y.name=a.name),ja(y,a),t.associations.set(y,{materials:e}),a.extensions&&$r(o,y,a),y})}createUniqueName(e){const t=yi.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,r=this.extensions,o=this.primitiveCache;function a(f){return r[Yn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(f,t).then(function(p){return My(p,f,t)})}const u=[];for(let f=0,p=e.length;f<p;f++){const m=e[f],v=xM(m),y=o[v];if(y)u.push(y.promise);else{let x;x=m.extensions&&m.extensions[Yn.KHR_DRACO_MESH_COMPRESSION]?a(m):My(new Bn,m,t),o[v]={primitive:m,promise:x},u.push(x)}}return Promise.all(u)}loadMesh(e){const t=this,o=this.extensions,a=this.json.meshes[e],u=a.primitives,f=[];for(let p=0,m=u.length;p<m;p++){const v=void 0===u[p].material?(void 0===(l=this.cache).DefaultMaterial&&(l.DefaultMaterial=new mh({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),l.DefaultMaterial):this.getDependency("material",u[p].material);f.push(v)}var l;return f.push(t.loadGeometries(u)),Promise.all(f).then(function(p){const m=p.slice(0,p.length-1),v=p[p.length-1],y=[];for(let w=0,D=v.length;w<D;w++){const N=v[w],I=u[w];let A;const k=m[w];if(I.mode===lo.TRIANGLES||I.mode===lo.TRIANGLE_STRIP||I.mode===lo.TRIANGLE_FAN||void 0===I.mode)A=!0===a.isSkinnedMesh?new g0(N,k):new pr(N,k),!0===A.isSkinnedMesh&&A.normalizeSkinWeights(),I.mode===lo.TRIANGLE_STRIP?A.geometry=vm(A.geometry,1):I.mode===lo.TRIANGLE_FAN&&(A.geometry=vm(A.geometry,2));else if(I.mode===lo.LINES)A=new av(N,k);else if(I.mode===lo.LINE_STRIP)A=new yc(N,k);else if(I.mode===lo.LINE_LOOP)A=new Up(N,k);else{if(I.mode!==lo.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+I.mode);A=new cv(N,k)}Object.keys(A.geometry.morphAttributes).length>0&&MM(A,a),A.name=t.createUniqueName(a.name||"mesh_"+e),ja(A,a),I.extensions&&$r(o,A,I),t.assignFinalMaterial(A),y.push(A)}for(let w=0,D=y.length;w<D;w++)t.associations.set(y[w],{meshes:e,primitives:w});if(1===y.length)return a.extensions&&$r(o,y[0],a),y[0];const x=new da;a.extensions&&$r(o,x,a),t.associations.set(x,{meshes:e});for(let w=0,D=y.length;w<D;w++)x.add(y[w]);return x})}loadCamera(e){let t;const r=this.json.cameras[e],o=r[r.type];if(o)return"perspective"===r.type?t=new xr(ia_radToDeg(o.yfov),o.aspectRatio||1,o.znear||1,o.zfar||2e6):"orthographic"===r.type&&(t=new tl(-o.xmag,o.xmag,o.ymag,-o.ymag,o.znear,o.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),ja(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],r=[];for(let o=0,a=t.joints.length;o<a;o++)r.push(this._loadNodeShallow(t.joints[o]));return r.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(r).then(function(o){const a=o.pop(),u=o,f=[],p=[];for(let m=0,v=u.length;m<v;m++){const y=u[m];if(y){f.push(y);const x=new Ht;null!==a&&x.fromArray(a.array,16*m),p.push(x)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[m])}return new vc(f,p)})}loadAnimation(e){const r=this,o=this.json.animations[e],a=o.name?o.name:"animation_"+e,u=[],f=[],p=[],m=[],v=[];for(let y=0,x=o.channels.length;y<x;y++){const w=o.channels[y],D=o.samplers[w.sampler],N=w.target,A=void 0!==o.parameters?o.parameters[D.input]:D.input,k=void 0!==o.parameters?o.parameters[D.output]:D.output;void 0!==N.node&&(u.push(this.getDependency("node",N.node)),f.push(this.getDependency("accessor",A)),p.push(this.getDependency("accessor",k)),m.push(D),v.push(N))}return Promise.all([Promise.all(u),Promise.all(f),Promise.all(p),Promise.all(m),Promise.all(v)]).then(function(y){const x=y[0],w=y[1],D=y[2],N=y[3],I=y[4],A=[];for(let k=0,O=x.length;k<O;k++){const B=x[k],W=w[k],Y=D[k],q=N[k],ee=I[k];if(void 0===B)continue;B.updateMatrix&&B.updateMatrix();const z=r._createAnimationTracks(B,W,Y,q,ee);if(z)for(let Z=0;Z<z.length;Z++)A.push(z[Z])}return new Fd(a,void 0,A)})}createNodeMesh(e){const r=this,o=this.json.nodes[e];return void 0===o.mesh?null:r.getDependency("mesh",o.mesh).then(function(a){const u=r._getNodeRef(r.meshCache,o.mesh,a);return void 0!==o.weights&&u.traverse(function(f){if(f.isMesh)for(let p=0,m=o.weights.length;p<m;p++)f.morphTargetInfluences[p]=o.weights[p]}),u})}loadNode(e){const r=this,o=this.json.nodes[e],a=r._loadNodeShallow(e),u=[],f=o.children||[];for(let m=0,v=f.length;m<v;m++)u.push(r.getDependency("node",f[m]));const p=void 0===o.skin?Promise.resolve(null):r.getDependency("skin",o.skin);return Promise.all([a,Promise.all(u),p]).then(function(m){const v=m[0],y=m[1],x=m[2];null!==x&&v.traverse(function(w){w.isSkinnedMesh&&w.bind(x,$d)});for(let w=0,D=y.length;w<D;w++)v.add(y[w]);return v})}_loadNodeShallow(e){const r=this.extensions,o=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const a=this.json.nodes[e],u=a.name?o.createUniqueName(a.name):"",f=[],p=o._invokeOne(function(m){return m.createNodeMesh&&m.createNodeMesh(e)});return p&&f.push(p),void 0!==a.camera&&f.push(o.getDependency("camera",a.camera).then(function(m){return o._getNodeRef(o.cameraCache,a.camera,m)})),o._invokeAll(function(m){return m.createNodeAttachment&&m.createNodeAttachment(e)}).forEach(function(m){f.push(m)}),this.nodeCache[e]=Promise.all(f).then(function(m){let v;if(v=!0===a.isBone?new Op:m.length>1?new da:1===m.length?m[0]:new sn,v!==m[0])for(let y=0,x=m.length;y<x;y++)v.add(m[y]);if(a.name&&(v.userData.name=a.name,v.name=u),ja(v,a),a.extensions&&$r(r,v,a),void 0!==a.matrix){const y=new Ht;y.fromArray(a.matrix),v.applyMatrix4(y)}else void 0!==a.translation&&v.position.fromArray(a.translation),void 0!==a.rotation&&v.quaternion.fromArray(a.rotation),void 0!==a.scale&&v.scale.fromArray(a.scale);return o.associations.has(v)||o.associations.set(v,{}),o.associations.get(v).nodes=e,v}),this.nodeCache[e]}loadScene(e){const t=this.extensions,r=this.json.scenes[e],o=this,a=new da;r.name&&(a.name=o.createUniqueName(r.name)),ja(a,r),r.extensions&&$r(t,a,r);const u=r.nodes||[],f=[];for(let p=0,m=u.length;p<m;p++)f.push(o.getDependency("node",u[p]));return Promise.all(f).then(function(p){for(let v=0,y=p.length;v<y;v++)a.add(p[v]);return o.associations=(v=>{const y=new Map;for(const[x,w]of o.associations)(x instanceof Ms||x instanceof b)&&y.set(x,w);return v.traverse(x=>{const w=o.associations.get(x);null!=w&&y.set(x,w)}),y})(a),a})}_createAnimationTracks(e,t,r,o,a){const u=[],f=e.name?e.name:e.uuid,p=[];let m;switch(Cc[a.path]===Cc.weights?e.traverse(function(x){x.morphTargetInfluences&&p.push(x.name?x.name:x.uuid)}):p.push(f),Cc[a.path]){case Cc.weights:m=Od;break;case Cc.rotation:m=xc;break;case Cc.position:case Cc.scale:m=yu;break;default:m=1===r.itemSize?Od:yu}const v=void 0!==o.interpolation?_M[o.interpolation]:qr,y=this._getArrayFromAccessor(r);for(let x=0,w=p.length;x<w;x++){const D=new m(p[x]+"."+Cc[a.path],t.array,y,v);"CUBICSPLINE"===o.interpolation&&this._createCubicSplineTrackInterpolant(D),u.push(D)}return u}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const r=bm(t.constructor),o=new Float32Array(t.length);for(let a=0,u=t.length;a<u;a++)o[a]=t[a]*r;t=o}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(r){return new(this instanceof xc?vy:gy)(this.times,this.values,this.getValueSize()/3,r)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function My(l,e,t){const r=e.attributes,o=[];function a(u,f){return t.getDependency("accessor",u).then(function(p){l.setAttribute(f,p)})}for(const u in r){const f=uo[u]||u.toLowerCase();f in l.attributes||o.push(a(r[u],f))}if(void 0!==e.indices&&!l.index){const u=t.getDependency("accessor",e.indices).then(function(f){l.setIndex(f)});o.push(u)}return sr.workingColorSpace!==Oi&&"COLOR_0"in r&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${sr.workingColorSpace}" not supported.`),ja(l,e),function _y(l,e,t){const r=e.attributes,o=new Xn;if(void 0===r.POSITION)return;{const f=t.json.accessors[r.POSITION],p=f.min,m=f.max;if(void 0===p||void 0===m)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(o.set(new $(p[0],p[1],p[2]),new $(m[0],m[1],m[2])),f.normalized){const v=bm(Ml[f.componentType]);o.min.multiplyScalar(v),o.max.multiplyScalar(v)}}const a=e.targets;if(void 0!==a){const f=new $,p=new $;for(let m=0,v=a.length;m<v;m++){const y=a[m];if(void 0!==y.POSITION){const x=t.json.accessors[y.POSITION],w=x.min,D=x.max;if(void 0!==w&&void 0!==D){if(p.setX(Math.max(Math.abs(w[0]),Math.abs(D[0]))),p.setY(Math.max(Math.abs(w[1]),Math.abs(D[1]))),p.setZ(Math.max(Math.abs(w[2]),Math.abs(D[2]))),x.normalized){const N=bm(Ml[x.componentType]);p.multiplyScalar(N)}f.max(p)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(f)}l.boundingBox=o;const u=new zr;o.getCenter(u.center),u.radius=o.min.distanceTo(o.max)/2,l.boundingSphere=u}(l,e,t),Promise.all(o).then(function(){return void 0!==e.targets?function yy(l,e,t){let r=!1,o=!1,a=!1;for(let m=0,v=e.length;m<v;m++){const y=e[m];if(void 0!==y.POSITION&&(r=!0),void 0!==y.NORMAL&&(o=!0),void 0!==y.COLOR_0&&(a=!0),r&&o&&a)break}if(!r&&!o&&!a)return Promise.resolve(l);const u=[],f=[],p=[];for(let m=0,v=e.length;m<v;m++){const y=e[m];if(r){const x=void 0!==y.POSITION?t.getDependency("accessor",y.POSITION):l.attributes.position;u.push(x)}if(o){const x=void 0!==y.NORMAL?t.getDependency("accessor",y.NORMAL):l.attributes.normal;f.push(x)}if(a){const x=void 0!==y.COLOR_0?t.getDependency("accessor",y.COLOR_0):l.attributes.color;p.push(x)}}return Promise.all([Promise.all(u),Promise.all(f),Promise.all(p)]).then(function(m){const y=m[1],x=m[2];return r&&(l.morphAttributes.position=m[0]),o&&(l.morphAttributes.normal=y),a&&(l.morphAttributes.color=x),l.morphTargetsRelative=!0,l})}(l,e.targets,t):l})}const xy={type:"change"},Ph={type:"start"},Tm={type:"end"},xl=new Ps,Ey=new No,Sy=Math.cos(70*ia_DEG2RAD);class by extends Pi{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new $,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return f.phi},this.getAzimuthalAngle=function(){return f.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(ie){ie.addEventListener("keydown",j),this._domElementKeyEvents=ie},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",j),this._domElementKeyEvents=null},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(xy),r.update(),a=o.NONE},this.update=function(){const ie=new $,Ke=(new pn).setFromUnitVectors(e.up,new $(0,1,0)),Ft=Ke.clone().invert(),St=new $,Ct=new pn,An=new $,ti=2*Math.PI;return function(Lt=null){const we=r.object.position;ie.copy(we).sub(r.target),ie.applyQuaternion(Ke),f.setFromVector3(ie),r.autoRotate&&a===o.NONE&&fe(function z(ie){return null!==ie?2*Math.PI/60*r.autoRotateSpeed*ie:2*Math.PI/60/60*r.autoRotateSpeed}(Lt)),r.enableDamping?(f.theta+=p.theta*r.dampingFactor,f.phi+=p.phi*r.dampingFactor):(f.theta+=p.theta,f.phi+=p.phi);let ct=r.minAzimuthAngle,xt=r.maxAzimuthAngle;isFinite(ct)&&isFinite(xt)&&(ct<-Math.PI?ct+=ti:ct>Math.PI&&(ct-=ti),xt<-Math.PI?xt+=ti:xt>Math.PI&&(xt-=ti),f.theta=ct<=xt?Math.max(ct,Math.min(xt,f.theta)):f.theta>(ct+xt)/2?Math.max(ct,f.theta):Math.min(xt,f.theta)),f.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,f.phi)),f.makeSafe(),!0===r.enableDamping?r.target.addScaledVector(v,r.dampingFactor):r.target.add(v),f.radius=Ye(r.zoomToCursor&&Y||r.object.isOrthographicCamera?f.radius:f.radius*m),ie.setFromSpherical(f),ie.applyQuaternion(Ft),we.copy(r.target).add(ie),r.object.lookAt(r.target),!0===r.enableDamping?(p.theta*=1-r.dampingFactor,p.phi*=1-r.dampingFactor,v.multiplyScalar(1-r.dampingFactor)):(p.set(0,0,0),v.set(0,0,0));let Kn=!1;if(r.zoomToCursor&&Y){let Si=null;if(r.object.isPerspectiveCamera){const Li=ie.length();Si=Ye(Li*m),r.object.position.addScaledVector(B,Li-Si),r.object.updateMatrixWorld()}else if(r.object.isOrthographicCamera){const Li=new $(W.x,W.y,0);Li.unproject(r.object),r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/m)),r.object.updateProjectionMatrix(),Kn=!0;const ws=new $(W.x,W.y,0);ws.unproject(r.object),r.object.position.sub(ws).add(Li),r.object.updateMatrixWorld(),Si=ie.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;null!==Si&&(this.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(Si).add(r.object.position):(xl.origin.copy(r.object.position),xl.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(xl.direction))<Sy?e.lookAt(r.target):(Ey.setFromNormalAndCoplanarPoint(r.object.up,r.target),xl.intersectPlane(Ey,r.target))))}else r.object.isOrthographicCamera&&(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/m)),r.object.updateProjectionMatrix(),Kn=!0);return m=1,Y=!1,!!(Kn||St.distanceToSquared(r.object.position)>u||8*(1-Ct.dot(r.object.quaternion))>u||An.distanceToSquared(r.target)>0)&&(r.dispatchEvent(xy),St.copy(r.object.position),Ct.copy(r.object.quaternion),An.copy(r.target),Kn=!1,!0)}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",rt),r.domElement.removeEventListener("pointerdown",Vt),r.domElement.removeEventListener("pointercancel",Yt),r.domElement.removeEventListener("wheel",te),r.domElement.removeEventListener("pointermove",Gt),r.domElement.removeEventListener("pointerup",Yt),null!==r._domElementKeyEvents&&(r._domElementKeyEvents.removeEventListener("keydown",j),r._domElementKeyEvents=null)};const r=this,o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=o.NONE;const u=1e-6,f=new zd,p=new zd;let m=1;const v=new $,y=new Re,x=new Re,w=new Re,D=new Re,N=new Re,I=new Re,A=new Re,k=new Re,O=new Re,B=new $,W=new Re;let Y=!1;const q=[],ee={};function Z(){return Math.pow(.95,r.zoomSpeed)}function fe(ie){p.theta-=ie}function He(ie){p.phi-=ie}const he=function(){const ie=new $;return function(Ft,St){ie.setFromMatrixColumn(St,0),ie.multiplyScalar(-Ft),v.add(ie)}}(),pe=function(){const ie=new $;return function(Ft,St){!0===r.screenSpacePanning?ie.setFromMatrixColumn(St,1):(ie.setFromMatrixColumn(St,0),ie.crossVectors(r.object.up,ie)),ie.multiplyScalar(Ft),v.add(ie)}}(),ve=function(){const ie=new $;return function(Ft,St){const Ct=r.domElement;if(r.object.isPerspectiveCamera){ie.copy(r.object.position).sub(r.target);let ti=ie.length();ti*=Math.tan(r.object.fov/2*Math.PI/180),he(2*Ft*ti/Ct.clientHeight,r.object.matrix),pe(2*St*ti/Ct.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(he(Ft*(r.object.right-r.object.left)/r.object.zoom/Ct.clientWidth,r.object.matrix),pe(St*(r.object.top-r.object.bottom)/r.object.zoom/Ct.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function Xe(ie){r.object.isPerspectiveCamera||r.object.isOrthographicCamera?m/=ie:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function Ue(ie){r.object.isPerspectiveCamera||r.object.isOrthographicCamera?m*=ie:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function ze(ie){if(!r.zoomToCursor)return;Y=!0;const Ke=r.domElement.getBoundingClientRect(),St=ie.clientY-Ke.top,An=Ke.height;W.x=(ie.clientX-Ke.left)/Ke.width*2-1,W.y=-St/An*2+1,B.set(W.x,W.y,1).unproject(r.object).sub(r.object.position).normalize()}function Ye(ie){return Math.max(r.minDistance,Math.min(r.maxDistance,ie))}function et(ie){y.set(ie.clientX,ie.clientY)}function ge(ie){D.set(ie.clientX,ie.clientY)}function dn(){1===q.length?y.set(q[0].pageX,q[0].pageY):y.set(.5*(q[0].pageX+q[1].pageX),.5*(q[0].pageY+q[1].pageY))}function ln(){1===q.length?D.set(q[0].pageX,q[0].pageY):D.set(.5*(q[0].pageX+q[1].pageX),.5*(q[0].pageY+q[1].pageY))}function Wn(){const ie=q[0].pageX-q[1].pageX,Ke=q[0].pageY-q[1].pageY,Ft=Math.sqrt(ie*ie+Ke*Ke);A.set(0,Ft)}function vt(ie){if(1==q.length)x.set(ie.pageX,ie.pageY);else{const Ft=Te(ie);x.set(.5*(ie.pageX+Ft.x),.5*(ie.pageY+Ft.y))}w.subVectors(x,y).multiplyScalar(r.rotateSpeed);const Ke=r.domElement;fe(2*Math.PI*w.x/Ke.clientHeight),He(2*Math.PI*w.y/Ke.clientHeight),y.copy(x)}function Ge(ie){if(1===q.length)N.set(ie.pageX,ie.pageY);else{const Ke=Te(ie);N.set(.5*(ie.pageX+Ke.x),.5*(ie.pageY+Ke.y))}I.subVectors(N,D).multiplyScalar(r.panSpeed),ve(I.x,I.y),D.copy(N)}function yt(ie){const Ke=Te(ie),Ft=ie.pageX-Ke.x,St=ie.pageY-Ke.y,Ct=Math.sqrt(Ft*Ft+St*St);k.set(0,Ct),O.set(0,Math.pow(k.y/A.y,r.zoomSpeed)),Xe(O.y),A.copy(k)}function Vt(ie){!1!==r.enabled&&(0===q.length&&(r.domElement.setPointerCapture(ie.pointerId),r.domElement.addEventListener("pointermove",Gt),r.domElement.addEventListener("pointerup",Yt)),function pt(ie){q.push(ie)}(ie),"touch"===ie.pointerType?function Se(ie){switch(gt(ie),q.length){case 1:switch(r.touches.ONE){case 0:if(!1===r.enableRotate)return;dn(),a=o.TOUCH_ROTATE;break;case 1:if(!1===r.enablePan)return;ln(),a=o.TOUCH_PAN;break;default:a=o.NONE}break;case 2:switch(r.touches.TWO){case 2:if(!1===r.enableZoom&&!1===r.enablePan)return;(function fn(){r.enableZoom&&Wn(),r.enablePan&&ln()})(),a=o.TOUCH_DOLLY_PAN;break;case 3:if(!1===r.enableZoom&&!1===r.enableRotate)return;(function ne(){r.enableZoom&&Wn(),r.enableRotate&&dn()})(),a=o.TOUCH_DOLLY_ROTATE;break;default:a=o.NONE}break;default:a=o.NONE}a!==o.NONE&&r.dispatchEvent(Ph)}(ie):function ei(ie){let Ke;switch(ie.button){case 0:Ke=r.mouseButtons.LEFT;break;case 1:Ke=r.mouseButtons.MIDDLE;break;case 2:Ke=r.mouseButtons.RIGHT;break;default:Ke=-1}switch(Ke){case 1:if(!1===r.enableZoom)return;(function Rt(ie){ze(ie),A.set(ie.clientX,ie.clientY)})(ie),a=o.DOLLY;break;case 0:if(ie.ctrlKey||ie.metaKey||ie.shiftKey){if(!1===r.enablePan)return;ge(ie),a=o.PAN}else{if(!1===r.enableRotate)return;et(ie),a=o.ROTATE}break;case 2:if(ie.ctrlKey||ie.metaKey||ie.shiftKey){if(!1===r.enableRotate)return;et(ie),a=o.ROTATE}else{if(!1===r.enablePan)return;ge(ie),a=o.PAN}break;default:a=o.NONE}a!==o.NONE&&r.dispatchEvent(Ph)}(ie))}function Gt(ie){!1!==r.enabled&&("touch"===ie.pointerType?function dt(ie){switch(gt(ie),a){case o.TOUCH_ROTATE:if(!1===r.enableRotate)return;vt(ie),r.update();break;case o.TOUCH_PAN:if(!1===r.enablePan)return;Ge(ie),r.update();break;case o.TOUCH_DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;(function Ze(ie){r.enableZoom&&yt(ie),r.enablePan&&Ge(ie)})(ie),r.update();break;case o.TOUCH_DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;(function rn(ie){r.enableZoom&&yt(ie),r.enableRotate&&vt(ie)})(ie),r.update();break;default:a=o.NONE}}(ie):function zi(ie){switch(a){case o.ROTATE:if(!1===r.enableRotate)return;!function tt(ie){x.set(ie.clientX,ie.clientY),w.subVectors(x,y).multiplyScalar(r.rotateSpeed);const Ke=r.domElement;fe(2*Math.PI*w.x/Ke.clientHeight),He(2*Math.PI*w.y/Ke.clientHeight),y.copy(x),r.update()}(ie);break;case o.DOLLY:if(!1===r.enableZoom)return;!function mt(ie){k.set(ie.clientX,ie.clientY),O.subVectors(k,A),O.y>0?Xe(Z()):O.y<0&&Ue(Z()),A.copy(k),r.update()}(ie);break;case o.PAN:if(!1===r.enablePan)return;!function Pt(ie){N.set(ie.clientX,ie.clientY),I.subVectors(N,D).multiplyScalar(r.panSpeed),ve(I.x,I.y),D.copy(N),r.update()}(ie)}}(ie))}function Yt(ie){(function Qt(ie){delete ee[ie.pointerId];for(let Ke=0;Ke<q.length;Ke++)if(q[Ke].pointerId==ie.pointerId)return void q.splice(Ke,1)})(ie),0===q.length&&(r.domElement.releasePointerCapture(ie.pointerId),r.domElement.removeEventListener("pointermove",Gt),r.domElement.removeEventListener("pointerup",Yt)),r.dispatchEvent(Tm),a=o.NONE}function te(ie){!1===r.enabled||!1===r.enableZoom||a!==o.NONE||(ie.preventDefault(),r.dispatchEvent(Ph),function Bt(ie){ze(ie),ie.deltaY<0?Ue(Z()):ie.deltaY>0&&Xe(Z()),r.update()}(ie),r.dispatchEvent(Tm))}function j(ie){!1===r.enabled||!1===r.enablePan||function Wt(ie){let Ke=!1;switch(ie.code){case r.keys.UP:ie.ctrlKey||ie.metaKey||ie.shiftKey?He(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):ve(0,r.keyPanSpeed),Ke=!0;break;case r.keys.BOTTOM:ie.ctrlKey||ie.metaKey||ie.shiftKey?He(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):ve(0,-r.keyPanSpeed),Ke=!0;break;case r.keys.LEFT:ie.ctrlKey||ie.metaKey||ie.shiftKey?fe(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):ve(r.keyPanSpeed,0),Ke=!0;break;case r.keys.RIGHT:ie.ctrlKey||ie.metaKey||ie.shiftKey?fe(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):ve(-r.keyPanSpeed,0),Ke=!0}Ke&&(ie.preventDefault(),r.update())}(ie)}function rt(ie){!1!==r.enabled&&ie.preventDefault()}function gt(ie){let Ke=ee[ie.pointerId];void 0===Ke&&(Ke=new Re,ee[ie.pointerId]=Ke),Ke.set(ie.pageX,ie.pageY)}function Te(ie){return ee[(ie.pointerId===q[0].pointerId?q[1]:q[0]).pointerId]}r.domElement.addEventListener("contextmenu",rt),r.domElement.addEventListener("pointerdown",Vt),r.domElement.addEventListener("pointercancel",Yt),r.domElement.addEventListener("wheel",te,{passive:!1}),this.update()}}const wy=["rendererContainer"];let SM=(()=>{var l;class e{constructor(){this.renderer=new fd,this.scene=new sl,this.camera=new xr(75,window.innerWidth/window.innerHeight,1,1e4),this.controls=new by(this.camera,this.renderer.domElement),this.loader=new ly}ngOnInit(){const r=this.scene;this.scene.background=new It("#f0e7db"),this.camera.position.z=1e3,this.camera.position.set(0,3,5);const o=new xh(16777215,1);o.position.set(0,3,1),r.add(o),this.loader.load("./assets/robot/walle.glb",function(a){const u=a.scene;console.log(u),u.scale.set(1,1,1),r.add(u)})}animate(){window.requestAnimationFrame(()=>this.animate()),this.controls.autoRotate=!0,this.controls.update(),this.renderer.render(this.scene,this.camera)}ngAfterViewInit(){this.renderer.setSize(this.rendererContainer?.nativeElement.offsetWidth,this.rendererContainer?.nativeElement.offsetHeight),this.rendererContainer?.nativeElement.appendChild(this.renderer.domElement),this.animate()}}return(l=e).\u0275fac=function(r){return new(r||l)},l.\u0275cmp=Ae.Xpm({type:l,selectors:[["shared-robot3d"]],viewQuery:function(r,o){if(1&r&&Ae.Gf(wy,5),2&r){let a;Ae.iGM(a=Ae.CRH())&&(o.rendererContainer=a.first)}},decls:2,vars:0,consts:[["id","robot-container"],["rendererContainer",""]],template:function(r,o){1&r&&Ae._UZ(0,"div",0,1)},styles:["#robot-container[_ngcontent-%COMP%]{margin-top:-120px;margin-bottom:-200px;width:auto;height:640px}"]}),e})(),bM=(()=>{var l;class e{constructor(){this.title="portafolio"}}return(l=e).\u0275fac=function(r){return new(r||l)},l.\u0275cmp=Ae.Xpm({type:l,selectors:[["app-root"]],decls:5,vars:0,consts:[[1,"main"],["id","margin"]],template:function(r,o){1&r&&(Ae.TgZ(0,"div",0)(1,"div",1),Ae._UZ(2,"shared-navbar")(3,"shared-robot3d")(4,"router-outlet"),Ae.qZA()())},dependencies:[Ie.lC,Je,SM],styles:["body[_ngcontent-%COMP%]{display:block;width:100%;height:100%;background:#f0e7db}#margin[_ngcontent-%COMP%]{width:auto;height:100%;margin:0 300px;padding:0 16px;padding-bottom:2rem}.main[_ngcontent-%COMP%]{width:auto;height:auto;background:#f0e7db}"]}),e})(),Ty=(()=>{var l;class e{}return(l=e).\u0275fac=function(r){return new(r||l)},l.\u0275mod=Ae.oAB({type:l,bootstrap:[bM]}),l.\u0275inj=Ae.cJS({imports:[F.b2,je]}),e})();F.q6().bootstrapModule(Ty).catch(l=>console.error(l))},619:(On,_t,se)=>{se.d(_t,{X:()=>Ie});var F=se(645);class Ie extends F.x{constructor(at){super(),this._value=at}get value(){return this.getValue()}_subscribe(at){const je=super._subscribe(at);return!je.closed&&at.next(this._value),je}getValue(){const{hasError:at,thrownError:je,_value:Je}=this;if(at)throw je;return this._throwIfClosed(),Je}next(at){super.next(this._value=at)}}},592:(On,_t,se)=>{se.d(_t,{y:()=>Tn});var F=se(305),Ie=se(394),Ae=se(850),at=se(407),je=se(653),Je=se(674),Tt=se(441);let Tn=(()=>{class ut{constructor(zt){zt&&(this._subscribe=zt)}lift(zt){const Ut=new ut;return Ut.source=this,Ut.operator=zt,Ut}subscribe(zt,Ut,ai){const Vn=function Be(ut){return ut&&ut instanceof F.Lv||function lt(ut){return ut&&(0,Je.m)(ut.next)&&(0,Je.m)(ut.error)&&(0,Je.m)(ut.complete)}(ut)&&(0,Ie.Nn)(ut)}(zt)?zt:new F.Hp(zt,Ut,ai);return(0,Tt.x)(()=>{const{operator:si,source:ni}=this;Vn.add(si?si.call(Vn,ni):ni?this._subscribe(Vn):this._trySubscribe(Vn))}),Vn}_trySubscribe(zt){try{return this._subscribe(zt)}catch(Ut){zt.error(Ut)}}forEach(zt,Ut){return new(Ut=jt(Ut))((ai,Vn)=>{const si=new F.Hp({next:ni=>{try{zt(ni)}catch(_i){Vn(_i),si.unsubscribe()}},error:Vn,complete:ai});this.subscribe(si)})}_subscribe(zt){var Ut;return null===(Ut=this.source)||void 0===Ut?void 0:Ut.subscribe(zt)}[Ae.L](){return this}pipe(...zt){return(0,at.U)(zt)(this)}toPromise(zt){return new(zt=jt(zt))((Ut,ai)=>{let Vn;this.subscribe(si=>Vn=si,si=>ai(si),()=>Ut(Vn))})}}return ut.create=mn=>new ut(mn),ut})();function jt(ut){var mn;return null!==(mn=ut??je.config.Promise)&&void 0!==mn?mn:Promise}},645:(On,_t,se)=>{se.d(_t,{x:()=>Tt});var F=se(592),Ie=se(394);const at=(0,se(306).d)(jt=>function(){jt(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var je=se(39),Je=se(441);let Tt=(()=>{class jt extends F.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(Be){const ut=new Tn(this,this);return ut.operator=Be,ut}_throwIfClosed(){if(this.closed)throw new at}next(Be){(0,Je.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const ut of this.currentObservers)ut.next(Be)}})}error(Be){(0,Je.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=Be;const{observers:ut}=this;for(;ut.length;)ut.shift().error(Be)}})}complete(){(0,Je.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:Be}=this;for(;Be.length;)Be.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var Be;return(null===(Be=this.observers)||void 0===Be?void 0:Be.length)>0}_trySubscribe(Be){return this._throwIfClosed(),super._trySubscribe(Be)}_subscribe(Be){return this._throwIfClosed(),this._checkFinalizedStatuses(Be),this._innerSubscribe(Be)}_innerSubscribe(Be){const{hasError:ut,isStopped:mn,observers:zt}=this;return ut||mn?Ie.Lc:(this.currentObservers=null,zt.push(Be),new Ie.w0(()=>{this.currentObservers=null,(0,je.P)(zt,Be)}))}_checkFinalizedStatuses(Be){const{hasError:ut,thrownError:mn,isStopped:zt}=this;ut?Be.error(mn):zt&&Be.complete()}asObservable(){const Be=new F.y;return Be.source=this,Be}}return jt.create=(lt,Be)=>new Tn(lt,Be),jt})();class Tn extends Tt{constructor(lt,Be){super(),this.destination=lt,this.source=Be}next(lt){var Be,ut;null===(ut=null===(Be=this.destination)||void 0===Be?void 0:Be.next)||void 0===ut||ut.call(Be,lt)}error(lt){var Be,ut;null===(ut=null===(Be=this.destination)||void 0===Be?void 0:Be.error)||void 0===ut||ut.call(Be,lt)}complete(){var lt,Be;null===(Be=null===(lt=this.destination)||void 0===lt?void 0:lt.complete)||void 0===Be||Be.call(lt)}_subscribe(lt){var Be,ut;return null!==(ut=null===(Be=this.source)||void 0===Be?void 0:Be.subscribe(lt))&&void 0!==ut?ut:Ie.Lc}}},305:(On,_t,se)=>{se.d(_t,{Hp:()=>ai,Lv:()=>ut});var F=se(674),Ie=se(394),Ae=se(653),at=se(894),je=se(420);const Je=jt("C",void 0,void 0);function jt(ke,st,Dt){return{kind:ke,value:st,error:Dt}}var lt=se(599),Be=se(441);class ut extends Ie.w0{constructor(st){super(),this.isStopped=!1,st?(this.destination=st,(0,Ie.Nn)(st)&&st.add(this)):this.destination=_i}static create(st,Dt,yn){return new ai(st,Dt,yn)}next(st){this.isStopped?ni(function Tn(ke){return jt("N",ke,void 0)}(st),this):this._next(st)}error(st){this.isStopped?ni(function Tt(ke){return jt("E",void 0,ke)}(st),this):(this.isStopped=!0,this._error(st))}complete(){this.isStopped?ni(Je,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(st){this.destination.next(st)}_error(st){try{this.destination.error(st)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const mn=Function.prototype.bind;function zt(ke,st){return mn.call(ke,st)}class Ut{constructor(st){this.partialObserver=st}next(st){const{partialObserver:Dt}=this;if(Dt.next)try{Dt.next(st)}catch(yn){Vn(yn)}}error(st){const{partialObserver:Dt}=this;if(Dt.error)try{Dt.error(st)}catch(yn){Vn(yn)}else Vn(st)}complete(){const{partialObserver:st}=this;if(st.complete)try{st.complete()}catch(Dt){Vn(Dt)}}}class ai extends ut{constructor(st,Dt,yn){let Et;if(super(),(0,F.m)(st)||!st)Et={next:st??void 0,error:Dt??void 0,complete:yn??void 0};else{let ft;this&&Ae.config.useDeprecatedNextContext?(ft=Object.create(st),ft.unsubscribe=()=>this.unsubscribe(),Et={next:st.next&&zt(st.next,ft),error:st.error&&zt(st.error,ft),complete:st.complete&&zt(st.complete,ft)}):Et=st}this.destination=new Ut(Et)}}function Vn(ke){Ae.config.useDeprecatedSynchronousErrorHandling?(0,Be.O)(ke):(0,at.h)(ke)}function ni(ke,st){const{onStoppedNotification:Dt}=Ae.config;Dt&&lt.z.setTimeout(()=>Dt(ke,st))}const _i={closed:!0,next:je.Z,error:function si(ke){throw ke},complete:je.Z}},394:(On,_t,se)=>{se.d(_t,{Lc:()=>Je,w0:()=>je,Nn:()=>Tt});var F=se(674);const Ae=(0,se(306).d)(jt=>function(Be){jt(this),this.message=Be?`${Be.length} errors occurred during unsubscription:\n${Be.map((ut,mn)=>`${mn+1}) ${ut.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Be});var at=se(39);class je{constructor(lt){this.initialTeardown=lt,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let lt;if(!this.closed){this.closed=!0;const{_parentage:Be}=this;if(Be)if(this._parentage=null,Array.isArray(Be))for(const zt of Be)zt.remove(this);else Be.remove(this);const{initialTeardown:ut}=this;if((0,F.m)(ut))try{ut()}catch(zt){lt=zt instanceof Ae?zt.errors:[zt]}const{_finalizers:mn}=this;if(mn){this._finalizers=null;for(const zt of mn)try{Tn(zt)}catch(Ut){lt=lt??[],Ut instanceof Ae?lt=[...lt,...Ut.errors]:lt.push(Ut)}}if(lt)throw new Ae(lt)}}add(lt){var Be;if(lt&&lt!==this)if(this.closed)Tn(lt);else{if(lt instanceof je){if(lt.closed||lt._hasParent(this))return;lt._addParent(this)}(this._finalizers=null!==(Be=this._finalizers)&&void 0!==Be?Be:[]).push(lt)}}_hasParent(lt){const{_parentage:Be}=this;return Be===lt||Array.isArray(Be)&&Be.includes(lt)}_addParent(lt){const{_parentage:Be}=this;this._parentage=Array.isArray(Be)?(Be.push(lt),Be):Be?[Be,lt]:lt}_removeParent(lt){const{_parentage:Be}=this;Be===lt?this._parentage=null:Array.isArray(Be)&&(0,at.P)(Be,lt)}remove(lt){const{_finalizers:Be}=this;Be&&(0,at.P)(Be,lt),lt instanceof je&&lt._removeParent(this)}}je.EMPTY=(()=>{const jt=new je;return jt.closed=!0,jt})();const Je=je.EMPTY;function Tt(jt){return jt instanceof je||jt&&"closed"in jt&&(0,F.m)(jt.remove)&&(0,F.m)(jt.add)&&(0,F.m)(jt.unsubscribe)}function Tn(jt){(0,F.m)(jt)?jt():jt.unsubscribe()}},653:(On,_t,se)=>{se.d(_t,{config:()=>F});const F={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},232:(On,_t,se)=>{se.d(_t,{E:()=>Ie});const Ie=new(se(592).y)(je=>je.complete())},715:(On,_t,se)=>{se.d(_t,{D:()=>yn});var F=se(829),Ie=se(103),Ae=se(360),at=se(251);function je(Et,ft=0){return(0,Ae.e)((ot,Zt)=>{ot.subscribe((0,at.x)(Zt,cr=>(0,Ie.f)(Zt,Et,()=>Zt.next(cr),ft),()=>(0,Ie.f)(Zt,Et,()=>Zt.complete(),ft),cr=>(0,Ie.f)(Zt,Et,()=>Zt.error(cr),ft)))})}function Je(Et,ft=0){return(0,Ae.e)((ot,Zt)=>{Zt.add(Et.schedule(()=>ot.subscribe(Zt),ft))})}var jt=se(592),Be=se(971),ut=se(674);function zt(Et,ft){if(!Et)throw new Error("Iterable cannot be null");return new jt.y(ot=>{(0,Ie.f)(ot,ft,()=>{const Zt=Et[Symbol.asyncIterator]();(0,Ie.f)(ot,ft,()=>{Zt.next().then(cr=>{cr.done?ot.complete():ot.next(cr.value)})},0,!0)})})}var Ut=se(382),ai=se(26),Vn=se(266),si=se(664),ni=se(726),_i=se(853),ke=se(541);function yn(Et,ft){return ft?function Dt(Et,ft){if(null!=Et){if((0,Ut.c)(Et))return function Tt(Et,ft){return(0,F.Xf)(Et).pipe(Je(ft),je(ft))}(Et,ft);if((0,Vn.z)(Et))return function lt(Et,ft){return new jt.y(ot=>{let Zt=0;return ft.schedule(function(){Zt===Et.length?ot.complete():(ot.next(Et[Zt++]),ot.closed||this.schedule())})})}(Et,ft);if((0,ai.t)(Et))return function Tn(Et,ft){return(0,F.Xf)(Et).pipe(Je(ft),je(ft))}(Et,ft);if((0,ni.D)(Et))return zt(Et,ft);if((0,si.T)(Et))return function mn(Et,ft){return new jt.y(ot=>{let Zt;return(0,Ie.f)(ot,ft,()=>{Zt=Et[Be.h](),(0,Ie.f)(ot,ft,()=>{let cr,vr;try{({value:cr,done:vr}=Zt.next())}catch(fs){return void ot.error(fs)}vr?ot.complete():ot.next(cr)},0,!0)}),()=>(0,ut.m)(Zt?.return)&&Zt.return()})}(Et,ft);if((0,ke.L)(Et))return function st(Et,ft){return zt((0,ke.Q)(Et),ft)}(Et,ft)}throw(0,_i.z)(Et)}(Et,ft):(0,F.Xf)(Et)}},829:(On,_t,se)=>{se.d(_t,{Xf:()=>mn});var F=se(582),Ie=se(266),Ae=se(26),at=se(592),je=se(382),Je=se(726),Tt=se(853),Tn=se(664),jt=se(541),lt=se(674),Be=se(894),ut=se(850);function mn(ke){if(ke instanceof at.y)return ke;if(null!=ke){if((0,je.c)(ke))return function zt(ke){return new at.y(st=>{const Dt=ke[ut.L]();if((0,lt.m)(Dt.subscribe))return Dt.subscribe(st);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(ke);if((0,Ie.z)(ke))return function Ut(ke){return new at.y(st=>{for(let Dt=0;Dt<ke.length&&!st.closed;Dt++)st.next(ke[Dt]);st.complete()})}(ke);if((0,Ae.t)(ke))return function ai(ke){return new at.y(st=>{ke.then(Dt=>{st.closed||(st.next(Dt),st.complete())},Dt=>st.error(Dt)).then(null,Be.h)})}(ke);if((0,Je.D)(ke))return si(ke);if((0,Tn.T)(ke))return function Vn(ke){return new at.y(st=>{for(const Dt of ke)if(st.next(Dt),st.closed)return;st.complete()})}(ke);if((0,jt.L)(ke))return function ni(ke){return si((0,jt.Q)(ke))}(ke)}throw(0,Tt.z)(ke)}function si(ke){return new at.y(st=>{(function _i(ke,st){var Dt,yn,Et,ft;return(0,F.mG)(this,void 0,void 0,function*(){try{for(Dt=(0,F.KL)(ke);!(yn=yield Dt.next()).done;)if(st.next(yn.value),st.closed)return}catch(ot){Et={error:ot}}finally{try{yn&&!yn.done&&(ft=Dt.return)&&(yield ft.call(Dt))}finally{if(Et)throw Et.error}}st.complete()})})(ke,st).catch(Dt=>st.error(Dt))})}},96:(On,_t,se)=>{se.d(_t,{of:()=>Ae});var F=se(564),Ie=se(715);function Ae(...at){const je=(0,F.yG)(at);return(0,Ie.D)(at,je)}},251:(On,_t,se)=>{se.d(_t,{x:()=>Ie});var F=se(305);function Ie(at,je,Je,Tt,Tn){return new Ae(at,je,Je,Tt,Tn)}class Ae extends F.Lv{constructor(je,Je,Tt,Tn,jt,lt){super(je),this.onFinalize=jt,this.shouldUnsubscribe=lt,this._next=Je?function(Be){try{Je(Be)}catch(ut){je.error(ut)}}:super._next,this._error=Tn?function(Be){try{Tn(Be)}catch(ut){je.error(ut)}finally{this.unsubscribe()}}:super._error,this._complete=Tt?function(){try{Tt()}catch(Be){je.error(Be)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var je;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Je}=this;super.unsubscribe(),!Je&&(null===(je=this.onFinalize)||void 0===je||je.call(this))}}}},398:(On,_t,se)=>{se.d(_t,{U:()=>Ae});var F=se(360),Ie=se(251);function Ae(at,je){return(0,F.e)((Je,Tt)=>{let Tn=0;Je.subscribe((0,Ie.x)(Tt,jt=>{Tt.next(at.call(je,jt,Tn++))}))})}},537:(On,_t,se)=>{se.d(_t,{J:()=>Ae});var F=se(631),Ie=se(737);function Ae(at=1/0){return(0,F.z)(Ie.y,at)}},631:(On,_t,se)=>{se.d(_t,{z:()=>Tn});var F=se(398),Ie=se(829),Ae=se(360),at=se(103),je=se(251),Tt=se(674);function Tn(jt,lt,Be=1/0){return(0,Tt.m)(lt)?Tn((ut,mn)=>(0,F.U)((zt,Ut)=>lt(ut,zt,mn,Ut))((0,Ie.Xf)(jt(ut,mn))),Be):("number"==typeof lt&&(Be=lt),(0,Ae.e)((ut,mn)=>function Je(jt,lt,Be,ut,mn,zt,Ut,ai){const Vn=[];let si=0,ni=0,_i=!1;const ke=()=>{_i&&!Vn.length&&!si&&lt.complete()},st=yn=>si<ut?Dt(yn):Vn.push(yn),Dt=yn=>{zt&&lt.next(yn),si++;let Et=!1;(0,Ie.Xf)(Be(yn,ni++)).subscribe((0,je.x)(lt,ft=>{mn?.(ft),zt?st(ft):lt.next(ft)},()=>{Et=!0},void 0,()=>{if(Et)try{for(si--;Vn.length&&si<ut;){const ft=Vn.shift();Ut?(0,at.f)(lt,Ut,()=>Dt(ft)):Dt(ft)}ke()}catch(ft){lt.error(ft)}}))};return jt.subscribe((0,je.x)(lt,st,()=>{_i=!0,ke()})),()=>{ai?.()}}(ut,mn,jt,Be)))}},535:(On,_t,se)=>{se.d(_t,{w:()=>at});var F=se(829),Ie=se(360),Ae=se(251);function at(je,Je){return(0,Ie.e)((Tt,Tn)=>{let jt=null,lt=0,Be=!1;const ut=()=>Be&&!jt&&Tn.complete();Tt.subscribe((0,Ae.x)(Tn,mn=>{jt?.unsubscribe();let zt=0;const Ut=lt++;(0,F.Xf)(je(mn,Ut)).subscribe(jt=(0,Ae.x)(Tn,ai=>Tn.next(Je?Je(mn,ai,Ut,zt++):ai),()=>{jt=null,ut()}))},()=>{Be=!0,ut()}))})}},599:(On,_t,se)=>{se.d(_t,{z:()=>F});const F={setTimeout(Ie,Ae,...at){const{delegate:je}=F;return je?.setTimeout?je.setTimeout(Ie,Ae,...at):setTimeout(Ie,Ae,...at)},clearTimeout(Ie){const{delegate:Ae}=F;return(Ae?.clearTimeout||clearTimeout)(Ie)},delegate:void 0}},971:(On,_t,se)=>{se.d(_t,{h:()=>Ie});const Ie=function F(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},850:(On,_t,se)=>{se.d(_t,{L:()=>F});const F="function"==typeof Symbol&&Symbol.observable||"@@observable"},564:(On,_t,se)=>{se.d(_t,{_6:()=>Je,jO:()=>at,yG:()=>je});var F=se(674);function Ae(Tt){return Tt[Tt.length-1]}function at(Tt){return(0,F.m)(Ae(Tt))?Tt.pop():void 0}function je(Tt){return function Ie(Tt){return Tt&&(0,F.m)(Tt.schedule)}(Ae(Tt))?Tt.pop():void 0}function Je(Tt,Tn){return"number"==typeof Ae(Tt)?Tt.pop():Tn}},39:(On,_t,se)=>{function F(Ie,Ae){if(Ie){const at=Ie.indexOf(Ae);0<=at&&Ie.splice(at,1)}}se.d(_t,{P:()=>F})},306:(On,_t,se)=>{function F(Ie){const at=Ie(je=>{Error.call(je),je.stack=(new Error).stack});return at.prototype=Object.create(Error.prototype),at.prototype.constructor=at,at}se.d(_t,{d:()=>F})},441:(On,_t,se)=>{se.d(_t,{O:()=>at,x:()=>Ae});var F=se(653);let Ie=null;function Ae(je){if(F.config.useDeprecatedSynchronousErrorHandling){const Je=!Ie;if(Je&&(Ie={errorThrown:!1,error:null}),je(),Je){const{errorThrown:Tt,error:Tn}=Ie;if(Ie=null,Tt)throw Tn}}else je()}function at(je){F.config.useDeprecatedSynchronousErrorHandling&&Ie&&(Ie.errorThrown=!0,Ie.error=je)}},103:(On,_t,se)=>{function F(Ie,Ae,at,je=0,Je=!1){const Tt=Ae.schedule(function(){at(),Je?Ie.add(this.schedule(null,je)):this.unsubscribe()},je);if(Ie.add(Tt),!Je)return Tt}se.d(_t,{f:()=>F})},737:(On,_t,se)=>{function F(Ie){return Ie}se.d(_t,{y:()=>F})},266:(On,_t,se)=>{se.d(_t,{z:()=>F});const F=Ie=>Ie&&"number"==typeof Ie.length&&"function"!=typeof Ie},726:(On,_t,se)=>{se.d(_t,{D:()=>Ie});var F=se(674);function Ie(Ae){return Symbol.asyncIterator&&(0,F.m)(Ae?.[Symbol.asyncIterator])}},674:(On,_t,se)=>{function F(Ie){return"function"==typeof Ie}se.d(_t,{m:()=>F})},382:(On,_t,se)=>{se.d(_t,{c:()=>Ae});var F=se(850),Ie=se(674);function Ae(at){return(0,Ie.m)(at[F.L])}},664:(On,_t,se)=>{se.d(_t,{T:()=>Ae});var F=se(971),Ie=se(674);function Ae(at){return(0,Ie.m)(at?.[F.h])}},26:(On,_t,se)=>{se.d(_t,{t:()=>Ie});var F=se(674);function Ie(Ae){return(0,F.m)(Ae?.then)}},541:(On,_t,se)=>{se.d(_t,{L:()=>at,Q:()=>Ae});var F=se(582),Ie=se(674);function Ae(je){return(0,F.FC)(this,arguments,function*(){const Tt=je.getReader();try{for(;;){const{value:Tn,done:jt}=yield(0,F.qq)(Tt.read());if(jt)return yield(0,F.qq)(void 0);yield yield(0,F.qq)(Tn)}}finally{Tt.releaseLock()}})}function at(je){return(0,Ie.m)(je?.getReader)}},360:(On,_t,se)=>{se.d(_t,{A:()=>Ie,e:()=>Ae});var F=se(674);function Ie(at){return(0,F.m)(at?.lift)}function Ae(at){return je=>{if(Ie(je))return je.lift(function(Je){try{return at(Je,this)}catch(Tt){this.error(Tt)}});throw new TypeError("Unable to lift unknown Observable type")}}},420:(On,_t,se)=>{function F(){}se.d(_t,{Z:()=>F})},407:(On,_t,se)=>{se.d(_t,{U:()=>Ae,z:()=>Ie});var F=se(737);function Ie(...at){return Ae(at)}function Ae(at){return 0===at.length?F.y:1===at.length?at[0]:function(Je){return at.reduce((Tt,Tn)=>Tn(Tt),Je)}}},894:(On,_t,se)=>{se.d(_t,{h:()=>Ae});var F=se(653),Ie=se(599);function Ae(at){Ie.z.setTimeout(()=>{const{onUnhandledError:je}=F.config;if(!je)throw at;je(at)})}},853:(On,_t,se)=>{function F(Ie){return new TypeError(`You provided ${null!==Ie&&"object"==typeof Ie?"an invalid object":`'${Ie}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}se.d(_t,{z:()=>F})},814:(On,_t,se)=>{se.d(_t,{Do:()=>ai,EM:()=>Xs,HT:()=>at,JF:()=>hn,K0:()=>Je,Mx:()=>Tl,PM:()=>Ri,S$:()=>mn,V_:()=>Tn,Ye:()=>Vn,b0:()=>Ut,bD:()=>Bc,ez:()=>Aa,q:()=>Ae,w_:()=>je});var F=se(946);let Ie=null;function Ae(){return Ie}function at(b){Ie||(Ie=b)}class je{}const Je=new F.OlP("DocumentToken");let Tt=(()=>{var b;class L{historyGo(P){throw new Error("Not implemented")}}return(b=L).\u0275fac=function(P){return new(P||b)},b.\u0275prov=F.Yz7({token:b,factory:function(){return(0,F.f3M)(jt)},providedIn:"platform"}),L})();const Tn=new F.OlP("Location Initialized");let jt=(()=>{var b;class L extends Tt{constructor(){super(),this._doc=(0,F.f3M)(Je),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ae().getBaseHref(this._doc)}onPopState(P){const G=Ae().getGlobalEventTarget(this._doc,"window");return G.addEventListener("popstate",P,!1),()=>G.removeEventListener("popstate",P)}onHashChange(P){const G=Ae().getGlobalEventTarget(this._doc,"window");return G.addEventListener("hashchange",P,!1),()=>G.removeEventListener("hashchange",P)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(P){this._location.pathname=P}pushState(P,G,re){this._history.pushState(P,G,re)}replaceState(P,G,re){this._history.replaceState(P,G,re)}forward(){this._history.forward()}back(){this._history.back()}historyGo(P=0){this._history.go(P)}getState(){return this._history.state}}return(b=L).\u0275fac=function(P){return new(P||b)},b.\u0275prov=F.Yz7({token:b,factory:function(){return new b},providedIn:"platform"}),L})();function lt(b,L){if(0==b.length)return L;if(0==L.length)return b;let K=0;return b.endsWith("/")&&K++,L.startsWith("/")&&K++,2==K?b+L.substring(1):1==K?b+L:b+"/"+L}function Be(b){const L=b.match(/#|\?|$/),K=L&&L.index||b.length;return b.slice(0,K-("/"===b[K-1]?1:0))+b.slice(K)}function ut(b){return b&&"?"!==b[0]?"?"+b:b}let mn=(()=>{var b;class L{historyGo(P){throw new Error("Not implemented")}}return(b=L).\u0275fac=function(P){return new(P||b)},b.\u0275prov=F.Yz7({token:b,factory:function(){return(0,F.f3M)(Ut)},providedIn:"root"}),L})();const zt=new F.OlP("appBaseHref");let Ut=(()=>{var b;class L extends mn{constructor(P,G){super(),this._platformLocation=P,this._removeListenerFns=[],this._baseHref=G??this._platformLocation.getBaseHrefFromDOM()??(0,F.f3M)(Je).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(P){this._removeListenerFns.push(this._platformLocation.onPopState(P),this._platformLocation.onHashChange(P))}getBaseHref(){return this._baseHref}prepareExternalUrl(P){return lt(this._baseHref,P)}path(P=!1){const G=this._platformLocation.pathname+ut(this._platformLocation.search),re=this._platformLocation.hash;return re&&P?`${G}${re}`:G}pushState(P,G,re,Ce){const ht=this.prepareExternalUrl(re+ut(Ce));this._platformLocation.pushState(P,G,ht)}replaceState(P,G,re,Ce){const ht=this.prepareExternalUrl(re+ut(Ce));this._platformLocation.replaceState(P,G,ht)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(P=0){this._platformLocation.historyGo?.(P)}}return(b=L).\u0275fac=function(P){return new(P||b)(F.LFG(Tt),F.LFG(zt,8))},b.\u0275prov=F.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),L})(),ai=(()=>{var b;class L extends mn{constructor(P,G){super(),this._platformLocation=P,this._baseHref="",this._removeListenerFns=[],null!=G&&(this._baseHref=G)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(P){this._removeListenerFns.push(this._platformLocation.onPopState(P),this._platformLocation.onHashChange(P))}getBaseHref(){return this._baseHref}path(P=!1){let G=this._platformLocation.hash;return null==G&&(G="#"),G.length>0?G.substring(1):G}prepareExternalUrl(P){const G=lt(this._baseHref,P);return G.length>0?"#"+G:G}pushState(P,G,re,Ce){let ht=this.prepareExternalUrl(re+ut(Ce));0==ht.length&&(ht=this._platformLocation.pathname),this._platformLocation.pushState(P,G,ht)}replaceState(P,G,re,Ce){let ht=this.prepareExternalUrl(re+ut(Ce));0==ht.length&&(ht=this._platformLocation.pathname),this._platformLocation.replaceState(P,G,ht)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(P=0){this._platformLocation.historyGo?.(P)}}return(b=L).\u0275fac=function(P){return new(P||b)(F.LFG(Tt),F.LFG(zt,8))},b.\u0275prov=F.Yz7({token:b,factory:b.\u0275fac}),L})(),Vn=(()=>{var b;class L{constructor(P){this._subject=new F.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=P;const G=this._locationStrategy.getBaseHref();this._basePath=function ke(b){if(new RegExp("^(https?:)?//").test(b)){const[,K]=b.split(/\/\/[^\/]+/);return K}return b}(Be(_i(G))),this._locationStrategy.onPopState(re=>{this._subject.emit({url:this.path(!0),pop:!0,state:re.state,type:re.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(P=!1){return this.normalize(this._locationStrategy.path(P))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(P,G=""){return this.path()==this.normalize(P+ut(G))}normalize(P){return L.stripTrailingSlash(function ni(b,L){if(!b||!L.startsWith(b))return L;const K=L.substring(b.length);return""===K||["/",";","?","#"].includes(K[0])?K:L}(this._basePath,_i(P)))}prepareExternalUrl(P){return P&&"/"!==P[0]&&(P="/"+P),this._locationStrategy.prepareExternalUrl(P)}go(P,G="",re=null){this._locationStrategy.pushState(re,"",P,G),this._notifyUrlChangeListeners(this.prepareExternalUrl(P+ut(G)),re)}replaceState(P,G="",re=null){this._locationStrategy.replaceState(re,"",P,G),this._notifyUrlChangeListeners(this.prepareExternalUrl(P+ut(G)),re)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(P=0){this._locationStrategy.historyGo?.(P)}onUrlChange(P){return this._urlChangeListeners.push(P),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(G=>{this._notifyUrlChangeListeners(G.url,G.state)})),()=>{const G=this._urlChangeListeners.indexOf(P);this._urlChangeListeners.splice(G,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(P="",G){this._urlChangeListeners.forEach(re=>re(P,G))}subscribe(P,G,re){return this._subject.subscribe({next:P,error:G,complete:re})}}return(b=L).normalizeQueryParams=ut,b.joinWithSlash=lt,b.stripTrailingSlash=Be,b.\u0275fac=function(P){return new(P||b)(F.LFG(mn))},b.\u0275prov=F.Yz7({token:b,factory:function(){return function si(){return new Vn((0,F.LFG)(mn))}()},providedIn:"root"}),L})();function _i(b){return b.replace(/\/index.html$/,"")}function Tl(b,L){L=encodeURIComponent(L);for(const K of b.split(";")){const P=K.indexOf("="),[G,re]=-1==P?[K,""]:[K.slice(0,P),K.slice(P+1)];if(G.trim()===L)return decodeURIComponent(re)}return null}let Aa=(()=>{var b;class L{}return(b=L).\u0275fac=function(P){return new(P||b)},b.\u0275mod=F.oAB({type:b}),b.\u0275inj=F.cJS({}),L})();const Bc="browser",os="server";function Ri(b){return b===os}let Xs=(()=>{var b;class L{}return(b=L).\u0275prov=(0,F.Yz7)({token:b,providedIn:"root",factory:()=>new Hi((0,F.LFG)(Je),window)}),L})();class Hi{constructor(L,K){this.document=L,this.window=K,this.offset=()=>[0,0]}setOffset(L){this.offset=Array.isArray(L)?()=>L:L}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(L){this.supportsScrolling()&&this.window.scrollTo(L[0],L[1])}scrollToAnchor(L){if(!this.supportsScrolling())return;const K=function Is(b,L){const K=b.getElementById(L)||b.getElementsByName(L)[0];if(K)return K;if("function"==typeof b.createTreeWalker&&b.body&&"function"==typeof b.body.attachShadow){const P=b.createTreeWalker(b.body,NodeFilter.SHOW_ELEMENT);let G=P.currentNode;for(;G;){const re=G.shadowRoot;if(re){const Ce=re.getElementById(L)||re.querySelector(`[name="${L}"]`);if(Ce)return Ce}G=P.nextNode()}}return null}(this.document,L);K&&(this.scrollToElement(K),K.focus())}setHistoryScrollRestoration(L){this.supportsScrolling()&&(this.window.history.scrollRestoration=L)}scrollToElement(L){const K=L.getBoundingClientRect(),P=K.left+this.window.pageXOffset,G=K.top+this.window.pageYOffset,re=this.offset();this.window.scrollTo(P-re[0],G-re[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class hn{}},946:(On,_t,se)=>{se.d(_t,{tb:()=>QM,AFp:()=>mr,ip1:()=>NS,hGG:()=>ZT,z2F:()=>Uh,Ojb:()=>f0,sBO:()=>NT,Sil:()=>nT,EJc:()=>Qw,Xts:()=>ru,SBq:()=>vc,lqb:()=>ua,qLn:()=>ul,vpe:()=>Va,XFs:()=>Mt,OlP:()=>di,zs3:()=>so,ZZ4:()=>sx,aQg:()=>ox,soG:()=>Ny,YKP:()=>BE,h0i:()=>Yd,PXZ:()=>TT,R0b:()=>jr,FiY:()=>mf,Lbi:()=>da,g9A:()=>Xg,Qsj:()=>ev,FYo:()=>cl,JOm:()=>Sf,tp0:()=>gf,Rgc:()=>Om,dDg:()=>ET,eoX:()=>zS,GfV:()=>nv,s_b:()=>Py,ifc:()=>Cs,VuI:()=>aA,MMx:()=>VE,Lck:()=>Ob,eFA:()=>$S,f3M:()=>ri,$WT:()=>Ur,_c5:()=>qT,qFp:()=>lA,rg0:()=>fr,c2e:()=>OS,zSh:()=>Ap,HDt:()=>FS,wAp:()=>ne,vHH:()=>Nt,lri:()=>HS,rWj:()=>VS,cg1:()=>Wt,kL8:()=>ln,dqk:()=>Di,Z0I:()=>$a,eJc:()=>GM,QGY:()=>wu,F4k:()=>Dh,RDi:()=>H_,AaK:()=>Dt,Xq5:()=>Gv,TTD:()=>ar,jDz:()=>zE,xp6:()=>vv,uIk:()=>$v,Suo:()=>hS,Xpm:()=>wa,lG2:()=>$s,Yz7:()=>oi,cJS:()=>zn,oAB:()=>Za,Yjl:()=>kc,Y36:()=>pu,_UZ:()=>bu,qZA:()=>Gd,TgZ:()=>pm,n5z:()=>Gm,LFG:()=>ur,$8M:()=>Jh,$Z:()=>_v,NdJ:()=>oy,CRH:()=>pS,kcU:()=>zl,O4$:()=>Ot,Q6J:()=>Ah,iGM:()=>dS,P3R:()=>Og,_uU:()=>by,Gf:()=>fS});var F=se(645),Ie=se(394),Ae=se(592),at=se(537),je=se(829),Je=se(232),Tt=se(564),Tn=se(715),lt=se(619),Be=se(96),ut=se(305),mn=se(360);function zt(n={}){const{connector:i=(()=>new F.x),resetOnError:s=!0,resetOnComplete:c=!0,resetOnRefCountZero:d=!0}=n;return h=>{let g,M,T,U=0,V=!1,J=!1;const oe=()=>{M?.unsubscribe(),M=void 0},de=()=>{oe(),g=T=void 0,V=J=!1},Pe=()=>{const Qe=g;de(),Qe?.unsubscribe()};return(0,mn.e)((Qe,wt)=>{U++,!J&&!V&&oe();const qt=T=T??i();wt.add(()=>{U--,0===U&&!J&&!V&&(M=Ut(Pe,d))}),qt.subscribe(wt),!g&&U>0&&(g=new ut.Hp({next:We=>qt.next(We),error:We=>{J=!0,oe(),M=Ut(de,s,We),qt.error(We)},complete:()=>{V=!0,oe(),M=Ut(de,c),qt.complete()}}),(0,je.Xf)(Qe).subscribe(g))})(h)}}function Ut(n,i,...s){if(!0===i)return void n();if(!1===i)return;const c=new ut.Hp({next:()=>{c.unsubscribe(),n()}});return(0,je.Xf)(i(...s)).subscribe(c)}var ai=se(535),Vn=se(737),si=se(251);function _i(n,i){return n===i}function ke(n){for(let i in n)if(n[i]===ke)return i;throw Error("Could not find renamed property on target object.")}function Dt(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Dt).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const i=n.toString();if(null==i)return""+i;const s=i.indexOf("\n");return-1===s?i:i.substring(0,s)}function yn(n,i){return null==n||""===n?null===i?"":i:null==i||""===i?n:n+" "+i}const Et=ke({__forward_ref__:ke});function ft(n){return n.__forward_ref__=ft,n.toString=function(){return Dt(this())},n}function ot(n){return Zt(n)?n():n}function Zt(n){return"function"==typeof n&&n.hasOwnProperty(Et)&&n.__forward_ref__===ft}function cr(n){return n&&!!n.\u0275providers}const fs="https://g.co/ng/security#xss";class Nt extends Error{constructor(i,s){super(function hs(n,i){return`NG0${Math.abs(n)}${i?": "+i:""}`}(i,s)),this.code=i}}function Kt(n){return"string"==typeof n?n:null==n?"":String(n)}function Le(n,i){throw new Nt(-201,!1)}function hi(n,i){null==n&&function nn(n,i,s,c){throw new Error(`ASSERTION ERROR: ${n}`+(null==c?"":` [Expected=> ${s} ${c} ${i} <=Actual]`))}(i,n,null,"!=")}function oi(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function zn(n){return{providers:n.providers||[],imports:n.imports||[]}}function Fn(n){return on(n,bi)||on(n,pi)}function $a(n){return null!==Fn(n)}function on(n,i){return n.hasOwnProperty(i)?n[i]:null}function Ar(n){return n&&(n.hasOwnProperty(go)||n.hasOwnProperty(er))?n[go]:null}const bi=ke({\u0275prov:ke}),go=ke({\u0275inj:ke}),pi=ke({ngInjectableDef:ke}),er=ke({ngInjectorDef:ke});var Mt=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Mt||{});let Ts;function $i(n){const i=Ts;return Ts=n,i}function zo(n,i,s){const c=Fn(n);return c&&"root"==c.providedIn?void 0===c.value?c.value=c.factory():c.value:s&Mt.Optional?null:void 0!==i?i:void Le(Dt(n))}const Di=globalThis,kt={},un="__NG_DI_FLAG__",Mn="ngTempTokenPath",ui=/\n/gm,ps="__source";let yr;function As(n){const i=yr;return yr=n,i}function Xa(n,i=Mt.Default){if(void 0===yr)throw new Nt(-203,!1);return null===yr?zo(n,void 0,i):yr.get(n,i&Mt.Optional?null:void 0,i)}function ur(n,i=Mt.Default){return(function Zn(){return Ts}()||Xa)(ot(n),i)}function ri(n,i=Mt.Default){return ur(n,zs(i))}function zs(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function _o(n){const i=[];for(let s=0;s<n.length;s++){const c=ot(n[s]);if(Array.isArray(c)){if(0===c.length)throw new Nt(900,!1);let d,h=Mt.Default;for(let g=0;g<c.length;g++){const M=c[g],T=Ic(M);"number"==typeof T?-1===T?d=M.token:h|=T:d=M}i.push(ur(d,h))}else i.push(ur(c))}return i}function Gs(n,i){return n[un]=i,n.prototype[un]=i,n}function Ic(n){return n[un]}function Yr(n){return{toString:n}.toString()}var Mo=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(Mo||{}),Cs=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Cs||{});const rs={},Rn=[],Ma=ke({\u0275cmp:ke}),xa=ke({\u0275dir:ke}),$o=ke({\u0275pipe:ke}),Ea=ke({\u0275mod:ke}),Cr=ke({\u0275fac:ke}),Ws=ke({__NG_ELEMENT_ID__:ke}),Sa=ke({__NG_ENV_ID__:ke});function Xo(n,i,s){let c=n.length;for(;;){const d=n.indexOf(i,s);if(-1===d)return d;if(0===d||n.charCodeAt(d-1)<=32){const h=i.length;if(d+h===c||n.charCodeAt(d+h)<=32)return d}s=d+1}}function Yo(n,i,s){let c=0;for(;c<s.length;){const d=s[c];if("number"==typeof d){if(0!==d)break;c++;const h=s[c++],g=s[c++],M=s[c++];n.setAttribute(i,g,M,h)}else{const h=d,g=s[++c];Rc(h)?n.setProperty(i,h,g):n.setAttribute(i,h,g),c++}}return c}function qo(n){return 3===n||4===n||6===n}function Rc(n){return 64===n.charCodeAt(0)}function ba(n,i){if(null!==i&&0!==i.length)if(null===n||0===n.length)n=i.slice();else{let s=-1;for(let c=0;c<i.length;c++){const d=i[c];"number"==typeof d?s=d:0===s||Ya(n,s,d,null,-1===s||2===s?i[++c]:null)}}return n}function Ya(n,i,s,c,d){let h=0,g=n.length;if(-1===i)g=-1;else for(;h<n.length;){const M=n[h++];if("number"==typeof M){if(M===i){g=-1;break}if(M>i){g=h-1;break}}}for(;h<n.length;){const M=n[h];if("number"==typeof M)break;if(M===s){if(null===c)return void(null!==d&&(n[h+1]=d));if(c===n[h+1])return void(n[h+2]=d)}h++,null!==c&&h++,null!==d&&h++}-1!==g&&(n.splice(g,0,i),h=g+1),n.splice(h++,0,s),null!==c&&n.splice(h++,0,c),null!==d&&n.splice(h++,0,d)}const Pc="ng-template";function Zo(n,i,s){let c=0,d=!0;for(;c<n.length;){let h=n[c++];if("string"==typeof h&&d){const g=n[c++];if(s&&"class"===h&&-1!==Xo(g.toLowerCase(),i,0))return!0}else{if(1===h){for(;c<n.length&&"string"==typeof(h=n[c++]);)if(h.toLowerCase()===i)return!0;return!1}"number"==typeof h&&(d=!1)}}return!1}function Al(n){return 4===n.type&&n.value!==Pc}function Lc(n,i,s){return i===(4!==n.type||s?n.value:Pc)}function ss(n,i,s){let c=4;const d=n.attrs||[],h=function qa(n){for(let i=0;i<n.length;i++)if(qo(n[i]))return i;return n.length}(d);let g=!1;for(let M=0;M<i.length;M++){const T=i[M];if("number"!=typeof T){if(!g)if(4&c){if(c=2|1&c,""!==T&&!Lc(n,T,s)||""===T&&1===i.length){if(Fr(c))return!1;g=!0}}else{const U=8&c?T:i[++M];if(8&c&&null!==n.attrs){if(!Zo(n.attrs,U,s)){if(Fr(c))return!1;g=!0}continue}const J=Nc(8&c?"class":T,d,Al(n),s);if(-1===J){if(Fr(c))return!1;g=!0;continue}if(""!==U){let oe;oe=J>h?"":d[J+1].toLowerCase();const de=8&c?oe:null;if(de&&-1!==Xo(de,U,0)||2&c&&U!==oe){if(Fr(c))return!1;g=!0}}}}else{if(!g&&!Fr(c)&&!Fr(T))return!1;if(g&&Fr(T))continue;g=!1,c=T|1&c}}return Fr(c)||g}function Fr(n){return 0==(1&n)}function Nc(n,i,s,c){if(null===i)return-1;let d=0;if(c||!s){let h=!1;for(;d<i.length;){const g=i[d];if(g===n)return d;if(3===g||6===g)h=!0;else{if(1===g||2===g){let M=i[++d];for(;"string"==typeof M;)M=i[++d];continue}if(4===g)break;if(0===g){d+=4;continue}}d+=h?1:2}return-1}return function js(n,i){let s=n.indexOf(4);if(s>-1)for(s++;s<n.length;){const c=n[s];if("number"==typeof c)return-1;if(c===i)return s;s++}return-1}(i,n)}function xo(n,i,s=!1){for(let c=0;c<i.length;c++)if(ss(n,i[c],s))return!0;return!1}function qr(n,i){return n?":not("+i.trim()+")":i}function Ko(n){let i=n[0],s=1,c=2,d="",h=!1;for(;s<n.length;){let g=n[s];if("string"==typeof g)if(2&c){const M=n[++s];d+="["+g+(M.length>0?'="'+M+'"':"")+"]"}else 8&c?d+="."+g:4&c&&(d+=" "+g);else""!==d&&!Fr(g)&&(i+=qr(h,d),d=""),c=g,h=h||!Fr(c);s++}return""!==d&&(i+=qr(h,d)),i}function wa(n){return Yr(()=>{const i=Oi(n),s={...i,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Mo.OnPush,directiveDefs:null,pipeDefs:null,dependencies:i.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Cs.Emulated,styles:n.styles||Rn,_:null,schemas:n.schemas||null,tView:null,id:""};Ta(s);const c=n.dependencies;return s.directiveDefs=Aa(c,!1),s.pipeDefs=Aa(c,!0),s.id=function os(n){let i=0;const s=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const d of s)i=Math.imul(31,i)+d.charCodeAt(0)<<0;return i+=2147483648,"c"+i}(s),s})}function Cl(n){return $n(n)||xi(n)}function Iu(n){return null!==n}function Za(n){return Yr(()=>({type:n.type,bootstrap:n.bootstrap||Rn,declarations:n.declarations||Rn,imports:n.imports||Rn,exports:n.exports||Rn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Uc(n,i){if(null==n)return rs;const s={};for(const c in n)if(n.hasOwnProperty(c)){let d=n[c],h=d;Array.isArray(d)&&(h=d[1],d=d[0]),s[d]=c,i&&(i[d]=h)}return s}function $s(n){return Yr(()=>{const i=Oi(n);return Ta(i),i})}function kc(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function $n(n){return n[Ma]||null}function xi(n){return n[xa]||null}function tr(n){return n[$o]||null}function Ur(n){const i=$n(n)||xi(n)||tr(n);return null!==i&&i.standalone}function _n(n,i){const s=n[Ea]||null;if(!s&&!0===i)throw new Error(`Type ${Dt(n)} does not have '\u0275mod' property.`);return s}function Oi(n){const i={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:i,inputTransforms:null,inputConfig:n.inputs||rs,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||Rn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Uc(n.inputs,i),outputs:Uc(n.outputs)}}function Ta(n){n.features?.forEach(i=>i(n))}function Aa(n,i){if(!n)return null;const s=i?tr:Cl;return()=>("function"==typeof n?n():n).map(c=>s(c)).filter(Iu)}const mi=0,At=1,xn=2,Ri=3,Dr=4,Ka=5,Ir=6,Xs=7,Hi=8,Is=9,Ca=10,hn=11,Da=12,Qo=13,Ia=14,wi=15,ea=16,ta=17,nr=18,Ra=19,Ru=20,gs=21,kr=22,Ja=23,Hc=24,Un=25,Dl=1,Bh=2,So=7,Qa=9,ir=11;function rr(n){return Array.isArray(n)&&"object"==typeof n[Dl]}function Pi(n){return Array.isArray(n)&&!0===n[Dl]}function ci(n){return 0!=(4&n.flags)}function wo(n){return n.componentOffset>-1}function Br(n){return 1==(1&n.flags)}function Gn(n){return!!n.template}function Rr(n){return 0!=(512&n[xn])}function Re(n,i){return n.hasOwnProperty(Cr)?n[Cr]:null}let dr=null,Ys=!1;function _r(n){const i=dr;return dr=n,i}const Wc={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function To(n){if(!Rs(n)||n.dirty){if(!n.producerMustRecompute(n)&&!Nu(n))return void(n.dirty=!1);n.producerRecomputeValue(n),n.dirty=!1}}function jc(n){n.dirty=!0,function ra(n){if(void 0===n.liveConsumerNode)return;const i=Ys;Ys=!0;try{for(const s of n.liveConsumerNode)s.dirty||jc(s)}finally{Ys=i}}(n),n.consumerMarkedDirty?.(n)}function Zs(n){return n&&(n.nextProducerIndex=0),_r(n)}function rc(n,i){if(_r(i),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(Rs(n))for(let s=n.nextProducerIndex;s<n.producerNode.length;s++)sr(n.producerNode[s],n.producerIndexOfThis[s]);for(let s=n.nextProducerIndex;s<n.producerNode.length;s++)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Nu(n){Ks(n);for(let i=0;i<n.producerNode.length;i++){const s=n.producerNode[i],c=n.producerLastReadVersion[i];if(c!==s.version||(To(s),c!==s.version))return!0}return!1}function Ou(n){if(Ks(n),Rs(n))for(let i=0;i<n.producerNode.length;i++)sr(n.producerNode[i],n.producerIndexOfThis[i]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function sr(n,i){if(function Ol(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}(n),Ks(n),1===n.liveConsumerNode.length)for(let c=0;c<n.producerNode.length;c++)sr(n.producerNode[c],n.producerIndexOfThis[c]);const s=n.liveConsumerNode.length-1;if(n.liveConsumerNode[i]=n.liveConsumerNode[s],n.liveConsumerIndexOfThis[i]=n.liveConsumerIndexOfThis[s],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,i<n.liveConsumerNode.length){const c=n.liveConsumerIndexOfThis[i],d=n.liveConsumerNode[i];Ks(d),d.producerIndexOfThis[c]=i}}function Rs(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Ks(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}let P=null;function fr(n){const i=_r(null);try{return n()}finally{_r(i)}}const Zr=()=>{},or={...Wc,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{n.schedule(n.ref)},hasRun:!1,cleanupFn:Zr};class Wi{constructor(i,s,c){this.previousValue=i,this.currentValue=s,this.firstChange=c}isFirstChange(){return this.firstChange}}function ar(){return sa}function sa(n){return n.type.prototype.ngOnChanges&&(n.setInput=Na),oc}function oc(){const n=Ao(this),i=n?.current;if(i){const s=n.previous;if(s===rs)n.previous=i;else for(let c in i)s[c]=i[c];n.current=null,this.ngOnChanges(i)}}function Na(n,i,s,c){const d=this.declaredInputs[s],h=Ao(n)||function Uu(n,i){return n[ac]=i}(n,{previous:rs,current:null}),g=h.current||(h.current={}),M=h.previous,T=M[d];g[d]=new Wi(T&&T.currentValue,i,M===rs),n[c]=i}ar.ngInherit=!0;const ac="__ngSimpleChanges__";function Ao(n){return n[ac]||null}const vs=function(n,i,s){},zr="svg";function vi(n){for(;Array.isArray(n);)n=n[mi];return n}function Lr(n,i){return vi(i[n.index])}function kl(n,i){return n.data[i]}function Ht(n,i){const s=i[n];return rr(s)?s:s[mi]}function oa(n,i){return null==i?null:n[i]}function Co(n){n[ta]=0}function Xc(n){1024&n[xn]||(n[xn]|=1024,tf(n,1))}function as(n){1024&n[xn]&&(n[xn]&=-1025,tf(n,-1))}function tf(n,i){let s=n[Ri];if(null===s)return;s[Ka]+=i;let c=s;for(s=s[Ri];null!==s&&(1===i&&1===c[Ka]||-1===i&&0===c[Ka]);)s[Ka]+=i,c=s,s=s[Ri]}const an={lFrame:H(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Yc(){return an.bindingsEnabled}function qe(){return an.lFrame.lView}function sn(){return an.lFrame.tView}function hr(){let n=Io();for(;null!==n&&64===n.type;)n=n.parent;return n}function Io(){return an.lFrame.currentTNode}function Jr(n,i){const s=an.lFrame;s.currentTNode=n,s.isParent=i}function Zc(){return an.lFrame.isParent}function Oa(){return an.lFrame.bindingIndex++}function It(n,i){const s=an.lFrame;s.bindingIndex=s.bindingRootIndex=n,cs(i)}function cs(n){an.lFrame.currentDirectiveIndex=n}function Wh(){return an.lFrame.currentQueryIndex}function _(n){an.lFrame.currentQueryIndex=n}function S(n){const i=n[At];return 2===i.type?i.declTNode:1===i.type?n[Ir]:null}function C(n,i,s){if(s&Mt.SkipSelf){let d=i,h=n;for(;!(d=d.parent,null!==d||s&Mt.Host||(d=S(h),null===d||(h=h[Ia],10&d.type))););if(null===d)return!1;i=d,n=h}const c=an.lFrame=R();return c.currentTNode=i,c.lView=n,!0}function E(n){const i=R(),s=n[At];an.lFrame=i,i.currentTNode=s.firstChild,i.lView=n,i.tView=s,i.contextLView=n,i.bindingIndex=s.bindingStartIndex,i.inI18n=!1}function R(){const n=an.lFrame,i=null===n?null:n.child;return null===i?H(n):i}function H(n){const i={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=i),i}function X(){const n=an.lFrame;return an.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const ue=X;function Ve(){const n=X();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function en(){return an.lFrame.selectedIndex}function Ti(n){an.lFrame.selectedIndex=n}function cn(){const n=an.lFrame;return kl(n.tView,n.selectedIndex)}function Ot(){an.lFrame.currentNamespace=zr}function zl(){!function Mr(){an.lFrame.currentNamespace=null}()}let Fa=!0;function Qr(){return Fa}function io(n){Fa=n}function Bn(n,i){for(let s=i.directiveStart,c=i.directiveEnd;s<c;s++){const h=n.data[s].type.prototype,{ngAfterContentInit:g,ngAfterContentChecked:M,ngAfterViewInit:T,ngAfterViewChecked:U,ngOnDestroy:V}=h;g&&(n.contentHooks??=[]).push(-s,g),M&&((n.contentHooks??=[]).push(s,M),(n.contentCheckHooks??=[]).push(s,M)),T&&(n.viewHooks??=[]).push(-s,T),U&&((n.viewHooks??=[]).push(s,U),(n.viewCheckHooks??=[]).push(s,U)),null!=V&&(n.destroyHooks??=[]).push(s,V)}}function $u(n,i,s){jh(n,i,3,s)}function ca(n,i,s,c){(3&n[xn])===s&&jh(n,i,s,c)}function Wl(n,i){let s=n[xn];(3&s)===i&&(s&=8191,s+=1,n[xn]=s)}function jh(n,i,s,c){const h=c??-1,g=i.length-1;let M=0;for(let T=void 0!==c?65535&n[ta]:0;T<g;T++)if("number"==typeof i[T+1]){if(M=i[T],null!=c&&M>=c)break}else i[T]<0&&(n[ta]+=65536),(M<h||-1==h)&&(jl(n,s,i,T),n[ta]=(4294901760&n[ta])+T+2),T++}function Qc(n,i){vs(4,n,i);const s=_r(null);try{i.call(n)}finally{_r(s),vs(5,n,i)}}function jl(n,i,s,c){const d=s[c]<0,h=s[c+1],M=n[d?-s[c]:s[c]];d?n[xn]>>13<n[ta]>>16&&(3&n[xn])===i&&(n[xn]+=8192,Qc(M,h)):Qc(M,h)}const Po=-1;class el{constructor(i,s,c){this.factory=i,this.resolving=!1,this.canSeeViewProviders=s,this.injectImpl=c}}function Xl(n){return n!==Po}function pr(n){return 32767&n}function lc(n,i){let s=function Vy(n){return n>>16}(n),c=i;for(;s>0;)c=c[Ia],s--;return c}let uc=!0;function Ua(n){const i=uc;return uc=n,i}const Hm=255,qh=5;let zy=0;const la={};function Lo(n,i){const s=xr(n,i);if(-1!==s)return s;const c=i[At];c.firstCreatePass&&(n.injectorIndex=i.length,Xu(c.data,n),Xu(i,null),Xu(c.blueprint,null));const d=ka(n,i),h=n.injectorIndex;if(Xl(d)){const g=pr(d),M=lc(d,i),T=M[At].data;for(let U=0;U<8;U++)i[h+U]=M[g+U]|T[g+U]}return i[h+8]=d,h}function Xu(n,i){n.push(0,0,0,0,0,0,0,0,i)}function xr(n,i){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===i[n.injectorIndex+8]?-1:n.injectorIndex}function ka(n,i){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let s=0,c=null,d=i;for(;null!==d;){if(c=Wm(d),null===c)return Po;if(s++,d=d[Ia],-1!==c.injectorIndex)return c.injectorIndex|s<<16}return Po}function dc(n,i,s){!function Gy(n,i,s){let c;"string"==typeof s?c=s.charCodeAt(0)||0:s.hasOwnProperty(Ws)&&(c=s[Ws]),null==c&&(c=s[Ws]=zy++);const d=c&Hm;i.data[n+(d>>qh)]|=1<<d}(n,i,s)}function Yu(n,i,s){if(s&Mt.Optional||void 0!==n)return n;Le()}function Vm(n,i,s,c){if(s&Mt.Optional&&void 0===c&&(c=null),!(s&(Mt.Self|Mt.Host))){const d=n[Is],h=$i(void 0);try{return d?d.get(i,c,s&Mt.Optional):zo(i,c,s&Mt.Optional)}finally{$i(h)}}return Yu(c,0,s)}function lf(n,i,s,c=Mt.Default,d){if(null!==n){if(2048&i[xn]&&!(c&Mt.Self)){const g=function Xy(n,i,s,c,d){let h=n,g=i;for(;null!==h&&null!==g&&2048&g[xn]&&!(512&g[xn]);){const M=zm(h,g,s,c|Mt.Self,la);if(M!==la)return M;let T=h.parent;if(!T){const U=g[Ru];if(U){const V=U.get(s,la,c);if(V!==la)return V}T=Wm(g),g=g[Ia]}h=T}return d}(n,i,s,c,la);if(g!==la)return g}const h=zm(n,i,s,c,la);if(h!==la)return h}return Vm(i,s,c,d)}function zm(n,i,s,c,d){const h=function uf(n){if("string"==typeof n)return n.charCodeAt(0)||0;const i=n.hasOwnProperty(Ws)?n[Ws]:void 0;return"number"==typeof i?i>=0?i&Hm:$y:i}(s);if("function"==typeof h){if(!C(i,n,c))return c&Mt.Host?Yu(d,0,c):Vm(i,s,c,d);try{let g;if(g=h(c),null!=g||c&Mt.Optional)return g;Le()}finally{ue()}}else if("number"==typeof h){let g=null,M=xr(n,i),T=Po,U=c&Mt.Host?i[wi][Ir]:null;for((-1===M||c&Mt.SkipSelf)&&(T=-1===M?ka(n,i):i[M+8],T!==Po&&Zh(c,!1)?(g=i[At],M=pr(T),i=lc(T,i)):M=-1);-1!==M;){const V=i[At];if(df(h,M,V.data)){const J=jy(M,i,s,g,c,U);if(J!==la)return J}T=i[M+8],T!==Po&&Zh(c,i[At].data[M+8]===U)&&df(h,M,i)?(g=V,M=pr(T),i=lc(T,i)):M=-1}}return d}function jy(n,i,s,c,d,h){const g=i[At],M=g.data[n+8],V=No(M,g,s,null==c?wo(M)&&uc:c!=g&&0!=(3&M.type),d&Mt.Host&&h===M);return null!==V?Ns(i,g,V,M):la}function No(n,i,s,c,d){const h=n.providerIndexes,g=i.data,M=1048575&h,T=n.directiveStart,V=h>>20,oe=d?M+V:n.directiveEnd;for(let de=c?M:M+V;de<oe;de++){const Pe=g[de];if(de<T&&s===Pe||de>=T&&Pe.type===s)return de}if(d){const de=g[T];if(de&&Gn(de)&&de.type===s)return T}return null}function Ns(n,i,s,c){let d=n[s];const h=i.data;if(function cf(n){return n instanceof el}(d)){const g=d;g.resolving&&function be(n,i){const s=i?`. Dependency path: ${i.join(" > ")} > ${n}`:"";throw new Nt(-200,`Circular dependency in DI detected for ${n}${s}`)}(function In(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Kt(n)}(h[s]));const M=Ua(g.canSeeViewProviders);g.resolving=!0;const U=g.injectImpl?$i(g.injectImpl):null;C(n,c,Mt.Default);try{d=n[s]=g.factory(void 0,h,n,c),i.firstCreatePass&&s>=c.directiveStart&&function Nr(n,i,s){const{ngOnChanges:c,ngOnInit:d,ngDoCheck:h}=i.type.prototype;if(c){const g=sa(i);(s.preOrderHooks??=[]).push(n,g),(s.preOrderCheckHooks??=[]).push(n,g)}d&&(s.preOrderHooks??=[]).push(0-n,d),h&&((s.preOrderHooks??=[]).push(n,h),(s.preOrderCheckHooks??=[]).push(n,h))}(s,h[s],i)}finally{null!==U&&$i(U),Ua(M),g.resolving=!1,ue()}}return d}function df(n,i,s){return!!(s[i+(n>>qh)]&1<<n)}function Zh(n,i){return!(n&Mt.Self||n&Mt.Host&&i)}class ls{constructor(i,s){this._tNode=i,this._lView=s}get(i,s,c){return lf(this._tNode,this._lView,i,zs(c),s)}}function $y(){return new ls(hr(),qe())}function Gm(n){return Yr(()=>{const i=n.prototype.constructor,s=i[Cr]||Kh(i),c=Object.prototype;let d=Object.getPrototypeOf(n.prototype).constructor;for(;d&&d!==c;){const h=d[Cr]||Kh(d);if(h&&h!==s)return h;d=Object.getPrototypeOf(d)}return h=>new h})}function Kh(n){return Zt(n)?()=>{const i=Kh(ot(n));return i&&i()}:Re(n)}function Wm(n){const i=n[At],s=i.type;return 2===s?i.declTNode:1===s?n[Ir]:null}function Jh(n){return function Wy(n,i){if("class"===i)return n.classes;if("style"===i)return n.styles;const s=n.attrs;if(s){const c=s.length;let d=0;for(;d<c;){const h=s[d];if(qo(h))break;if(0===h)d+=2;else if("number"==typeof h)for(d++;d<c&&"string"==typeof s[d];)d++;else{if(h===i)return s[d+1];d+=2}}}return null}(hr(),n)}const ql="__parameters__";function Kl(n,i,s){return Yr(()=>{const c=function Qh(n){return function(...s){if(n){const c=n(...s);for(const d in c)this[d]=c[d]}}}(i);function d(...h){if(this instanceof d)return c.apply(this,h),this;const g=new d(...h);return M.annotation=g,M;function M(T,U,V){const J=T.hasOwnProperty(ql)?T[ql]:Object.defineProperty(T,ql,{value:[]})[ql];for(;J.length<=V;)J.push(null);return(J[V]=J[V]||[]).push(g),T}}return s&&(d.prototype=Object.create(s.prototype)),d.prototype.ngMetadataName=n,d.annotationCls=d,d})}function Ql(n,i){n.forEach(s=>Array.isArray(s)?Ql(s,i):i(s))}function $m(n,i,s){i>=n.length?n.push(s):n.splice(i,0,s)}function hf(n,i){return i>=n.length-1?n.pop():n.splice(i,1)[0]}const mf=Gs(Kl("Optional"),8),gf=Gs(Kl("SkipSelf"),4);function xf(n){return 128==(128&n.flags)}var Sf=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Sf||{});const og=new Map;let Ix=0;const cg="__ngContext__";function us(n,i){rr(i)?(n[cg]=i[Ra],function Px(n){og.set(n[Ra],n)}(i)):n[cg]=i}let lg;function ug(n,i){return lg(n,i)}function wf(n){const i=n[Ri];return Pi(i)?i[Ri]:i}function R_(n){return L_(n[Da])}function P_(n){return L_(n[Dr])}function L_(n){for(;null!==n&&!Pi(n);)n=n[Dr];return n}function Qu(n,i,s,c,d){if(null!=c){let h,g=!1;Pi(c)?h=c:rr(c)&&(g=!0,c=c[mi]);const M=vi(c);0===n&&null!==s?null==d?il(i,s,M):ks(i,s,M,d||null,!0):1===n&&null!==s?ks(i,s,M,d||null,!0):2===n?function Pf(n,i,s){const c=ed(n,i);c&&function fg(n,i,s,c){n.removeChild(i,s,c)}(n,c,i,s)}(i,M,g):3===n&&i.destroyNode(M),null!=h&&function yg(n,i,s,c,d){const h=s[So];h!==vi(s)&&Qu(i,n,c,h,d);for(let M=ir;M<s.length;M++){const T=s[M];id(T[At],T,n,i,c,h)}}(i,n,h,s,d)}}function Us(n,i,s){return n.createElement(i,s)}function dg(n,i){const s=n[Qa],c=s.indexOf(i);as(i),s.splice(c,1)}function tl(n,i){if(n.length<=ir)return;const s=ir+i,c=n[s];if(c){const d=c[ea];null!==d&&d!==n&&dg(d,c),i>0&&(n[s-1][Dr]=c[Dr]);const h=hf(n,ir+i);!function Tf(n,i){id(n,i,i[hn],2,null,null),i[mi]=null,i[Ir]=null}(c[At],c);const g=h[nr];null!==g&&g.detachView(h[At]),c[Ri]=null,c[Dr]=null,c[xn]&=-129}return c}function fc(n,i){if(!(256&i[xn])){const s=i[hn];i[Ja]&&Ou(i[Ja]),i[Hc]&&Ou(i[Hc]),s.destroyNode&&id(n,i,s,3,null,null),function F_(n){let i=n[Da];if(!i)return Af(n[At],n);for(;i;){let s=null;if(rr(i))s=i[Da];else{const c=i[ir];c&&(s=c)}if(!s){for(;i&&!i[Dr]&&i!==n;)rr(i)&&Af(i[At],i),i=i[Ri];null===i&&(i=n),rr(i)&&Af(i[At],i),s=i&&i[Dr]}i=s}}(i)}}function Af(n,i){if(!(256&i[xn])){i[xn]&=-129,i[xn]|=256,function op(n,i){let s;if(null!=n&&null!=(s=n.destroyHooks))for(let c=0;c<s.length;c+=2){const d=i[s[c]];if(!(d instanceof el)){const h=s[c+1];if(Array.isArray(h))for(let g=0;g<h.length;g+=2){const M=d[h[g]],T=h[g+1];vs(4,M,T);try{T.call(M)}finally{vs(5,M,T)}}else{vs(4,d,h);try{h.call(d)}finally{vs(5,d,h)}}}}}(n,i),function nl(n,i){const s=n.cleanup,c=i[Xs];if(null!==s)for(let h=0;h<s.length-1;h+=2)if("string"==typeof s[h]){const g=s[h+3];g>=0?c[g]():c[-g].unsubscribe(),h+=2}else s[h].call(c[s[h+1]]);null!==c&&(i[Xs]=null);const d=i[gs];if(null!==d){i[gs]=null;for(let h=0;h<d.length;h++)(0,d[h])()}}(n,i),1===i[At].type&&i[hn].destroy();const s=i[ea];if(null!==s&&Pi(i[Ri])){s!==i[Ri]&&dg(s,i);const c=i[nr];null!==c&&c.detachView(n)}!function Lx(n){og.delete(n[Ra])}(i)}}function Cf(n,i,s){return function Df(n,i,s){let c=i;for(;null!==c&&40&c.type;)c=(i=c).parent;if(null===c)return s[mi];{const{componentOffset:d}=c;if(d>-1){const{encapsulation:h}=n.data[c.directiveStart+d];if(h===Cs.None||h===Cs.Emulated)return null}return Lr(c,s)}}(n,i.parent,s)}function ks(n,i,s,c,d){n.insertBefore(i,s,c,d)}function il(n,i,s){n.appendChild(i,s)}function ap(n,i,s,c,d){null!==c?ks(n,i,s,c,d):il(n,i,s)}function ed(n,i){return n.parentNode(i)}let td,gp,Nf,lp=function cp(n,i,s){return 40&n.type?Lr(n,s):null};function Rf(n,i,s,c){const d=Cf(n,c,i),h=i[hn],M=function hg(n,i,s){return lp(n,i,s)}(c.parent||i[Ir],c,i);if(null!=d)if(Array.isArray(s))for(let T=0;T<s.length;T++)ap(h,d,s[T],M,!1);else ap(h,d,s,M,!1);void 0!==td&&td(h,c,i,s,d)}function nd(n,i){if(null!==i){const s=i.type;if(3&s)return Lr(i,n);if(4&s)return up(-1,n[i.index]);if(8&s){const c=i.child;if(null!==c)return nd(n,c);{const d=n[i.index];return Pi(d)?up(-1,d):vi(d)}}if(32&s)return ug(i,n)()||vi(n[i.index]);{const c=mg(n,i);return null!==c?Array.isArray(c)?c[0]:nd(wf(n[wi]),c):nd(n,i.next)}}return null}function mg(n,i){return null!==i?n[wi][Ir].projection[i.projection]:null}function up(n,i){const s=ir+n+1;if(s<i.length){const c=i[s],d=c[At].firstChild;if(null!==d)return nd(c,d)}return i[So]}function dp(n,i,s,c,d,h,g){for(;null!=s;){const M=c[s.index],T=s.type;if(g&&0===i&&(M&&us(vi(M),c),s.flags|=2),32!=(32&s.flags))if(8&T)dp(n,i,s.child,c,d,h,!1),Qu(i,n,d,M,h);else if(32&T){const U=ug(s,c);let V;for(;V=U();)Qu(i,n,d,V,h);Qu(i,n,d,M,h)}else 16&T?fp(n,i,c,s,d,h):Qu(i,n,d,M,h);s=g?s.projectionNext:s.next}}function id(n,i,s,c,d,h){dp(s,c,n.firstChild,i,d,h,!1)}function fp(n,i,s,c,d,h){const g=s[wi],T=g[Ir].projection[c.projection];if(Array.isArray(T))for(let U=0;U<T.length;U++)Qu(i,n,d,T[U],h);else{let U=T;const V=g[Ri];xf(c)&&(U.flags|=128),dp(n,i,U,V,d,h,!0)}}function hp(n,i,s){""===s?n.removeAttribute(i,"class"):n.setAttribute(i,"class",s)}function pp(n,i,s){const{mergedAttrs:c,classes:d,styles:h}=s;null!==c&&Yo(n,i,c),null!==d&&hp(n,i,d),null!==h&&function Mg(n,i,s){n.setAttribute(i,"style",s)}(n,i,h)}function H_(n){gp=n}function Sg(n){return function vp(){if(void 0===Nf&&(Nf=null,Di.trustedTypes))try{Nf=Di.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Nf}()?.createScriptURL(n)||n}class bg{constructor(i){this.changingThisBreaksApplicationSecurity=i}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${fs})`}}function hc(n){return n instanceof bg?n.changingThisBreaksApplicationSecurity:n}function sd(n,i){const s=function $_(n){return n instanceof bg&&n.getTypeName()||null}(n);if(null!=s&&s!==i){if("ResourceURL"===s&&"URL"===i)return!0;throw new Error(`Required a safe ${i}, got a ${s} (see ${fs})`)}return s===i}const Z_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var rl=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(rl||{});function Rg(n){const i=ud();return i?i.sanitize(rl.URL,n)||"":sd(n,"URL")?hc(n):function yp(n){return(n=String(n)).match(Z_)?n:"unsafe:"+n}(Kt(n))}function Pg(n){const i=ud();if(i)return Sg(i.sanitize(rl.RESOURCE_URL,n)||"");if(sd(n,"ResourceURL"))return Sg(hc(n));throw new Nt(904,!1)}function Og(n,i,s){return function Ng(n,i){return"src"===i&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===i&&("base"===n||"link"===n)?Pg:Rg}(i,s)(n)}function ud(){const n=qe();return n&&n[Ca].sanitizer}class di{constructor(i,s){this._desc=i,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof s?this.__NG_ELEMENT_ID__=s:void 0!==s&&(this.\u0275prov=oi({token:this,providedIn:s.providedIn||"root",factory:s.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const ru=new di("ENVIRONMENT_INITIALIZER"),Ug=new di("INJECTOR",-1),Sp=new di("INJECTOR_DEF_TYPES");class bp{get(i,s=kt){if(s===kt){const c=new Error(`NullInjectorError: No provider for ${Dt(i)}!`);throw c.name="NullInjectorError",c}return s}}function s0(...n){return{\u0275providers:Bg(0,n),\u0275fromNgModule:!0}}function Bg(n,...i){const s=[],c=new Set;let d;const h=g=>{s.push(g)};return Ql(i,g=>{const M=g;Of(M,h,[],c)&&(d||=[],d.push(M))}),void 0!==d&&Hg(d,h),s}function Hg(n,i){for(let s=0;s<n.length;s++){const{ngModule:c,providers:d}=n[s];wp(d,h=>{i(h,c)})}}function Of(n,i,s,c){if(!(n=ot(n)))return!1;let d=null,h=Ar(n);const g=!h&&$n(n);if(h||g){if(g&&!g.standalone)return!1;d=n}else{const T=n.ngModule;if(h=Ar(T),!h)return!1;d=T}const M=c.has(d);if(g){if(M)return!1;if(c.add(d),g.dependencies){const T="function"==typeof g.dependencies?g.dependencies():g.dependencies;for(const U of T)Of(U,i,s,c)}}else{if(!h)return!1;{if(null!=h.imports&&!M){let U;c.add(d);try{Ql(h.imports,V=>{Of(V,i,s,c)&&(U||=[],U.push(V))})}finally{}void 0!==U&&Hg(U,i)}if(!M){const U=Re(d)||(()=>new d);i({provide:d,useFactory:U,deps:Rn},d),i({provide:Sp,useValue:d,multi:!0},d),i({provide:ru,useValue:()=>ur(d),multi:!0},d)}const T=h.providers;if(null!=T&&!M){const U=n;wp(T,V=>{i(V,U)})}}}return d!==n&&void 0!==n.providers}function wp(n,i){for(let s of n)cr(s)&&(s=s.\u0275providers),Array.isArray(s)?wp(s,i):i(s)}const o0=ke({provide:String,useValue:ke});function Tp(n){return null!==n&&"object"==typeof n&&o0 in n}function pc(n){return"function"==typeof n}const Ap=new di("Set Injector scope."),Ff={},a0={};let Cp;function Uf(){return void 0===Cp&&(Cp=new bp),Cp}class ua{}class dd extends ua{get destroyed(){return this._destroyed}constructor(i,s,c,d){super(),this.parent=s,this.source=c,this.scopes=d,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Ip(i,g=>this.processProvider(g)),this.records.set(Ug,su(void 0,this)),d.has("environment")&&this.records.set(ua,su(void 0,this));const h=this.records.get(Ap);null!=h&&"string"==typeof h.value&&this.scopes.add(h.value),this.injectorDefTypes=new Set(this.get(Sp.multi,Rn,Mt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const s of this._ngOnDestroyHooks)s.ngOnDestroy();const i=this._onDestroyHooks;this._onDestroyHooks=[];for(const s of i)s()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(i){return this.assertNotDestroyed(),this._onDestroyHooks.push(i),()=>this.removeOnDestroy(i)}runInContext(i){this.assertNotDestroyed();const s=As(this),c=$i(void 0);try{return i()}finally{As(s),$i(c)}}get(i,s=kt,c=Mt.Default){if(this.assertNotDestroyed(),i.hasOwnProperty(Sa))return i[Sa](this);c=zs(c);const h=As(this),g=$i(void 0);try{if(!(c&Mt.SkipSelf)){let T=this.records.get(i);if(void 0===T){const U=function u0(n){return"function"==typeof n||"object"==typeof n&&n instanceof di}(i)&&Fn(i);T=U&&this.injectableDefInScope(U)?su(Dp(i),Ff):null,this.records.set(i,T)}if(null!=T)return this.hydrate(i,T)}return(c&Mt.Self?Uf():this.parent).get(i,s=c&Mt.Optional&&s===kt?null:s)}catch(M){if("NullInjectorError"===M.name){if((M[Mn]=M[Mn]||[]).unshift(Dt(i)),h)throw M;return function Du(n,i,s,c){const d=n[Mn];throw i[ps]&&d.unshift(i[ps]),n.message=function Tl(n,i,s,c=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let d=Dt(i);if(Array.isArray(i))d=i.map(Dt).join(" -> ");else if("object"==typeof i){let h=[];for(let g in i)if(i.hasOwnProperty(g)){let M=i[g];h.push(g+":"+("string"==typeof M?JSON.stringify(M):Dt(M)))}d=`{${h.join(", ")}}`}return`${s}${c?"("+c+")":""}[${d}]: ${n.replace(ui,"\n  ")}`}("\n"+n.message,d,s,c),n.ngTokenPath=d,n[Mn]=null,n}(M,i,"R3InjectorError",this.source)}throw M}finally{$i(g),As(h)}}resolveInjectorInitializers(){const i=As(this),s=$i(void 0);try{const d=this.get(ru.multi,Rn,Mt.Self);for(const h of d)h()}finally{As(i),$i(s)}}toString(){const i=[],s=this.records;for(const c of s.keys())i.push(Dt(c));return`R3Injector[${i.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Nt(205,!1)}processProvider(i){let s=pc(i=ot(i))?i:ot(i&&i.provide);const c=function jg(n){return Tp(n)?su(void 0,n.useValue):su(function $g(n,i,s){let c;if(pc(n)){const d=ot(n);return Re(d)||Dp(d)}if(Tp(n))c=()=>ot(n.useValue);else if(function zg(n){return!(!n||!n.useFactory)}(n))c=()=>n.useFactory(..._o(n.deps||[]));else if(function Vg(n){return!(!n||!n.useExisting)}(n))c=()=>ur(ot(n.useExisting));else{const d=ot(n&&(n.useClass||n.provide));if(!function c0(n){return!!n.deps}(n))return Re(d)||Dp(d);c=()=>new d(..._o(n.deps))}return c}(n),Ff)}(i);if(pc(i)||!0!==i.multi)this.records.get(s);else{let d=this.records.get(s);d||(d=su(void 0,Ff,!0),d.factory=()=>_o(d.multi),this.records.set(s,d)),s=i,d.multi.push(i)}this.records.set(s,c)}hydrate(i,s){return s.value===Ff&&(s.value=a0,s.value=s.factory()),"object"==typeof s.value&&s.value&&function l0(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(s.value)&&this._ngOnDestroyHooks.add(s.value),s.value}injectableDefInScope(i){if(!i.providedIn)return!1;const s=ot(i.providedIn);return"string"==typeof s?"any"===s||this.scopes.has(s):this.injectorDefTypes.has(s)}removeOnDestroy(i){const s=this._onDestroyHooks.indexOf(i);-1!==s&&this._onDestroyHooks.splice(s,1)}}function Dp(n){const i=Fn(n),s=null!==i?i.factory:Re(n);if(null!==s)return s;if(n instanceof di)throw new Nt(204,!1);if(n instanceof Function)return function Wg(n){const i=n.length;if(i>0)throw function Ku(n,i){const s=[];for(let c=0;c<n;c++)s.push(i);return s}(i,"?"),new Nt(204,!1);const s=function Bi(n){return n&&(n[bi]||n[pi])||null}(n);return null!==s?()=>s.factory(n):()=>new n}(n);throw new Nt(204,!1)}function su(n,i,s=!1){return{factory:n,value:i,multi:s?[]:void 0}}function Ip(n,i){for(const s of n)Array.isArray(s)?Ip(s,i):s&&cr(s)?Ip(s.\u0275providers,i):i(s)}const mr=new di("AppId",{providedIn:"root",factory:()=>d0}),d0="ng",Xg=new di("Platform Initializer"),da=new di("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),f0=new di("CSP nonce",{providedIn:"root",factory:()=>function iu(){if(void 0!==gp)return gp;if(typeof document<"u")return document;throw new Nt(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let au=(n,i,s)=>null;function yd(n,i,s=!1){return au(n,i,s)}class cu{}class Gf{}class Op{resolveComponentFactory(i){throw function Jg(n){const i=Error(`No component factory found for ${Dt(n)}.`);return i.ngComponent=n,i}(i)}}let gc=(()=>{class i{}return i.NULL=new Op,i})();function Qg(){return lu(hr(),qe())}function lu(n,i){return new vc(Lr(n,i))}let vc=(()=>{class i{constructor(c){this.nativeElement=c}}return i.__NG_ELEMENT_ID__=Qg,i})();function Md(n){return n instanceof vc?n.nativeElement:n}class cl{}let ev=(()=>{class i{constructor(){this.destroyNode=null}}return i.__NG_ELEMENT_ID__=()=>function jf(){const n=qe(),s=Ht(hr().index,n);return(rr(s)?s:n)[hn]}(),i})(),tv=(()=>{var n;class i{}return(n=i).\u0275prov=oi({token:n,providedIn:"root",factory:()=>null}),i})();class nv{constructor(i){this.full=i,this.major=i.split(".")[0],this.minor=i.split(".")[1],this.patch=i.split(".").slice(2).join(".")}}const xd=new nv("16.2.4"),ll={};function Up(n,i=null,s=null,c){const d=Yf(n,i,s,c);return d.resolveInjectorInitializers(),d}function Yf(n,i=null,s=null,c,d=new Set){const h=[s||Rn,s0(n)];return c=c||("object"==typeof n?void 0:Dt(n)),new dd(h,i||Uf(),c||null,d)}let so=(()=>{var n;class i{static create(c,d){if(Array.isArray(c))return Up({name:""},d,c,"");{const h=c.name??"";return Up({name:h},c.parent,c.providers,h)}}}return(n=i).THROW_IF_NOT_FOUND=kt,n.NULL=new bp,n.\u0275prov=oi({token:n,providedIn:"any",factory:()=>ur(Ug)}),n.__NG_ELEMENT_ID__=-1,i})();function Zf(n){return i=>{setTimeout(n,void 0,i)}}const Va=class cv extends F.x{constructor(i=!1){super(),this.__isAsync=i}emit(i){super.next(i)}subscribe(i,s,c){let d=i,h=s||(()=>null),g=c;if(i&&"object"==typeof i){const T=i;d=T.next?.bind(T),h=T.error?.bind(T),g=T.complete?.bind(T)}this.__isAsync&&(h=Zf(h),d&&(d=Zf(d)),g&&(g=Zf(g)));const M=super.subscribe({next:d,error:h,complete:g});return i instanceof Ie.w0&&i.add(M),M}};function y0(...n){}class jr{constructor({enableLongStackTrace:i=!1,shouldCoalesceEventChangeDetection:s=!1,shouldCoalesceRunChangeDetection:c=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Va(!1),this.onMicrotaskEmpty=new Va(!1),this.onStable=new Va(!1),this.onError=new Va(!1),typeof Zone>"u")throw new Nt(908,!1);Zone.assertZonePatched();const d=this;d._nesting=0,d._outer=d._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(d._inner=d._inner.fork(new Zone.TaskTrackingZoneSpec)),i&&Zone.longStackTraceZoneSpec&&(d._inner=d._inner.fork(Zone.longStackTraceZoneSpec)),d.shouldCoalesceEventChangeDetection=!c&&s,d.shouldCoalesceRunChangeDetection=c,d.lastRequestAnimationFrameId=-1,d.nativeRequestAnimationFrame=function _0(){const n="function"==typeof Di.requestAnimationFrame;let i=Di[n?"requestAnimationFrame":"setTimeout"],s=Di[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&i&&s){const c=i[Zone.__symbol__("OriginalDelegate")];c&&(i=c);const d=s[Zone.__symbol__("OriginalDelegate")];d&&(s=d)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:s}}().nativeRequestAnimationFrame,function M0(n){const i=()=>{!function Bp(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Di,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Sd(n),n.isCheckStableRunning=!0,oo(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Sd(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(s,c,d,h,g,M)=>{if(function uv(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(M))return s.invokeTask(d,h,g,M);try{return bd(n),s.invokeTask(d,h,g,M)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===h.type||n.shouldCoalesceRunChangeDetection)&&i(),Kf(n)}},onInvoke:(s,c,d,h,g,M,T)=>{try{return bd(n),s.invoke(d,h,g,M,T)}finally{n.shouldCoalesceRunChangeDetection&&i(),Kf(n)}},onHasTask:(s,c,d,h)=>{s.hasTask(d,h),c===d&&("microTask"==h.change?(n._hasPendingMicrotasks=h.microTask,Sd(n),oo(n)):"macroTask"==h.change&&(n.hasPendingMacrotasks=h.macroTask))},onHandleError:(s,c,d,h)=>(s.handleError(d,h),n.runOutsideAngular(()=>n.onError.emit(h)),!1)})}(d)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!jr.isInAngularZone())throw new Nt(909,!1)}static assertNotInAngularZone(){if(jr.isInAngularZone())throw new Nt(909,!1)}run(i,s,c){return this._inner.run(i,s,c)}runTask(i,s,c,d){const h=this._inner,g=h.scheduleEventTask("NgZoneEvent: "+d,i,sE,y0,y0);try{return h.runTask(g,s,c)}finally{h.cancelTask(g)}}runGuarded(i,s,c){return this._inner.runGuarded(i,s,c)}runOutsideAngular(i){return this._outer.run(i)}}const sE={};function oo(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Sd(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function bd(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Kf(n){n._nesting--,oo(n)}class Hp{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Va,this.onMicrotaskEmpty=new Va,this.onStable=new Va,this.onError=new Va}run(i,s,c){return i.apply(s,c)}runGuarded(i,s,c){return i.apply(s,c)}runOutsideAngular(i){return i()}runTask(i,s,c,d){return i.apply(s,c)}}const Jf=new di("",{providedIn:"root",factory:lv});function lv(){const n=ri(jr);let i=!0;return function jt(...n){const i=(0,Tt.yG)(n),s=(0,Tt._6)(n,1/0),c=n;return c.length?1===c.length?(0,je.Xf)(c[0]):(0,at.J)(s)((0,Tn.D)(c,i)):Je.E}(new Ae.y(d=>{i=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{d.next(i),d.complete()})}),new Ae.y(d=>{let h;n.runOutsideAngular(()=>{h=n.onStable.subscribe(()=>{jr.assertNotInAngularZone(),queueMicrotask(()=>{!i&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(i=!0,d.next(!0))})})});const g=n.onUnstable.subscribe(()=>{jr.assertInAngularZone(),i&&(i=!1,n.runOutsideAngular(()=>{d.next(!1)}))});return()=>{h.unsubscribe(),g.unsubscribe()}}).pipe(zt()))}function za(n){return n instanceof Function?n():n}let Qf=(()=>{var n;class i{constructor(){this.callbacks=new Set,this.deferredCallbacks=new Set,this.renderDepth=0,this.runningCallbacks=!1}begin(){if(this.runningCallbacks)throw new Nt(102,!1);this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth)try{this.runningCallbacks=!0;for(const c of this.callbacks)c.invoke()}finally{this.runningCallbacks=!1;for(const c of this.deferredCallbacks)this.callbacks.add(c);this.deferredCallbacks.clear()}}register(c){(this.runningCallbacks?this.deferredCallbacks:this.callbacks).add(c)}unregister(c){this.callbacks.delete(c),this.deferredCallbacks.delete(c)}ngOnDestroy(){this.callbacks.clear(),this.deferredCallbacks.clear()}}return(n=i).\u0275prov=oi({token:n,providedIn:"root",factory:()=>new n}),i})();function wd(n){for(;n;){n[xn]|=64;const i=wf(n);if(Rr(n)&&!i)return n;n=i}return null}function th(n){return n.ngOriginalError}class ul{constructor(){this._console=console}handleError(i){const s=this._findOriginalError(i);this._console.error("ERROR",i),s&&this._console.error("ORIGINAL ERROR",s)}_findOriginalError(i){let s=i&&th(i);for(;s&&th(s);)s=th(s);return s||null}}const fv=new di("",{providedIn:"root",factory:()=>!1});let oh=null;function mv(n,i){return n[i]??gv()}function jp(n,i){const s=gv();s.producerNode?.length&&(n[i]=oh,s.lView=n,oh=hu())}const fl={...Wc,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{wd(n.lView)},lView:null};function hu(){return Object.create(fl)}function gv(){return oh??=hu(),oh}const Pn={};function vv(n){yv(sn(),qe(),en()+n,!1)}function yv(n,i,s,c){if(!c)if(3==(3&i[xn])){const h=n.preOrderCheckHooks;null!==h&&$u(i,h,s)}else{const h=n.preOrderHooks;null!==h&&ca(i,h,0,s)}Ti(s)}function pu(n,i=Mt.Default){const s=qe();return null===s?ur(n,i):lf(hr(),s,ot(n),i)}function _v(){throw new Error("invalid")}function ah(n,i,s,c,d,h,g,M,T,U,V){const J=i.blueprint.slice();return J[mi]=d,J[xn]=140|c,(null!==U||n&&2048&n[xn])&&(J[xn]|=2048),Co(J),J[Ri]=J[Ia]=n,J[Hi]=s,J[Ca]=g||n&&n[Ca],J[hn]=M||n&&n[hn],J[Is]=T||n&&n[Is]||null,J[Ir]=h,J[Ra]=function Rx(){return Ix++}(),J[kr]=V,J[Ru]=U,J[wi]=2==i.type?n[wi]:J,J}function mu(n,i,s,c,d){let h=n.data[i];if(null===h)h=function $p(n,i,s,c,d){const h=Io(),g=Zc(),T=n.data[i]=function Sv(n,i,s,c,d,h){let g=i?i.injectorIndex:-1,M=0;return function qc(){return null!==an.skipHydrationRootTNode}()&&(M|=128),{type:s,index:c,insertBeforeIndex:null,injectorIndex:g,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:M,providerIndexes:0,value:d,attrs:h,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:i,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,g?h:h&&h.parent,s,i,c,d);return null===n.firstChild&&(n.firstChild=T),null!==h&&(g?null==h.child&&null!==T.parent&&(h.child=T):null===h.next&&(h.next=T,T.prev=h)),T}(n,i,s,c,d),function Hl(){return an.lFrame.inI18n}()&&(h.flags|=32);else if(64&h.type){h.type=s,h.value=c,h.attrs=d;const g=function to(){const n=an.lFrame,i=n.currentTNode;return n.isParent?i:i.parent}();h.injectorIndex=null===g?-1:g.injectorIndex}return Jr(h,!0),h}function Dd(n,i,s,c){if(0===s)return-1;const d=i.length;for(let h=0;h<s;h++)i.push(c),n.blueprint.push(c),n.data.push(null);return d}function ch(n,i,s,c,d){const h=mv(i,Ja),g=en(),M=2&c;try{Ti(-1),M&&i.length>Un&&yv(n,i,Un,!1),vs(M?2:0,d);const U=M?h:null,V=Zs(U);try{null!==U&&(U.dirty=!1),s(c,d)}finally{rc(U,V)}}finally{M&&null===i[Ja]&&jp(i,Ja),Ti(g),vs(M?3:1,d)}}function Xp(n,i,s){if(ci(i)){const c=_r(null);try{const h=i.directiveEnd;for(let g=i.directiveStart;g<h;g++){const M=n.data[g];M.contentQueries&&M.contentQueries(1,s[g],g)}}finally{_r(c)}}}function Gi(n){const i=n.tView;return null===i||i.incompleteFirstPass?n.tView=gu(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):i}function gu(n,i,s,c,d,h,g,M,T,U,V){const J=Un+c,oe=J+d,de=function Mv(n,i){const s=[];for(let c=0;c<i;c++)s.push(c<n?null:Pn);return s}(J,oe),Pe="function"==typeof U?U():U;return de[At]={type:n,blueprint:de,template:s,queries:null,viewQuery:M,declTNode:i,data:de.slice().fill(null,J),bindingStartIndex:J,expandoStartIndex:oe,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof h?h():h,pipeRegistry:"function"==typeof g?g():g,firstChild:null,schemas:T,consts:Pe,incompleteFirstPass:!1,ssrId:V}}let xv=n=>null;function vu(n,i,s,c){for(let d in n)if(n.hasOwnProperty(d)){s=null===s?{}:s;const h=n[d];null===c?dh(s,i,d,h):c.hasOwnProperty(d)&&dh(s,i,c[d],h)}return s}function dh(n,i,s,c){n.hasOwnProperty(s)?n[s].push(i,c):n[s]=[i,c]}function fh(n,i,s,c,d,h){for(let U=0;U<c.length;U++)dc(Lo(s,i),n,c[U].type);!function C0(n,i,s){n.flags|=1,n.directiveStart=i,n.directiveEnd=i+s,n.providerIndexes=i}(s,n.data.length,c.length);for(let U=0;U<c.length;U++){const V=c[U];V.providersResolver&&V.providersResolver(V)}let g=!1,M=!1,T=Dd(n,i,c.length,null);for(let U=0;U<c.length;U++){const V=c[U];s.mergedAttrs=ba(s.mergedAttrs,V.hostAttrs),Tv(n,s,i,T,V),tm(T,V,d),null!==V.contentQueries&&(s.flags|=4),(null!==V.hostBindings||null!==V.hostAttrs||0!==V.hostVars)&&(s.flags|=64);const J=V.type.prototype;!g&&(J.ngOnChanges||J.ngOnInit||J.ngDoCheck)&&((n.preOrderHooks??=[]).push(s.index),g=!0),!M&&(J.ngOnChanges||J.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(s.index),M=!0),T++}!function A0(n,i,s){const d=i.directiveEnd,h=n.data,g=i.attrs,M=[];let T=null,U=null;for(let V=i.directiveStart;V<d;V++){const J=h[V],oe=s?s.get(J):null,Pe=oe?oe.outputs:null;T=vu(J.inputs,V,T,oe?oe.inputs:null),U=vu(J.outputs,V,U,Pe);const Qe=null===T||null===g||Al(i)?null:D0(T,V,g);M.push(Qe)}null!==T&&(T.hasOwnProperty("class")&&(i.flags|=8),T.hasOwnProperty("style")&&(i.flags|=16)),i.initialInputs=M,i.inputs=T,i.outputs=U}(n,s,h)}function wv(n,i,s){const c=s.directiveStart,d=s.directiveEnd,h=s.index,g=function Gr(){return an.lFrame.currentDirectiveIndex}();try{Ti(h);for(let M=c;M<d;M++){const T=n.data[M],U=i[M];cs(M),(null!==T.hostBindings||0!==T.hostVars||null!==T.hostAttrs)&&ph(T,U)}}finally{Ti(-1),cs(g)}}function ph(n,i){null!==n.hostBindings&&n.hostBindings(1,i)}function Rd(n,i,s){i.componentOffset=s,(n.components??=[]).push(i.index)}function tm(n,i,s){if(s){if(i.exportAs)for(let c=0;c<i.exportAs.length;c++)s[i.exportAs[c]]=n;Gn(i)&&(s[""]=n)}}function Tv(n,i,s,c,d){n.data[c]=d;const h=d.factory||(d.factory=Re(d.type)),g=new el(h,Gn(d),pu);n.blueprint[c]=g,s[c]=g,function hh(n,i,s,c,d){const h=d.hostBindings;if(h){let g=n.hostBindingOpCodes;null===g&&(g=n.hostBindingOpCodes=[]);const M=~i.index;(function Kp(n){let i=n.length;for(;i>0;){const s=n[--i];if("number"==typeof s&&s<0)return s}return 0})(g)!=M&&g.push(M),g.push(s,c,h)}}(n,i,c,Dd(n,s,d.hostVars,Pn),d)}function ha(n,i,s,c,d,h){const g=Lr(n,i);!function nm(n,i,s,c,d,h,g){if(null==h)n.removeAttribute(i,d,s);else{const M=null==g?Kt(h):g(h,c||"",d);n.setAttribute(i,d,M,s)}}(i[hn],g,h,n.value,s,c,d)}function mh(n,i,s,c,d,h){const g=h[i];if(null!==g)for(let M=0;M<g.length;)pa(c,s,g[M++],g[M++],g[M++])}function pa(n,i,s,c,d){const h=_r(null);try{const g=n.inputTransforms;null!==g&&g.hasOwnProperty(c)&&(d=g[c].call(i,d)),null!==n.setInput?n.setInput(i,d,s,c):i[c]=d}finally{_r(h)}}function D0(n,i,s){let c=null,d=0;for(;d<s.length;){const h=s[d];if(0!==h)if(5!==h){if("number"==typeof h)break;if(n.hasOwnProperty(h)){null===c&&(c=[]);const g=n[h];for(let M=0;M<g.length;M+=2)if(g[M]===i){c.push(h,g[M+1],s[d+1]);break}}d+=2}else d+=2;else d+=4}return c}function Dv(n,i){const s=n.contentQueries;if(null!==s)for(let c=0;c<s.length;c+=2){const h=s[c+1];if(-1!==h){const g=n.data[h];_(s[c]),g.contentQueries(2,i[h],h)}}}function gh(n,i){return n[Da]?n[Qo][Dr]=i:n[Da]=i,n[Qo]=i,i}function im(n,i,s){_(0);const c=_r(null);try{i(n,s)}finally{_r(c)}}function Bs(n){return n[Xs]||(n[Xs]=[])}function Mc(n){return n.cleanup||(n.cleanup=[])}function rm(n,i){const s=n[Is],c=s?s.get(ul,null):null;c&&c.handleError(i)}function Pd(n,i,s,c,d){for(let h=0;h<s.length;){const g=s[h++],M=s[h++];pa(n.data[g],i[g],c,M,d)}}function I0(n,i){const s=Ht(i,n),c=s[At];!function R0(n,i){for(let s=i.length;s<n.blueprint.length;s++)i.push(n.blueprint[s])}(c,s);const d=s[mi];null!==d&&null===s[kr]&&(s[kr]=yd(d,s[Is])),Iv(c,s,s[Hi])}function Iv(n,i,s){E(i);try{const c=n.viewQuery;null!==c&&im(1,c,s);const d=n.template;null!==d&&ch(n,i,d,1,s),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Dv(n,i),n.staticViewQueries&&im(2,n.viewQuery,s);const h=n.components;null!==h&&function Ld(n,i){for(let s=0;s<i.length;s++)I0(n,i[s])}(i,h)}catch(c){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),c}finally{i[xn]&=-5,Ve()}}let Rv=(()=>{var n;class i{constructor(){this.all=new Set,this.queue=new Map}create(c,d,h){const g=typeof Zone>"u"?null:Zone.current,M=function Pr(n,i,s){const c=Object.create(or);s&&(c.consumerAllowSignalWrites=!0),c.fn=n,c.schedule=i;const d=g=>{c.cleanupFn=g};return c.ref={notify:()=>jc(c),run:()=>{if(c.dirty=!1,c.hasRun&&!Nu(c))return;c.hasRun=!0;const g=Zs(c);try{c.cleanupFn(),c.cleanupFn=Zr,c.fn(d)}finally{rc(c,g)}},cleanup:()=>c.cleanupFn()},c.ref}(c,V=>{this.all.has(V)&&this.queue.set(V,g)},h);let T;this.all.add(M),M.notify();const U=()=>{M.cleanup(),T?.(),this.all.delete(M),this.queue.delete(M)};return T=d?.onDestroy(U),{destroy:U}}flush(){if(0!==this.queue.size)for(const[c,d]of this.queue)this.queue.delete(c),d?d.run(()=>c.run()):c.run()}get isQueueEmpty(){return 0===this.queue.size}}return(n=i).\u0275prov=oi({token:n,providedIn:"root",factory:()=>new n}),i})();function yh(n,i,s){let c=s?n.styles:null,d=s?n.classes:null,h=0;if(null!==i)for(let g=0;g<i.length;g++){const M=i[g];"number"==typeof M?h=M:1==h?d=yn(d,M):2==h&&(c=yn(c,M+": "+i[++g]+";"))}s?n.styles=c:n.stylesWithoutHost=c,s?n.classes=d:n.classesWithoutHost=d}function Ss(n,i,s,c,d=!1){for(;null!==s;){const h=i[s.index];null!==h&&c.push(vi(h)),Pi(h)&&hl(h,c);const g=s.type;if(8&g)Ss(n,i,s.child,c);else if(32&g){const M=ug(s,i);let T;for(;T=M();)c.push(T)}else if(16&g){const M=mg(i,s);if(Array.isArray(M))c.push(...M);else{const T=wf(i[wi]);Ss(T[At],T,M,c,!0)}}s=d?s.projectionNext:s.next}return c}function hl(n,i){for(let s=ir;s<n.length;s++){const c=n[s],d=c[At].firstChild;null!==d&&Ss(c[At],c,d,i)}n[So]!==n[mi]&&i.push(n[So])}function Nd(n,i,s,c=!0){const d=i[Ca],h=d.rendererFactory,g=d.afterRenderEventManager;h.begin?.(),g?.begin();try{xc(n,i,n.template,s)}catch(T){throw c&&rm(i,T),T}finally{h.end?.(),d.effectManager?.flush(),g?.end()}}function xc(n,i,s,c){const d=i[xn];if(256!=(256&d)){i[Ca].effectManager?.flush(),E(i);try{Co(i),function Ms(n){return an.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==s&&ch(n,i,s,2,c);const g=3==(3&d);if(g){const U=n.preOrderCheckHooks;null!==U&&$u(i,U,null)}else{const U=n.preOrderHooks;null!==U&&ca(i,U,0,null),Wl(i,0)}if(function yu(n){for(let i=R_(n);null!==i;i=P_(i)){if(!i[Bh])continue;const s=i[Qa];for(let c=0;c<s.length;c++){Xc(s[c])}}}(i),pl(i,2),null!==n.contentQueries&&Dv(n,i),g){const U=n.contentCheckHooks;null!==U&&$u(i,U)}else{const U=n.contentHooks;null!==U&&ca(i,U,1),Wl(i,1)}!function w0(n,i){const s=n.hostBindingOpCodes;if(null===s)return;const c=mv(i,Hc);try{for(let d=0;d<s.length;d++){const h=s[d];if(h<0)Ti(~h);else{const g=h,M=s[++d],T=s[++d];It(M,g),c.dirty=!1;const U=Zs(c);try{T(2,i[g])}finally{rc(c,U)}}}}finally{null===i[Hc]&&jp(i,Hc),Ti(-1)}}(n,i);const M=n.components;null!==M&&Nv(i,M,0);const T=n.viewQuery;if(null!==T&&im(2,T,c),g){const U=n.viewCheckHooks;null!==U&&$u(i,U)}else{const U=n.viewHooks;null!==U&&ca(i,U,2),Wl(i,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),i[xn]&=-73,as(i)}finally{Ve()}}}function pl(n,i){for(let s=R_(n);null!==s;s=P_(s))for(let c=ir;c<s.length;c++)Lv(s[c],i)}function Fd(n,i,s){Lv(Ht(i,n),s)}function Lv(n,i){if(!function _s(n){return 128==(128&n[xn])}(n))return;const s=n[At],c=n[xn];if(80&c&&0===i||1024&c||2===i)xc(s,n,s.template,n[Hi]);else if(n[Ka]>0){pl(n,1);const d=s.components;null!==d&&Nv(n,d,1)}}function Nv(n,i,s){for(let c=0;c<i.length;c++)Fd(n,i[c],s)}class ma{get rootNodes(){const i=this._lView,s=i[At];return Ss(s,i,s.firstChild,[])}constructor(i,s){this._lView=i,this._cdRefInjectingView=s,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Hi]}set context(i){this._lView[Hi]=i}get destroyed(){return 256==(256&this._lView[xn])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const i=this._lView[Ri];if(Pi(i)){const s=i[8],c=s?s.indexOf(this):-1;c>-1&&(tl(i,c),hf(s,c))}this._attachedToViewContainer=!1}fc(this._lView[At],this._lView)}onDestroy(i){!function Hu(n,i){if(256==(256&n[xn]))throw new Nt(911,!1);null===n[gs]&&(n[gs]=[]),n[gs].push(i)}(this._lView,i)}markForCheck(){wd(this._cdRefInjectingView||this._lView)}detach(){this._lView[xn]&=-129}reattach(){this._lView[xn]|=128}detectChanges(){Nd(this._lView[At],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Nt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function O_(n,i){id(n,i,i[hn],2,null,null)}(this._lView[At],this._lView)}attachToAppRef(i){if(this._attachedToViewContainer)throw new Nt(902,!1);this._appRef=i}}class Ov extends ma{constructor(i){super(i),this._view=i}detectChanges(){const i=this._view;Nd(i[At],i,i[Hi],!1)}checkNoChanges(){}get context(){return null}}class Fv extends gc{constructor(i){super(),this.ngModule=i}resolveComponentFactory(i){const s=$n(i);return new bs(s,this.ngModule)}}function _u(n){const i=[];for(let s in n)n.hasOwnProperty(s)&&i.push({propName:n[s],templateName:s});return i}class L0{constructor(i,s){this.injector=i,this.parentInjector=s}get(i,s,c){c=zs(c);const d=this.injector.get(i,ll,c);return d!==ll||s===ll?d:this.parentInjector.get(i,s,c)}}class bs extends Gf{get inputs(){const i=this.componentDef,s=i.inputTransforms,c=_u(i.inputs);if(null!==s)for(const d of c)s.hasOwnProperty(d.propName)&&(d.transform=s[d.propName]);return c}get outputs(){return _u(this.componentDef.outputs)}constructor(i,s){super(),this.componentDef=i,this.ngModule=s,this.componentType=i.type,this.selector=function Eo(n){return n.map(Ko).join(",")}(i.selectors),this.ngContentSelectors=i.ngContentSelectors?i.ngContentSelectors:[],this.isBoundToModule=!!s}create(i,s,c,d){let h=(d=d||this.ngModule)instanceof ua?d:d?.injector;h&&null!==this.componentDef.getStandaloneInjector&&(h=this.componentDef.getStandaloneInjector(h)||h);const g=h?new L0(i,h):i,M=g.get(cl,null);if(null===M)throw new Nt(407,!1);const J={rendererFactory:M,sanitizer:g.get(tv,null),effectManager:g.get(Rv,null),afterRenderEventManager:g.get(Qf,null)},oe=M.createRenderer(null,this.componentDef),de=this.componentDef.selectors[0][0]||"div",Pe=c?function lh(n,i,s,c){const h=c.get(fv,!1)||s===Cs.ShadowDom,g=n.selectRootElement(i,h);return function uh(n){xv(n)}(g),g}(oe,c,this.componentDef.encapsulation,g):Us(oe,de,function Wa(n){const i=n.toLowerCase();return"svg"===i?zr:"math"===i?"math":null}(de)),qt=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let We=null;null!==Pe&&(We=yd(Pe,g,!0));const Dn=gu(0,null,null,1,0,null,null,null,null,null,null),qn=ah(null,Dn,null,qt,null,null,J,oe,g,null,We);let Ni,mo;E(qn);try{const bl=this.componentDef;let kh,cx=null;bl.findHostDirectiveDefs?(kh=[],cx=new Map,bl.findHostDirectiveDefs(bl,kh,cx),kh.push(bl)):kh=[bl];const uA=function uE(n,i){const s=n[At],c=Un;return n[c]=i,mu(s,c,2,"#host",null)}(qn,Pe),dA=function _h(n,i,s,c,d,h,g){const M=d[At];!function dE(n,i,s,c){for(const d of n)i.mergedAttrs=ba(i.mergedAttrs,d.hostAttrs);null!==i.mergedAttrs&&(yh(i,i.mergedAttrs,!0),null!==s&&pp(c,s,i))}(c,n,i,g);let T=null;null!==i&&(T=yd(i,d[Is]));const U=h.rendererFactory.createRenderer(i,s);let V=16;s.signals?V=4096:s.onPush&&(V=64);const J=ah(d,Gi(s),null,V,d[n.index],n,h,U,null,null,T);return M.firstCreatePass&&Rd(M,n,c.length-1),gh(d,J),d[n.index]=J}(uA,Pe,bl,kh,qn,J,oe);mo=kl(Dn,Un),Pe&&function N0(n,i,s,c){if(c)Yo(n,s,["ng-version",xd.full]);else{const{attrs:d,classes:h}=function Jo(n){const i=[],s=[];let c=1,d=2;for(;c<n.length;){let h=n[c];if("string"==typeof h)2===d?""!==h&&i.push(h,n[++c]):8===d&&s.push(h);else{if(!Fr(d))break;d=h}c++}return{attrs:i,classes:s}}(i.selectors[0]);d&&Yo(n,s,d),h&&h.length>0&&hp(n,s,h.join(" "))}}(oe,bl,Pe,c),void 0!==s&&function sm(n,i,s){const c=n.projection=[];for(let d=0;d<i.length;d++){const h=s[d];c.push(null!=h?Array.from(h):null)}}(mo,this.ngContentSelectors,s),Ni=function fE(n,i,s,c,d,h){const g=hr(),M=d[At],T=Lr(g,d);fh(M,d,g,s,null,c);for(let V=0;V<s.length;V++)us(Ns(d,M,g.directiveStart+V,g),d);wv(M,d,g),T&&us(T,d);const U=Ns(d,M,g.directiveStart+g.componentOffset,g);if(n[Hi]=d[Hi]=U,null!==h)for(const V of h)V(U,i);return Xp(M,g,n),U}(dA,bl,kh,cx,qn,[O0]),Iv(Dn,qn,null)}finally{Ve()}return new lE(this.componentType,Ni,lu(mo,qn),qn,mo)}}class lE extends cu{constructor(i,s,c,d,h){super(),this.location=c,this._rootLView=d,this._tNode=h,this.previousInputValues=null,this.instance=s,this.hostView=this.changeDetectorRef=new Ov(d),this.componentType=i}setInput(i,s){const c=this._tNode.inputs;let d;if(null!==c&&(d=c[i])){if(this.previousInputValues??=new Map,this.previousInputValues.has(i)&&Object.is(this.previousInputValues.get(i),s))return;const h=this._rootLView;Pd(h[At],h,d,i,s),this.previousInputValues.set(i,s),wd(Ht(this._tNode.index,h))}}get injector(){return new ls(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(i){this.hostView.onDestroy(i)}}function O0(){const n=hr();Bn(qe()[At],n)}function Gv(n){const i=n.inputConfig,s={};for(const c in i)if(i.hasOwnProperty(c)){const d=i[c];Array.isArray(d)&&d[2]&&(s[c]=d[2])}n.inputTransforms=s}function Ec(n){return!!jv(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function jv(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function ts(n,i,s){return!Object.is(n[i],s)&&(n[i]=s,!0)}function $v(n,i,s,c){const d=qe();return ts(d,Oa(),i)&&(sn(),ha(cn(),d,n,i,s,c)),$v}function Ah(n,i,s){const c=qe();return ts(c,Oa(),i)&&function Es(n,i,s,c,d,h,g,M){const T=Lr(i,s);let V,U=i.inputs;!M&&null!=U&&(V=U[c])?(Pd(n,s,V,c,d),wo(i)&&function bv(n,i){const s=Ht(i,n);16&s[xn]||(s[xn]|=64)}(s,i.index)):3&i.type&&(c=function Ga(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(c),d=null!=g?g(d,i.value||"",c):d,h.setProperty(T,c,d))}(sn(),cn(),c,n,i,c[hn],s,!1),Ah}function iy(n,i,s,c,d){const g=d?"class":"style";Pd(n,s,i.inputs[g],g,c)}function pm(n,i,s,c){const d=qe(),h=sn(),g=Un+n,M=d[hn],T=h.firstCreatePass?function bE(n,i,s,c,d,h){const g=i.consts,T=mu(i,n,2,c,oa(g,d));return function Zp(n,i,s,c){if(Yc()){const d=null===c?null:{"":-1},h=function Qp(n,i){const s=n.directiveRegistry;let c=null,d=null;if(s)for(let h=0;h<s.length;h++){const g=s[h];if(xo(i,g.selectors,!1))if(c||(c=[]),Gn(g))if(null!==g.findHostDirectiveDefs){const M=[];d=d||new Map,g.findHostDirectiveDefs(g,M,d),c.unshift(...M,g),Rd(n,i,M.length)}else c.unshift(g),Rd(n,i,0);else d=d||new Map,g.findHostDirectiveDefs?.(g,c,d),c.push(g)}return null===c?null:[c,d]}(n,s);let g,M;null===h?g=M=null:[g,M]=h,null!==g&&fh(n,i,s,g,d,M),d&&function em(n,i,s){if(i){const c=n.localNames=[];for(let d=0;d<i.length;d+=2){const h=s[i[d+1]];if(null==h)throw new Nt(-301,!1);c.push(i[d],h)}}}(s,c,d)}s.mergedAttrs=ba(s.mergedAttrs,s.attrs)}(i,s,T,oa(g,h)),null!==T.attrs&&yh(T,T.attrs,!1),null!==T.mergedAttrs&&yh(T,T.mergedAttrs,!0),null!==i.queries&&i.queries.elementStart(i,T),T}(g,h,d,i,s,c):h.data[g],U=mm(h,d,T,M,i,n);d[g]=U;const V=Br(T);return Jr(T,!0),pp(M,U,T),32!=(32&T.flags)&&Qr()&&Rf(h,d,U,T),0===function Kr(){return an.lFrame.elementDepthCount}()&&us(U,d),function Do(){an.lFrame.elementDepthCount++}(),V&&(function _c(n,i,s){Yc()&&(function Jp(n,i,s,c){const d=s.directiveStart,h=s.directiveEnd;wo(s)&&function Av(n,i,s){const c=Lr(i,n),d=Gi(s);let g=16;s.signals?g=4096:s.onPush&&(g=64);const M=gh(n,ah(n,d,null,g,c,i,null,n[Ca].rendererFactory.createRenderer(c,s),null,null,null));n[i.index]=M}(i,s,n.data[d+s.componentOffset]),n.firstCreatePass||Lo(s,i),us(c,i);const g=s.initialInputs;for(let M=d;M<h;M++){const T=n.data[M],U=Ns(i,n,M,s);us(U,i),null!==g&&mh(0,M-d,U,T,0,g),Gn(T)&&(Ht(s.index,i)[Hi]=Ns(i,n,M,s))}}(n,i,s,Lr(s,i)),64==(64&s.flags)&&wv(n,i,s))}(h,d,T),Xp(h,T,d)),null!==c&&function Yp(n,i,s=Lr){const c=i.localNames;if(null!==c){let d=i.index+1;for(let h=0;h<c.length;h+=2){const g=c[h+1],M=-1===g?s(i,n):n[g];n[d++]=M}}}(d,T),pm}function Gd(){let n=hr();Zc()?function Kc(){an.lFrame.isParent=!1}():(n=n.parent,Jr(n,!1));const i=n;(function rf(n){return an.skipHydrationRootTNode===n})(i)&&function Gh(){an.skipHydrationRootTNode=null}(),function zu(){an.lFrame.elementDepthCount--}();const s=sn();return s.firstCreatePass&&(Bn(s,n),ci(n)&&s.queries.elementEnd(n)),null!=i.classesWithoutHost&&function km(n){return 0!=(8&n.flags)}(i)&&iy(s,i,qe(),i.classesWithoutHost,!0),null!=i.stylesWithoutHost&&function Bm(n){return 0!=(16&n.flags)}(i)&&iy(s,i,qe(),i.stylesWithoutHost,!1),Gd}function bu(n,i,s,c){return pm(n,i,s,c),Gd(),bu}let mm=(n,i,s,c,d,h)=>(io(!0),Us(c,d,function Gl(){return an.lFrame.currentNamespace}()));function wu(n){return!!n&&"function"==typeof n.then}function Dh(n){return!!n&&"function"==typeof n.subscribe}function oy(n,i,s,c){const d=qe(),h=sn(),g=hr();return function iM(n,i,s,c,d,h,g){const M=Br(c),U=n.firstCreatePass&&Mc(n),V=i[Hi],J=Bs(i);let oe=!0;if(3&c.type||g){const Qe=Lr(c,i),wt=g?g(Qe):Qe,qt=J.length,We=g?qn=>g(vi(qn[c.index])):c.index;let Dn=null;if(!g&&M&&(Dn=function CE(n,i,s,c){const d=n.cleanup;if(null!=d)for(let h=0;h<d.length-1;h+=2){const g=d[h];if(g===s&&d[h+1]===c){const M=i[Xs],T=d[h+2];return M.length>T?M[T]:null}"string"==typeof g&&(h+=2)}return null}(n,i,d,c.index)),null!==Dn)(Dn.__ngLastListenerFn__||Dn).__ngNextListenerFn__=h,Dn.__ngLastListenerFn__=h,oe=!1;else{h=Ih(c,i,V,h,!1);const qn=s.listen(wt,d,h);J.push(h,qn),U&&U.push(d,We,qt,qt+1)}}else h=Ih(c,i,V,h,!1);const de=c.outputs;let Pe;if(oe&&null!==de&&(Pe=de[d])){const Qe=Pe.length;if(Qe)for(let wt=0;wt<Qe;wt+=2){const Ni=i[Pe[wt]][Pe[wt+1]].subscribe(h),mo=J.length;J.push(h,Ni),U&&U.push(d,c.index,mo,-(mo+1))}}}(h,d,d[hn],g,n,i,c),oy}function ay(n,i,s,c){try{return vs(6,i,s),!1!==s(c)}catch(d){return rm(n,d),!1}finally{vs(7,i,s)}}function Ih(n,i,s,c,d){return function h(g){if(g===Function)return c;wd(n.componentOffset>-1?Ht(n.index,i):i);let T=ay(i,s,c,g),U=h.__ngNextListenerFn__;for(;U;)T=ay(i,s,U,g)&&T,U=U.__ngNextListenerFn__;return d&&!1===T&&g.preventDefault(),T}}function by(n,i=""){const s=qe(),c=sn(),d=n+Un,h=c.firstCreatePass?mu(c,d,1,i,null):c.data[d],g=wy(c,s,h,i,n);s[d]=g,Qr()&&Rf(c,s,g,h),Jr(h,!1)}let wy=(n,i,s,c,d)=>(io(!0),function sp(n,i){return n.createText(i)}(i[hn],c));const ge=void 0;var mt=["en",[["a","p"],["AM","PM"],ge],[["AM","PM"],ge,ge],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ge,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ge,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ge,"{1} 'at' {0}",ge],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function tt(n){const s=Math.floor(Math.abs(n)),c=n.toString().replace(/^[^.]*\.?/,"").length;return 1===s&&0===c?1:5}];let Pt={};function Wt(n){const i=function vt(n){return n.toLowerCase().replace(/_/g,"-")}(n);let s=Wn(i);if(s)return s;const c=i.split("-")[0];if(s=Wn(c),s)return s;if("en"===c)return mt;throw new Nt(701,!1)}function ln(n){return Wt(n)[ne.PluralCase]}function Wn(n){return n in Pt||(Pt[n]=Di.ng&&Di.ng.common&&Di.ng.common.locales&&Di.ng.common.locales[n]),Pt[n]}var ne=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(ne||{});const Ze="en-US";let zi=Ze;class Yd{}class BE{}function Ob(n,i){return new LM(n,i??null,[])}class LM extends Yd{constructor(i,s,c){super(),this._parent=s,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Fv(this);const d=_n(i);this._bootstrapComponents=za(d.bootstrap),this._r3Injector=Yf(i,s,[{provide:Yd,useValue:this},{provide:gc,useValue:this.componentFactoryResolver},...c],Dt(i),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(i)}get injector(){return this._r3Injector}destroy(){const i=this._r3Injector;!i.destroyed&&i.destroy(),this.destroyCbs.forEach(s=>s()),this.destroyCbs=null}onDestroy(i){this.destroyCbs.push(i)}}class NM extends BE{constructor(i){super(),this.moduleType=i}create(i){return new LM(this.moduleType,i,[])}}class HE extends Yd{constructor(i){super(),this.componentFactoryResolver=new Fv(this),this.instance=null;const s=new dd([...i.providers,{provide:Yd,useValue:this},{provide:gc,useValue:this.componentFactoryResolver}],i.parent||Uf(),i.debugName,new Set(["environment"]));this.injector=s,i.runEnvironmentInitializers&&s.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(i){this.injector.onDestroy(i)}}function VE(n,i,s=null){return new HE({providers:n,parent:i,debugName:s,runEnvironmentInitializers:!0}).injector}let Ub=(()=>{var n;class i{constructor(c){this._injector=c,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(c){if(!c.standalone)return null;if(!this.cachedInjectors.has(c)){const d=Bg(0,c.type),h=d.length>0?VE([d],this._injector,`Standalone[${c.type.name}]`):null;this.cachedInjectors.set(c,h)}return this.cachedInjectors.get(c)}ngOnDestroy(){try{for(const c of this.cachedInjectors.values())null!==c&&c.destroy()}finally{this.cachedInjectors.clear()}}}return(n=i).\u0275prov=oi({token:n,providedIn:"environment",factory:()=>new n(ur(ua))}),i})();function zE(n){n.getStandaloneInjector=i=>i.get(Ub).getOrCreateStandaloneInjector(n)}function lw(){return this._results[Symbol.iterator]()}class FM{get changes(){return this._changes||(this._changes=new Va)}constructor(i=!1){this._emitDistinctChangesOnly=i,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const s=FM.prototype;s[Symbol.iterator]||(s[Symbol.iterator]=lw)}get(i){return this._results[i]}map(i){return this._results.map(i)}filter(i){return this._results.filter(i)}find(i){return this._results.find(i)}reduce(i,s){return this._results.reduce(i,s)}forEach(i){this._results.forEach(i)}some(i){return this._results.some(i)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(i,s){const c=this;c.dirty=!1;const d=function ro(n){return n.flat(Number.POSITIVE_INFINITY)}(i);(this._changesDetected=!function Jy(n,i,s){if(n.length!==i.length)return!1;for(let c=0;c<n.length;c++){let d=n[c],h=i[c];if(s&&(d=s(d),h=s(h)),h!==d)return!1}return!0}(c._results,d,s))&&(c._results=d,c.length=d.length,c.last=d[this.length-1],c.first=d[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function dw(n,i,s,c=!0){const d=i[At];if(function U_(n,i,s,c){const d=ir+c,h=s.length;c>0&&(s[d-1][Dr]=i),c<h-ir?(i[Dr]=s[d],$m(s,ir+c,i)):(s.push(i),i[Dr]=null),i[Ri]=s;const g=i[ea];null!==g&&s!==g&&function k_(n,i){const s=n[Qa];i[wi]!==i[Ri][Ri][wi]&&(n[Bh]=!0),null===s?n[Qa]=[i]:s.push(i)}(g,i);const M=i[nr];null!==M&&M.insertView(n),i[xn]|=128}(d,i,n,s),c){const h=up(s,n),g=i[hn],M=ed(g,n[So]);null!==M&&function N_(n,i,s,c,d,h){c[mi]=d,c[Ir]=i,id(n,c,s,1,d,h)}(d,n[Ir],g,i,M,h)}}let Om=(()=>{class i{}return i.__NG_ELEMENT_ID__=pw,i})();const fw=Om,hw=class extends fw{constructor(i,s,c){super(),this._declarationLView=i,this._declarationTContainer=s,this.elementRef=c}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(i,s){return this.createEmbeddedViewImpl(i,s)}createEmbeddedViewImpl(i,s,c){const d=function uw(n,i,s,c){const d=i.tView,M=ah(n,d,s,4096&n[xn]?4096:16,null,i,null,null,null,c?.injector??null,c?.hydrationInfo??null);M[ea]=n[i.index];const U=n[nr];return null!==U&&(M[nr]=U.createEmbeddedView(d)),Iv(d,M,s),M}(this._declarationLView,this._declarationTContainer,i,{injector:s,hydrationInfo:c});return new ma(d)}};function pw(){return Iy(hr(),qe())}function Iy(n,i){return 4&n.type?new hw(i,n,lu(n,i)):null}let Py=(()=>{class i{}return i.__NG_ELEMENT_ID__=Mw,i})();function Mw(){return oS(hr(),qe())}const xw=Py,rS=class extends xw{constructor(i,s,c){super(),this._lContainer=i,this._hostTNode=s,this._hostLView=c}get element(){return lu(this._hostTNode,this._hostLView)}get injector(){return new ls(this._hostTNode,this._hostLView)}get parentInjector(){const i=ka(this._hostTNode,this._hostLView);if(Xl(i)){const s=lc(i,this._hostLView),c=pr(i);return new ls(s[At].data[c+8],s)}return new ls(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(i){const s=sS(this._lContainer);return null!==s&&s[i]||null}get length(){return this._lContainer.length-ir}createEmbeddedView(i,s,c){let d,h;"number"==typeof c?d=c:null!=c&&(d=c.index,h=c.injector);const M=i.createEmbeddedViewImpl(s||{},h,null);return this.insertImpl(M,d,false),M}createComponent(i,s,c,d,h){const g=i&&!function Zu(n){return"function"==typeof n}(i);let M;if(g)M=s;else{const Qe=s||{};M=Qe.index,c=Qe.injector,d=Qe.projectableNodes,h=Qe.environmentInjector||Qe.ngModuleRef}const T=g?i:new bs($n(i)),U=c||this.parentInjector;if(!h&&null==T.ngModule){const wt=(g?U:this.parentInjector).get(ua,null);wt&&(h=wt)}$n(T.componentType??{});const de=T.create(U,d,null,h);return this.insertImpl(de.hostView,M,false),de}insert(i,s){return this.insertImpl(i,s,!1)}insertImpl(i,s,c){const d=i._lView;if(function Bu(n){return Pi(n[Ri])}(d)){const T=this.indexOf(i);if(-1!==T)this.detach(T);else{const U=d[Ri],V=new rS(U,U[Ir],U[Ri]);V.detach(V.indexOf(i))}}const g=this._adjustIndex(s),M=this._lContainer;return dw(M,d,g,!c),i.attachToViewContainerRef(),$m(UM(M),g,i),i}move(i,s){return this.insert(i,s)}indexOf(i){const s=sS(this._lContainer);return null!==s?s.indexOf(i):-1}remove(i){const s=this._adjustIndex(i,-1),c=tl(this._lContainer,s);c&&(hf(UM(this._lContainer),s),fc(c[At],c))}detach(i){const s=this._adjustIndex(i,-1),c=tl(this._lContainer,s);return c&&null!=hf(UM(this._lContainer),s)?new ma(c):null}_adjustIndex(i,s=0){return i??this.length+s}};function sS(n){return n[8]}function UM(n){return n[8]||(n[8]=[])}function oS(n,i){let s;const c=i[n.index];return Pi(c)?s=c:(s=function Cv(n,i,s,c){return[n,!0,!1,i,null,0,c,s,null,null,null]}(c,i,null,n),i[n.index]=s,gh(i,s)),aS(s,i,n,c),new rS(s,n,i)}let aS=function cS(n,i,s,c){if(n[So])return;let d;d=8&s.type?vi(c):function Ew(n,i){const s=n[hn],c=s.createComment(""),d=Lr(i,n);return ks(s,ed(s,d),c,function If(n,i){return n.nextSibling(i)}(s,d),!1),c}(i,s),n[So]=d};class kM{constructor(i){this.queryList=i,this.matches=null}clone(){return new kM(this.queryList)}setDirty(){this.queryList.setDirty()}}class BM{constructor(i=[]){this.queries=i}createEmbeddedView(i){const s=i.queries;if(null!==s){const c=null!==i.contentQueries?i.contentQueries[0]:s.length,d=[];for(let h=0;h<c;h++){const g=s.getByIndex(h);d.push(this.queries[g.indexInDeclarationView].clone())}return new BM(d)}return null}insertView(i){this.dirtyQueriesWithMatches(i)}detachView(i){this.dirtyQueriesWithMatches(i)}dirtyQueriesWithMatches(i){for(let s=0;s<this.queries.length;s++)null!==vS(i,s).matches&&this.queries[s].setDirty()}}class lS{constructor(i,s,c=null){this.predicate=i,this.flags=s,this.read=c}}class HM{constructor(i=[]){this.queries=i}elementStart(i,s){for(let c=0;c<this.queries.length;c++)this.queries[c].elementStart(i,s)}elementEnd(i){for(let s=0;s<this.queries.length;s++)this.queries[s].elementEnd(i)}embeddedTView(i){let s=null;for(let c=0;c<this.length;c++){const d=null!==s?s.length:0,h=this.getByIndex(c).embeddedTView(i,d);h&&(h.indexInDeclarationView=c,null!==s?s.push(h):s=[h])}return null!==s?new HM(s):null}template(i,s){for(let c=0;c<this.queries.length;c++)this.queries[c].template(i,s)}getByIndex(i){return this.queries[i]}get length(){return this.queries.length}track(i){this.queries.push(i)}}class VM{constructor(i,s=-1){this.metadata=i,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=s}elementStart(i,s){this.isApplyingToNode(s)&&this.matchTNode(i,s)}elementEnd(i){this._declarationNodeIndex===i.index&&(this._appliesToNextNode=!1)}template(i,s){this.elementStart(i,s)}embeddedTView(i,s){return this.isApplyingToNode(i)?(this.crossesNgTemplate=!0,this.addMatch(-i.index,s),new VM(this.metadata)):null}isApplyingToNode(i){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const s=this._declarationNodeIndex;let c=i.parent;for(;null!==c&&8&c.type&&c.index!==s;)c=c.parent;return s===(null!==c?c.index:-1)}return this._appliesToNextNode}matchTNode(i,s){const c=this.metadata.predicate;if(Array.isArray(c))for(let d=0;d<c.length;d++){const h=c[d];this.matchTNodeWithReadOption(i,s,ww(s,h)),this.matchTNodeWithReadOption(i,s,No(s,i,h,!1,!1))}else c===Om?4&s.type&&this.matchTNodeWithReadOption(i,s,-1):this.matchTNodeWithReadOption(i,s,No(s,i,c,!1,!1))}matchTNodeWithReadOption(i,s,c){if(null!==c){const d=this.metadata.read;if(null!==d)if(d===vc||d===Py||d===Om&&4&s.type)this.addMatch(s.index,-2);else{const h=No(s,i,d,!1,!1);null!==h&&this.addMatch(s.index,h)}else this.addMatch(s.index,c)}}addMatch(i,s){null===this.matches?this.matches=[i,s]:this.matches.push(i,s)}}function ww(n,i){const s=n.localNames;if(null!==s)for(let c=0;c<s.length;c+=2)if(s[c]===i)return s[c+1];return null}function Aw(n,i,s,c){return-1===s?function Tw(n,i){return 11&n.type?lu(n,i):4&n.type?Iy(n,i):null}(i,n):-2===s?function Cw(n,i,s){return s===vc?lu(i,n):s===Om?Iy(i,n):s===Py?oS(i,n):void 0}(n,i,c):Ns(n,n[At],s,i)}function uS(n,i,s,c){const d=i[nr].queries[c];if(null===d.matches){const h=n.data,g=s.matches,M=[];for(let T=0;T<g.length;T+=2){const U=g[T];M.push(U<0?null:Aw(i,h[U],g[T+1],s.metadata.read))}d.matches=M}return d.matches}function zM(n,i,s,c){const d=n.queries.getByIndex(s),h=d.matches;if(null!==h){const g=uS(n,i,d,s);for(let M=0;M<h.length;M+=2){const T=h[M];if(T>0)c.push(g[M/2]);else{const U=h[M+1],V=i[-T];for(let J=ir;J<V.length;J++){const oe=V[J];oe[ea]===oe[Ri]&&zM(oe[At],oe,U,c)}if(null!==V[Qa]){const J=V[Qa];for(let oe=0;oe<J.length;oe++){const de=J[oe];zM(de[At],de,U,c)}}}}}return c}function dS(n){const i=qe(),s=sn(),c=Wh();_(c+1);const d=vS(s,c);if(n.dirty&&function cc(n){return 4==(4&n[xn])}(i)===(2==(2&d.metadata.flags))){if(null===d.matches)n.reset([]);else{const h=d.crossesNgTemplate?zM(s,i,c,[]):uS(s,i,d,c);n.reset(h,Md),n.notifyOnChanges()}return!0}return!1}function fS(n,i,s){const c=sn();c.firstCreatePass&&(gS(c,new lS(n,i,s),-1),2==(2&i)&&(c.staticViewQueries=!0)),mS(c,qe(),i)}function hS(n,i,s,c){const d=sn();if(d.firstCreatePass){const h=hr();gS(d,new lS(i,s,c),h.index),function Iw(n,i){const s=n.contentQueries||(n.contentQueries=[]);i!==(s.length?s[s.length-1]:-1)&&s.push(n.queries.length-1,i)}(d,n),2==(2&s)&&(d.staticContentQueries=!0)}mS(d,qe(),s)}function pS(){return function Dw(n,i){return n[nr].queries[i].queryList}(qe(),Wh())}function mS(n,i,s){const c=new FM(4==(4&s));(function Ev(n,i,s,c){const d=Bs(i);d.push(s),n.firstCreatePass&&Mc(n).push(c,d.length-1)})(n,i,c,c.destroy),null===i[nr]&&(i[nr]=new BM),i[nr].queries.push(new kM(c))}function gS(n,i,s){null===n.queries&&(n.queries=new HM),n.queries.track(new VM(i,s))}function vS(n,i){return n.queries.getByIndex(i)}function GM(n){return!!_n(n)}const NS=new di("Application Initializer");let YM=(()=>{var n;class i{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((c,d)=>{this.resolve=c,this.reject=d}),this.appInits=ri(NS,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const c=[];for(const h of this.appInits){const g=h();if(wu(g))c.push(g);else if(Dh(g)){const M=new Promise((T,U)=>{g.subscribe({complete:T,error:U})});c.push(M)}}const d=()=>{this.done=!0,this.resolve()};Promise.all(c).then(()=>{d()}).catch(h=>{this.reject(h)}),0===c.length&&d(),this.initialized=!0}}return(n=i).\u0275fac=function(c){return new(c||n)},n.\u0275prov=oi({token:n,factory:n.\u0275fac,providedIn:"root"}),i})(),OS=(()=>{var n;class i{log(c){console.log(c)}warn(c){console.warn(c)}}return(n=i).\u0275fac=function(c){return new(c||n)},n.\u0275prov=oi({token:n,factory:n.\u0275fac,providedIn:"platform"}),i})();const Ny=new di("LocaleId",{providedIn:"root",factory:()=>ri(Ny,Mt.Optional|Mt.SkipSelf)||function Jw(){return typeof $localize<"u"&&$localize.locale||Ze}()}),Qw=new di("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});let FS=(()=>{var n;class i{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new lt.X(!1)}add(){this.hasPendingTasks.next(!0);const c=this.taskId++;return this.pendingTasks.add(c),c}remove(c){this.pendingTasks.delete(c),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return(n=i).\u0275fac=function(c){return new(c||n)},n.\u0275prov=oi({token:n,factory:n.\u0275fac,providedIn:"root"}),i})();class tT{constructor(i,s){this.ngModuleFactory=i,this.componentFactories=s}}let nT=(()=>{var n;class i{compileModuleSync(c){return new NM(c)}compileModuleAsync(c){return Promise.resolve(this.compileModuleSync(c))}compileModuleAndAllComponentsSync(c){const d=this.compileModuleSync(c),g=za(_n(c).declarations).reduce((M,T)=>{const U=$n(T);return U&&M.push(new bs(U)),M},[]);return new tT(d,g)}compileModuleAndAllComponentsAsync(c){return Promise.resolve(this.compileModuleAndAllComponentsSync(c))}clearCache(){}clearCacheFor(c){}getModuleId(c){}}return(n=i).\u0275fac=function(c){return new(c||n)},n.\u0275prov=oi({token:n,factory:n.\u0275fac,providedIn:"root"}),i})();const HS=new di(""),VS=new di("");let KM,ET=(()=>{var n;class i{constructor(c,d,h){this._ngZone=c,this.registry=d,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,KM||(function ST(n){KM=n}(h),h.addToWindow(d)),this._watchAngularEvents(),c.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{jr.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let c=this._callbacks.pop();clearTimeout(c.timeoutId),c.doneCb(this._didWork)}this._didWork=!1});else{let c=this.getPendingTasks();this._callbacks=this._callbacks.filter(d=>!d.updateCb||!d.updateCb(c)||(clearTimeout(d.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(c=>({source:c.source,creationLocation:c.creationLocation,data:c.data})):[]}addCallback(c,d,h){let g=-1;d&&d>0&&(g=setTimeout(()=>{this._callbacks=this._callbacks.filter(M=>M.timeoutId!==g),c(this._didWork,this.getPendingTasks())},d)),this._callbacks.push({doneCb:c,timeoutId:g,updateCb:h})}whenStable(c,d,h){if(h&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(c,d,h),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(c){this.registry.registerApplication(c,this)}unregisterApplication(c){this.registry.unregisterApplication(c)}findProviders(c,d,h){return[]}}return(n=i).\u0275fac=function(c){return new(c||n)(ur(jr),ur(zS),ur(VS))},n.\u0275prov=oi({token:n,factory:n.\u0275fac}),i})(),zS=(()=>{var n;class i{constructor(){this._applications=new Map}registerApplication(c,d){this._applications.set(c,d)}unregisterApplication(c){this._applications.delete(c)}unregisterAllApplications(){this._applications.clear()}getTestability(c){return this._applications.get(c)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(c,d=!0){return KM?.findTestabilityInTree(this,c,d)??null}}return(n=i).\u0275fac=function(c){return new(c||n)},n.\u0275prov=oi({token:n,factory:n.\u0275fac,providedIn:"platform"}),i})(),Cu=null;const GS=new di("AllowMultipleToken"),JM=new di("PlatformDestroyListeners"),QM=new di("appBootstrapListener");class TT{constructor(i,s){this.name=i,this.token=s}}function $S(n,i,s=[]){const c=`Platform: ${i}`,d=new di(c);return(h=[])=>{let g=ex();if(!g||g.injector.get(GS,!1)){const M=[...s,...h,{provide:d,useValue:!0}];n?n(M):function AT(n){if(Cu&&!Cu.get(GS,!1))throw new Nt(400,!1);(function WS(){!function re(n){P=n}(()=>{throw new Nt(600,!1)})})(),Cu=n;const i=n.get(YS);(function jS(n){n.get(Xg,null)?.forEach(s=>s())})(n)}(function XS(n=[],i){return so.create({name:i,providers:[{provide:Ap,useValue:"platform"},{provide:JM,useValue:new Set([()=>Cu=null])},...n]})}(M,c))}return function DT(n){const i=ex();if(!i)throw new Nt(401,!1);return i}()}}function ex(){return Cu?.get(YS)??null}let YS=(()=>{var n;class i{constructor(c){this._injector=c,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(c,d){const h=function IT(n="zone.js",i){return"noop"===n?new Hp:"zone.js"===n?new jr(i):n}(d?.ngZone,function qS(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:d?.ngZoneEventCoalescing,runCoalescing:d?.ngZoneRunCoalescing}));return h.run(()=>{const g=function Fb(n,i,s){return new LM(n,i,s)}(c.moduleType,this.injector,function eb(n){return[{provide:jr,useFactory:n},{provide:ru,multi:!0,useFactory:()=>{const i=ri(PT,{optional:!0});return()=>i.initialize()}},{provide:QS,useFactory:RT},{provide:Jf,useFactory:lv}]}(()=>h)),M=g.injector.get(ul,null);return h.runOutsideAngular(()=>{const T=h.onError.subscribe({next:U=>{M.handleError(U)}});g.onDestroy(()=>{Fy(this._modules,g),T.unsubscribe()})}),function ZS(n,i,s){try{const c=s();return wu(c)?c.catch(d=>{throw i.runOutsideAngular(()=>n.handleError(d)),d}):c}catch(c){throw i.runOutsideAngular(()=>n.handleError(c)),c}}(M,h,()=>{const T=g.injector.get(YM);return T.runInitializers(),T.donePromise.then(()=>(function te(n){hi(n,"Expected localeId to be defined"),"string"==typeof n&&(zi=n.toLowerCase().replace(/_/g,"-"))}(g.injector.get(Ny,Ze)||Ze),this._moduleDoBootstrap(g),g))})})}bootstrapModule(c,d=[]){const h=KS({},d);return function bT(n,i,s){const c=new NM(s);return Promise.resolve(c)}(0,0,c).then(g=>this.bootstrapModuleFactory(g,h))}_moduleDoBootstrap(c){const d=c.injector.get(Uh);if(c._bootstrapComponents.length>0)c._bootstrapComponents.forEach(h=>d.bootstrap(h));else{if(!c.instance.ngDoBootstrap)throw new Nt(-403,!1);c.instance.ngDoBootstrap(d)}this._modules.push(c)}onDestroy(c){this._destroyListeners.push(c)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Nt(404,!1);this._modules.slice().forEach(d=>d.destroy()),this._destroyListeners.forEach(d=>d());const c=this._injector.get(JM,null);c&&(c.forEach(d=>d()),c.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return(n=i).\u0275fac=function(c){return new(c||n)(ur(so))},n.\u0275prov=oi({token:n,factory:n.\u0275fac,providedIn:"platform"}),i})();function KS(n,i){return Array.isArray(i)?i.reduce(KS,n):{...n,...i}}let Uh=(()=>{var n;class i{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ri(QS),this.zoneIsStable=ri(Jf),this.componentTypes=[],this.components=[],this.isStable=ri(FS).hasPendingTasks.pipe((0,ai.w)(c=>c?(0,Be.of)(!1):this.zoneIsStable),function ni(n,i=Vn.y){return n=n??_i,(0,mn.e)((s,c)=>{let d,h=!0;s.subscribe((0,si.x)(c,g=>{const M=i(g);(h||!n(d,M))&&(h=!1,d=M,c.next(g))}))})}(),zt()),this._injector=ri(ua)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(c,d){const h=c instanceof Gf;if(!this._injector.get(YM).done)throw!h&&Ur(c),new Nt(405,!1);let M;M=h?c:this._injector.get(gc).resolveComponentFactory(c),this.componentTypes.push(M.componentType);const T=function wT(n){return n.isBoundToModule}(M)?void 0:this._injector.get(Yd),V=M.create(so.NULL,[],d||M.selector,T),J=V.location.nativeElement,oe=V.injector.get(HS,null);return oe?.registerApplication(J),V.onDestroy(()=>{this.detachView(V.hostView),Fy(this.components,V),oe?.unregisterApplication(J)}),this._loadComponent(V),V}tick(){if(this._runningTick)throw new Nt(101,!1);try{this._runningTick=!0;for(let c of this._views)c.detectChanges()}catch(c){this.internalErrorHandler(c)}finally{this._runningTick=!1}}attachView(c){const d=c;this._views.push(d),d.attachToAppRef(this)}detachView(c){const d=c;Fy(this._views,d),d.detachFromAppRef()}_loadComponent(c){this.attachView(c.hostView),this.tick(),this.components.push(c);const d=this._injector.get(QM,[]);d.push(...this._bootstrapListeners),d.forEach(h=>h(c))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(c=>c()),this._views.slice().forEach(c=>c.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(c){return this._destroyListeners.push(c),()=>Fy(this._destroyListeners,c)}destroy(){if(this._destroyed)throw new Nt(406,!1);const c=this._injector;c.destroy&&!c.destroyed&&c.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return(n=i).\u0275fac=function(c){return new(c||n)},n.\u0275prov=oi({token:n,factory:n.\u0275fac,providedIn:"root"}),i})();function Fy(n,i){const s=n.indexOf(i);s>-1&&n.splice(s,1)}const QS=new di("",{providedIn:"root",factory:()=>ri(ul).handleError.bind(void 0)});function RT(){const n=ri(jr),i=ri(ul);return s=>n.runOutsideAngular(()=>i.handleError(s))}let PT=(()=>{var n;class i{constructor(){this.zone=ri(jr),this.applicationRef=ri(Uh)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return(n=i).\u0275fac=function(c){return new(c||n)},n.\u0275prov=oi({token:n,factory:n.\u0275fac,providedIn:"root"}),i})();let NT=(()=>{class i{}return i.__NG_ELEMENT_ID__=OT,i})();function OT(n){return function FT(n,i,s){if(wo(n)&&!s){const c=Ht(n.index,i);return new ma(c,c)}return 47&n.type?new ma(i[wi],i):null}(hr(),qe(),16==(16&n))}class rb{constructor(){}supports(i){return Ec(i)}create(i){return new zT(i)}}const VT=(n,i)=>i;class zT{constructor(i){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=i||VT}forEachItem(i){let s;for(s=this._itHead;null!==s;s=s._next)i(s)}forEachOperation(i){let s=this._itHead,c=this._removalsHead,d=0,h=null;for(;s||c;){const g=!c||s&&s.currentIndex<ob(c,d,h)?s:c,M=ob(g,d,h),T=g.currentIndex;if(g===c)d--,c=c._nextRemoved;else if(s=s._next,null==g.previousIndex)d++;else{h||(h=[]);const U=M-d,V=T-d;if(U!=V){for(let oe=0;oe<U;oe++){const de=oe<h.length?h[oe]:h[oe]=0,Pe=de+oe;V<=Pe&&Pe<U&&(h[oe]=de+1)}h[g.previousIndex]=V-U}}M!==T&&i(g,M,T)}}forEachPreviousItem(i){let s;for(s=this._previousItHead;null!==s;s=s._nextPrevious)i(s)}forEachAddedItem(i){let s;for(s=this._additionsHead;null!==s;s=s._nextAdded)i(s)}forEachMovedItem(i){let s;for(s=this._movesHead;null!==s;s=s._nextMoved)i(s)}forEachRemovedItem(i){let s;for(s=this._removalsHead;null!==s;s=s._nextRemoved)i(s)}forEachIdentityChange(i){let s;for(s=this._identityChangesHead;null!==s;s=s._nextIdentityChange)i(s)}diff(i){if(null==i&&(i=[]),!Ec(i))throw new Nt(900,!1);return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let d,h,g,s=this._itHead,c=!1;if(Array.isArray(i)){this.length=i.length;for(let M=0;M<this.length;M++)h=i[M],g=this._trackByFn(M,h),null!==s&&Object.is(s.trackById,g)?(c&&(s=this._verifyReinsertion(s,h,g,M)),Object.is(s.item,h)||this._addIdentityChange(s,h)):(s=this._mismatch(s,h,g,M),c=!0),s=s._next}else d=0,function H0(n,i){if(Array.isArray(n))for(let s=0;s<n.length;s++)i(n[s]);else{const s=n[Symbol.iterator]();let c;for(;!(c=s.next()).done;)i(c.value)}}(i,M=>{g=this._trackByFn(d,M),null!==s&&Object.is(s.trackById,g)?(c&&(s=this._verifyReinsertion(s,M,g,d)),Object.is(s.item,M)||this._addIdentityChange(s,M)):(s=this._mismatch(s,M,g,d),c=!0),s=s._next,d++}),this.length=d;return this._truncate(s),this.collection=i,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let i;for(i=this._previousItHead=this._itHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._additionsHead;null!==i;i=i._nextAdded)i.previousIndex=i.currentIndex;for(this._additionsHead=this._additionsTail=null,i=this._movesHead;null!==i;i=i._nextMoved)i.previousIndex=i.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(i,s,c,d){let h;return null===i?h=this._itTail:(h=i._prev,this._remove(i)),null!==(i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null))?(Object.is(i.item,s)||this._addIdentityChange(i,s),this._reinsertAfter(i,h,d)):null!==(i=null===this._linkedRecords?null:this._linkedRecords.get(c,d))?(Object.is(i.item,s)||this._addIdentityChange(i,s),this._moveAfter(i,h,d)):i=this._addAfter(new GT(s,c),h,d),i}_verifyReinsertion(i,s,c,d){let h=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null);return null!==h?i=this._reinsertAfter(h,i._prev,d):i.currentIndex!=d&&(i.currentIndex=d,this._addToMoves(i,d)),i}_truncate(i){for(;null!==i;){const s=i._next;this._addToRemovals(this._unlink(i)),i=s}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(i,s,c){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(i);const d=i._prevRemoved,h=i._nextRemoved;return null===d?this._removalsHead=h:d._nextRemoved=h,null===h?this._removalsTail=d:h._prevRemoved=d,this._insertAfter(i,s,c),this._addToMoves(i,c),i}_moveAfter(i,s,c){return this._unlink(i),this._insertAfter(i,s,c),this._addToMoves(i,c),i}_addAfter(i,s,c){return this._insertAfter(i,s,c),this._additionsTail=null===this._additionsTail?this._additionsHead=i:this._additionsTail._nextAdded=i,i}_insertAfter(i,s,c){const d=null===s?this._itHead:s._next;return i._next=d,i._prev=s,null===d?this._itTail=i:d._prev=i,null===s?this._itHead=i:s._next=i,null===this._linkedRecords&&(this._linkedRecords=new sb),this._linkedRecords.put(i),i.currentIndex=c,i}_remove(i){return this._addToRemovals(this._unlink(i))}_unlink(i){null!==this._linkedRecords&&this._linkedRecords.remove(i);const s=i._prev,c=i._next;return null===s?this._itHead=c:s._next=c,null===c?this._itTail=s:c._prev=s,i}_addToMoves(i,s){return i.previousIndex===s||(this._movesTail=null===this._movesTail?this._movesHead=i:this._movesTail._nextMoved=i),i}_addToRemovals(i){return null===this._unlinkedRecords&&(this._unlinkedRecords=new sb),this._unlinkedRecords.put(i),i.currentIndex=null,i._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=i,i._prevRemoved=null):(i._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=i),i}_addIdentityChange(i,s){return i.item=s,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=i:this._identityChangesTail._nextIdentityChange=i,i}}class GT{constructor(i,s){this.item=i,this.trackById=s,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class WT{constructor(){this._head=null,this._tail=null}add(i){null===this._head?(this._head=this._tail=i,i._nextDup=null,i._prevDup=null):(this._tail._nextDup=i,i._prevDup=this._tail,i._nextDup=null,this._tail=i)}get(i,s){let c;for(c=this._head;null!==c;c=c._nextDup)if((null===s||s<=c.currentIndex)&&Object.is(c.trackById,i))return c;return null}remove(i){const s=i._prevDup,c=i._nextDup;return null===s?this._head=c:s._nextDup=c,null===c?this._tail=s:c._prevDup=s,null===this._head}}class sb{constructor(){this.map=new Map}put(i){const s=i.trackById;let c=this.map.get(s);c||(c=new WT,this.map.set(s,c)),c.add(i)}get(i,s){const d=this.map.get(i);return d?d.get(i,s):null}remove(i){const s=i.trackById;return this.map.get(s).remove(i)&&this.map.delete(s),i}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function ob(n,i,s){const c=n.previousIndex;if(null===c)return c;let d=0;return s&&c<s.length&&(d=s[c]),c+i+d}class ab{constructor(){}supports(i){return i instanceof Map||jv(i)}create(){return new jT}}class jT{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(i){let s;for(s=this._mapHead;null!==s;s=s._next)i(s)}forEachPreviousItem(i){let s;for(s=this._previousMapHead;null!==s;s=s._nextPrevious)i(s)}forEachChangedItem(i){let s;for(s=this._changesHead;null!==s;s=s._nextChanged)i(s)}forEachAddedItem(i){let s;for(s=this._additionsHead;null!==s;s=s._nextAdded)i(s)}forEachRemovedItem(i){let s;for(s=this._removalsHead;null!==s;s=s._nextRemoved)i(s)}diff(i){if(i){if(!(i instanceof Map||jv(i)))throw new Nt(900,!1)}else i=new Map;return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let s=this._mapHead;if(this._appendAfter=null,this._forEach(i,(c,d)=>{if(s&&s.key===d)this._maybeAddToChanges(s,c),this._appendAfter=s,s=s._next;else{const h=this._getOrCreateRecordForKey(d,c);s=this._insertBeforeOrAppend(s,h)}}),s){s._prev&&(s._prev._next=null),this._removalsHead=s;for(let c=s;null!==c;c=c._nextRemoved)c===this._mapHead&&(this._mapHead=null),this._records.delete(c.key),c._nextRemoved=c._next,c.previousValue=c.currentValue,c.currentValue=null,c._prev=null,c._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(i,s){if(i){const c=i._prev;return s._next=i,s._prev=c,i._prev=s,c&&(c._next=s),i===this._mapHead&&(this._mapHead=s),this._appendAfter=i,i}return this._appendAfter?(this._appendAfter._next=s,s._prev=this._appendAfter):this._mapHead=s,this._appendAfter=s,null}_getOrCreateRecordForKey(i,s){if(this._records.has(i)){const d=this._records.get(i);this._maybeAddToChanges(d,s);const h=d._prev,g=d._next;return h&&(h._next=g),g&&(g._prev=h),d._next=null,d._prev=null,d}const c=new $T(i);return this._records.set(i,c),c.currentValue=s,this._addToAdditions(c),c}_reset(){if(this.isDirty){let i;for(this._previousMapHead=this._mapHead,i=this._previousMapHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._changesHead;null!==i;i=i._nextChanged)i.previousValue=i.currentValue;for(i=this._additionsHead;null!=i;i=i._nextAdded)i.previousValue=i.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(i,s){Object.is(s,i.currentValue)||(i.previousValue=i.currentValue,i.currentValue=s,this._addToChanges(i))}_addToAdditions(i){null===this._additionsHead?this._additionsHead=this._additionsTail=i:(this._additionsTail._nextAdded=i,this._additionsTail=i)}_addToChanges(i){null===this._changesHead?this._changesHead=this._changesTail=i:(this._changesTail._nextChanged=i,this._changesTail=i)}_forEach(i,s){i instanceof Map?i.forEach(s):Object.keys(i).forEach(c=>s(i[c],c))}}class $T{constructor(i){this.key=i,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function cb(){return new sx([new rb])}let sx=(()=>{var n;class i{constructor(c){this.factories=c}static create(c,d){if(null!=d){const h=d.factories.slice();c=c.concat(h)}return new i(c)}static extend(c){return{provide:i,useFactory:d=>i.create(c,d||cb()),deps:[[i,new gf,new mf]]}}find(c){const d=this.factories.find(h=>h.supports(c));if(null!=d)return d;throw new Nt(901,!1)}}return(n=i).\u0275prov=oi({token:n,providedIn:"root",factory:cb}),i})();function lb(){return new ox([new ab])}let ox=(()=>{var n;class i{constructor(c){this.factories=c}static create(c,d){if(d){const h=d.factories.slice();c=c.concat(h)}return new i(c)}static extend(c){return{provide:i,useFactory:d=>i.create(c,d||lb()),deps:[[i,new gf,new mf]]}}find(c){const d=this.factories.find(h=>h.supports(c));if(d)return d;throw new Nt(901,!1)}}return(n=i).\u0275prov=oi({token:n,providedIn:"root",factory:lb}),i})();const qT=$S(null,"core",[]);let ZT=(()=>{var n;class i{constructor(c){}}return(n=i).\u0275fac=function(c){return new(c||n)(ur(Uh))},n.\u0275mod=Za({type:n}),n.\u0275inj=zn({}),i})();function aA(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function lA(n){const i=$n(n);if(!i)return null;const s=new bs(i);return{get selector(){return s.selector},get type(){return s.componentType},get inputs(){return s.inputs},get outputs(){return s.outputs},get ngContentSelectors(){return s.ngContentSelectors},get isStandalone(){return i.standalone},get isSignal(){return i.signals}}}},593:(On,_t,se)=>{se.d(_t,{Dx:()=>_a,b2:()=>li,q6:()=>Ai});var F=se(946),Ie=se(814);class Ae extends Ie.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class at extends Ae{static makeCurrent(){(0,Ie.HT)(new at)}onAndCancel(le,Ee,ae){return le.addEventListener(Ee,ae),()=>{le.removeEventListener(Ee,ae)}}dispatchEvent(le,Ee){le.dispatchEvent(Ee)}remove(le){le.parentNode&&le.parentNode.removeChild(le)}createElement(le,Ee){return(Ee=Ee||this.getDefaultDocument()).createElement(le)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(le){return le.nodeType===Node.ELEMENT_NODE}isShadowRoot(le){return le instanceof DocumentFragment}getGlobalEventTarget(le,Ee){return"window"===Ee?window:"document"===Ee?le:"body"===Ee?le.body:null}getBaseHref(le){const Ee=function Je(){return je=je||document.querySelector("base"),je?je.getAttribute("href"):null}();return null==Ee?null:function Tn(De){Tt=Tt||document.createElement("a"),Tt.setAttribute("href",De);const le=Tt.pathname;return"/"===le.charAt(0)?le:`/${le}`}(Ee)}resetBaseElement(){je=null}getUserAgent(){return window.navigator.userAgent}getCookie(le){return(0,Ie.Mx)(document.cookie,le)}}let Tt,je=null,lt=(()=>{var De;class le{build(){return new XMLHttpRequest}}return(De=le).\u0275fac=function(ae){return new(ae||De)},De.\u0275prov=F.Yz7({token:De,factory:De.\u0275fac}),le})();const Be=new F.OlP("EventManagerPlugins");let ut=(()=>{var De;class le{constructor(ae,_e){this._zone=_e,this._eventNameToPlugin=new Map,ae.forEach(it=>{it.manager=this}),this._plugins=ae.slice().reverse()}addEventListener(ae,_e,it){return this._findPluginFor(_e).addEventListener(ae,_e,it)}getZone(){return this._zone}_findPluginFor(ae){let _e=this._eventNameToPlugin.get(ae);if(_e)return _e;if(_e=this._plugins.find(kt=>kt.supports(ae)),!_e)throw new F.vHH(5101,!1);return this._eventNameToPlugin.set(ae,_e),_e}}return(De=le).\u0275fac=function(ae){return new(ae||De)(F.LFG(Be),F.LFG(F.R0b))},De.\u0275prov=F.Yz7({token:De,factory:De.\u0275fac}),le})();class mn{constructor(le){this._doc=le}}const zt="ng-app-id";let Ut=(()=>{var De;class le{constructor(ae,_e,it,kt={}){this.doc=ae,this.appId=_e,this.nonce=it,this.platformId=kt,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=(0,Ie.PM)(kt),this.resetHostNodes()}addStyles(ae){for(const _e of ae)1===this.changeUsageCount(_e,1)&&this.onStyleAdded(_e)}removeStyles(ae){for(const _e of ae)this.changeUsageCount(_e,-1)<=0&&this.onStyleRemoved(_e)}ngOnDestroy(){const ae=this.styleNodesInDOM;ae&&(ae.forEach(_e=>_e.remove()),ae.clear());for(const _e of this.getAllStyles())this.onStyleRemoved(_e);this.resetHostNodes()}addHost(ae){this.hostNodes.add(ae);for(const _e of this.getAllStyles())this.addStyleToHost(ae,_e)}removeHost(ae){this.hostNodes.delete(ae)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(ae){for(const _e of this.hostNodes)this.addStyleToHost(_e,ae)}onStyleRemoved(ae){const _e=this.styleRef;_e.get(ae)?.elements?.forEach(it=>it.remove()),_e.delete(ae)}collectServerRenderedStyles(){const ae=this.doc.head?.querySelectorAll(`style[${zt}="${this.appId}"]`);if(ae?.length){const _e=new Map;return ae.forEach(it=>{null!=it.textContent&&_e.set(it.textContent,it)}),_e}return null}changeUsageCount(ae,_e){const it=this.styleRef;if(it.has(ae)){const kt=it.get(ae);return kt.usage+=_e,kt.usage}return it.set(ae,{usage:_e,elements:[]}),_e}getStyleElement(ae,_e){const it=this.styleNodesInDOM,kt=it?.get(_e);if(kt?.parentNode===ae)return it.delete(_e),kt.removeAttribute(zt),kt;{const un=this.doc.createElement("style");return this.nonce&&un.setAttribute("nonce",this.nonce),un.textContent=_e,this.platformIsServer&&un.setAttribute(zt,this.appId),un}}addStyleToHost(ae,_e){const it=this.getStyleElement(ae,_e);ae.appendChild(it);const kt=this.styleRef,un=kt.get(_e)?.elements;un?un.push(it):kt.set(_e,{elements:[it],usage:1})}resetHostNodes(){const ae=this.hostNodes;ae.clear(),ae.add(this.doc.head)}}return(De=le).\u0275fac=function(ae){return new(ae||De)(F.LFG(Ie.K0),F.LFG(F.AFp),F.LFG(F.Ojb,8),F.LFG(F.Lbi))},De.\u0275prov=F.Yz7({token:De,factory:De.\u0275fac}),le})();const ai={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Vn=/%COMP%/g,st=new F.OlP("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function Et(De,le){return le.map(Ee=>Ee.replace(Vn,De))}let ft=(()=>{var De;class le{constructor(ae,_e,it,kt,un,Mn,Ii,ui=null){this.eventManager=ae,this.sharedStylesHost=_e,this.appId=it,this.removeStylesOnCompDestroy=kt,this.doc=un,this.platformId=Mn,this.ngZone=Ii,this.nonce=ui,this.rendererByCompId=new Map,this.platformIsServer=(0,Ie.PM)(Mn),this.defaultRenderer=new ot(ae,un,Ii,this.platformIsServer)}createRenderer(ae,_e){if(!ae||!_e)return this.defaultRenderer;this.platformIsServer&&_e.encapsulation===F.ifc.ShadowDom&&(_e={..._e,encapsulation:F.ifc.Emulated});const it=this.getOrCreateRenderer(ae,_e);return it instanceof hs?it.applyToHost(ae):it instanceof Nt&&it.applyStyles(),it}getOrCreateRenderer(ae,_e){const it=this.rendererByCompId;let kt=it.get(_e.id);if(!kt){const un=this.doc,Mn=this.ngZone,Ii=this.eventManager,ui=this.sharedStylesHost,is=this.removeStylesOnCompDestroy,ps=this.platformIsServer;switch(_e.encapsulation){case F.ifc.Emulated:kt=new hs(Ii,ui,_e,this.appId,is,un,Mn,ps);break;case F.ifc.ShadowDom:return new fs(Ii,ui,ae,_e,un,Mn,this.nonce,ps);default:kt=new Nt(Ii,ui,_e,is,un,Mn,ps)}it.set(_e.id,kt)}return kt}ngOnDestroy(){this.rendererByCompId.clear()}}return(De=le).\u0275fac=function(ae){return new(ae||De)(F.LFG(ut),F.LFG(Ut),F.LFG(F.AFp),F.LFG(st),F.LFG(Ie.K0),F.LFG(F.Lbi),F.LFG(F.R0b),F.LFG(F.Ojb))},De.\u0275prov=F.Yz7({token:De,factory:De.\u0275fac}),le})();class ot{constructor(le,Ee,ae,_e){this.eventManager=le,this.doc=Ee,this.ngZone=ae,this.platformIsServer=_e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(le,Ee){return Ee?this.doc.createElementNS(ai[Ee]||Ee,le):this.doc.createElement(le)}createComment(le){return this.doc.createComment(le)}createText(le){return this.doc.createTextNode(le)}appendChild(le,Ee){(vr(le)?le.content:le).appendChild(Ee)}insertBefore(le,Ee,ae){le&&(vr(le)?le.content:le).insertBefore(Ee,ae)}removeChild(le,Ee){le&&le.removeChild(Ee)}selectRootElement(le,Ee){let ae="string"==typeof le?this.doc.querySelector(le):le;if(!ae)throw new F.vHH(-5104,!1);return Ee||(ae.textContent=""),ae}parentNode(le){return le.parentNode}nextSibling(le){return le.nextSibling}setAttribute(le,Ee,ae,_e){if(_e){Ee=_e+":"+Ee;const it=ai[_e];it?le.setAttributeNS(it,Ee,ae):le.setAttribute(Ee,ae)}else le.setAttribute(Ee,ae)}removeAttribute(le,Ee,ae){if(ae){const _e=ai[ae];_e?le.removeAttributeNS(_e,Ee):le.removeAttribute(`${ae}:${Ee}`)}else le.removeAttribute(Ee)}addClass(le,Ee){le.classList.add(Ee)}removeClass(le,Ee){le.classList.remove(Ee)}setStyle(le,Ee,ae,_e){_e&(F.JOm.DashCase|F.JOm.Important)?le.style.setProperty(Ee,ae,_e&F.JOm.Important?"important":""):le.style[Ee]=ae}removeStyle(le,Ee,ae){ae&F.JOm.DashCase?le.style.removeProperty(Ee):le.style[Ee]=""}setProperty(le,Ee,ae){le[Ee]=ae}setValue(le,Ee){le.nodeValue=Ee}listen(le,Ee,ae){if("string"==typeof le&&!(le=(0,Ie.q)().getGlobalEventTarget(this.doc,le)))throw new Error(`Unsupported event target ${le} for event ${Ee}`);return this.eventManager.addEventListener(le,Ee,this.decoratePreventDefault(ae))}decoratePreventDefault(le){return Ee=>{if("__ngUnwrap__"===Ee)return le;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>le(Ee)):le(Ee))&&Ee.preventDefault()}}}function vr(De){return"TEMPLATE"===De.tagName&&void 0!==De.content}class fs extends ot{constructor(le,Ee,ae,_e,it,kt,un,Mn){super(le,it,kt,Mn),this.sharedStylesHost=Ee,this.hostEl=ae,this.shadowRoot=ae.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const Ii=Et(_e.id,_e.styles);for(const ui of Ii){const is=document.createElement("style");un&&is.setAttribute("nonce",un),is.textContent=ui,this.shadowRoot.appendChild(is)}}nodeOrShadowRoot(le){return le===this.hostEl?this.shadowRoot:le}appendChild(le,Ee){return super.appendChild(this.nodeOrShadowRoot(le),Ee)}insertBefore(le,Ee,ae){return super.insertBefore(this.nodeOrShadowRoot(le),Ee,ae)}removeChild(le,Ee){return super.removeChild(this.nodeOrShadowRoot(le),Ee)}parentNode(le){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(le)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Nt extends ot{constructor(le,Ee,ae,_e,it,kt,un,Mn){super(le,it,kt,un),this.sharedStylesHost=Ee,this.removeStylesOnCompDestroy=_e,this.styles=Mn?Et(Mn,ae.styles):ae.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class hs extends Nt{constructor(le,Ee,ae,_e,it,kt,un,Mn){const Ii=_e+"-"+ae.id;super(le,Ee,ae,it,kt,un,Mn,Ii),this.contentAttr=function Dt(De){return"_ngcontent-%COMP%".replace(Vn,De)}(Ii),this.hostAttr=function yn(De){return"_nghost-%COMP%".replace(Vn,De)}(Ii)}applyToHost(le){this.applyStyles(),this.setAttribute(le,this.hostAttr,"")}createElement(le,Ee){const ae=super.createElement(le,Ee);return super.setAttribute(ae,this.contentAttr,""),ae}}let Kt=(()=>{var De;class le extends mn{constructor(ae){super(ae)}supports(ae){return!0}addEventListener(ae,_e,it){return ae.addEventListener(_e,it,!1),()=>this.removeEventListener(ae,_e,it)}removeEventListener(ae,_e,it){return ae.removeEventListener(_e,it)}}return(De=le).\u0275fac=function(ae){return new(ae||De)(F.LFG(Ie.K0))},De.\u0275prov=F.Yz7({token:De,factory:De.\u0275fac}),le})();const In=["alt","control","meta","shift"],be={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ye={alt:De=>De.altKey,control:De=>De.ctrlKey,meta:De=>De.metaKey,shift:De=>De.shiftKey};let Ne=(()=>{var De;class le extends mn{constructor(ae){super(ae)}supports(ae){return null!=le.parseEventName(ae)}addEventListener(ae,_e,it){const kt=le.parseEventName(_e),un=le.eventCallback(kt.fullKey,it,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,Ie.q)().onAndCancel(ae,kt.domEventName,un))}static parseEventName(ae){const _e=ae.toLowerCase().split("."),it=_e.shift();if(0===_e.length||"keydown"!==it&&"keyup"!==it)return null;const kt=le._normalizeKey(_e.pop());let un="",Mn=_e.indexOf("code");if(Mn>-1&&(_e.splice(Mn,1),un="code."),In.forEach(ui=>{const is=_e.indexOf(ui);is>-1&&(_e.splice(is,1),un+=ui+".")}),un+=kt,0!=_e.length||0===kt.length)return null;const Ii={};return Ii.domEventName=it,Ii.fullKey=un,Ii}static matchEventFullKeyCode(ae,_e){let it=be[ae.key]||ae.key,kt="";return _e.indexOf("code.")>-1&&(it=ae.code,kt="code."),!(null==it||!it)&&(it=it.toLowerCase()," "===it?it="space":"."===it&&(it="dot"),In.forEach(un=>{un!==it&&(0,ye[un])(ae)&&(kt+=un+".")}),kt+=it,kt===_e)}static eventCallback(ae,_e,it){return kt=>{le.matchEventFullKeyCode(kt,ae)&&it.runGuarded(()=>_e(kt))}}static _normalizeKey(ae){return"esc"===ae?"escape":ae}}return(De=le).\u0275fac=function(ae){return new(ae||De)(F.LFG(Ie.K0))},De.\u0275prov=F.Yz7({token:De,factory:De.\u0275fac}),le})();const Ai=(0,F.eFA)(F._c5,"browser",[{provide:F.Lbi,useValue:Ie.bD},{provide:F.g9A,useValue:function jn(){at.makeCurrent()},multi:!0},{provide:Ie.K0,useFactory:function tn(){return(0,F.RDi)(document),document},deps:[]}]),Ci=new F.OlP(""),Ji=[{provide:F.rWj,useClass:class jt{addToWindow(le){F.dqk.getAngularTestability=(ae,_e=!0)=>{const it=le.findTestabilityInTree(ae,_e);if(null==it)throw new F.vHH(5103,!1);return it},F.dqk.getAllAngularTestabilities=()=>le.getAllTestabilities(),F.dqk.getAllAngularRootElements=()=>le.getAllRootElements(),F.dqk.frameworkStabilizers||(F.dqk.frameworkStabilizers=[]),F.dqk.frameworkStabilizers.push(ae=>{const _e=F.dqk.getAllAngularTestabilities();let it=_e.length,kt=!1;const un=function(Mn){kt=kt||Mn,it--,0==it&&ae(kt)};_e.forEach(Mn=>{Mn.whenStable(un)})})}findTestabilityInTree(le,Ee,ae){return null==Ee?null:le.getTestability(Ee)??(ae?(0,Ie.q)().isShadowRoot(Ee)?this.findTestabilityInTree(le,Ee.host,!0):this.findTestabilityInTree(le,Ee.parentElement,!0):null)}},deps:[]},{provide:F.lri,useClass:F.dDg,deps:[F.R0b,F.eoX,F.rWj]},{provide:F.dDg,useClass:F.dDg,deps:[F.R0b,F.eoX,F.rWj]}],Qi=[{provide:F.zSh,useValue:"root"},{provide:F.qLn,useFactory:function ki(){return new F.qLn},deps:[]},{provide:Be,useClass:Kt,multi:!0,deps:[Ie.K0,F.R0b,F.Lbi]},{provide:Be,useClass:Ne,multi:!0,deps:[Ie.K0]},ft,Ut,ut,{provide:F.FYo,useExisting:ft},{provide:Ie.JF,useClass:lt,deps:[]},[]];let li=(()=>{var De;class le{constructor(ae){}static withServerTransition(ae){return{ngModule:le,providers:[{provide:F.AFp,useValue:ae.appId}]}}}return(De=le).\u0275fac=function(ae){return new(ae||De)(F.LFG(Ci,12))},De.\u0275mod=F.oAB({type:De}),De.\u0275inj=F.cJS({providers:[...Qi,...Ji],imports:[Ie.ez,F.hGG]}),le})(),_a=(()=>{var De;class le{constructor(ae){this._doc=ae}getTitle(){return this._doc.title}setTitle(ae){this._doc.title=ae||""}}return(De=le).\u0275fac=function(ae){return new(ae||De)(F.LFG(Ie.K0))},De.\u0275prov=F.Yz7({token:De,factory:function(ae){let _e=null;return _e=ae?new ae:function wl(){return new _a((0,F.LFG)(Ie.K0))}(),_e},providedIn:"root"}),le})();typeof window<"u"&&window},385:(On,_t,se)=>{se.d(_t,{Bz:()=>af,lC:()=>Qo});var F=se(946),Ie=se(592),Ae=se(674),je=se(715),Je=se(96),Tt=se(619);const{isArray:Tn}=Array,{getPrototypeOf:jt,prototype:lt,keys:Be}=Object;var zt=se(737),Ut=se(398);const{isArray:ai}=Array;var ni=se(564),ke=se(251),st=se(103);function Dt(..._){const S=(0,ni.yG)(_),C=(0,ni.jO)(_),{args:E,keys:R}=function ut(_){if(1===_.length){const S=_[0];if(Tn(S))return{args:S,keys:null};if(function mn(_){return _&&"object"==typeof _&&jt(_)===lt}(S)){const C=Be(S);return{args:C.map(E=>S[E]),keys:C}}}return{args:_,keys:null}}(_);if(0===E.length)return(0,je.D)([],S);const H=new Ie.y(function yn(_,S,C=zt.y){return E=>{Et(S,()=>{const{length:R}=_,H=new Array(R);let X=R,ue=R;for(let Ve=0;Ve<R;Ve++)Et(S,()=>{const Me=(0,je.D)(_[Ve],S);let $t=!1;Me.subscribe((0,ke.x)(E,en=>{H[Ve]=en,$t||($t=!0,ue--),ue||E.next(C(H.slice()))},()=>{--X||E.complete()}))},E)},E)}}(E,S,R?X=>function _i(_,S){return _.reduce((C,E,R)=>(C[E]=S[R],C),{})}(R,X):zt.y));return C?H.pipe(function si(_){return(0,Ut.U)(S=>function Vn(_,S){return ai(S)?_(...S):_(S)}(_,S))}(C)):H}function Et(_,S,C){_?(0,st.f)(C,_,S):S()}const ot=(0,se(306).d)(_=>function(){_(this),this.name="EmptyError",this.message="no elements in sequence"});var Zt=se(537);function vr(..._){return function cr(){return(0,Zt.J)(1)}()((0,je.D)(_,(0,ni.yG)(_)))}var fs=se(829);function Nt(_){return new Ie.y(S=>{(0,fs.Xf)(_()).subscribe(S)})}var hs=se(407);function Kt(_,S){const C=(0,Ae.m)(_)?_:()=>_,E=R=>R.error(C());return new Ie.y(S?R=>S.schedule(E,0,R):E)}var In=se(232),be=se(394),ye=se(360);function Ne(){return(0,ye.e)((_,S)=>{let C=null;_._refCount++;const E=(0,ke.x)(S,void 0,void 0,void 0,()=>{if(!_||_._refCount<=0||0<--_._refCount)return void(C=null);const R=_._connection,H=C;C=null,R&&(!H||R===H)&&R.unsubscribe(),S.unsubscribe()});_.subscribe(E),E.closed||(C=_.connect())})}class Le extends Ie.y{constructor(S,C){super(),this.source=S,this.subjectFactory=C,this._subject=null,this._refCount=0,this._connection=null,(0,ye.A)(S)&&(this.lift=S.lift)}_subscribe(S){return this.getSubject().subscribe(S)}getSubject(){const S=this._subject;return(!S||S.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:S}=this;this._subject=this._connection=null,S?.unsubscribe()}connect(){let S=this._connection;if(!S){S=this._connection=new be.w0;const C=this.getSubject();S.add(this.source.subscribe((0,ke.x)(C,void 0,()=>{this._teardown(),C.complete()},E=>{this._teardown(),C.error(E)},()=>this._teardown()))),S.closed&&(this._connection=null,S=be.w0.EMPTY)}return S}refCount(){return Ne()(this)}}var $e=se(645),nt=se(814),Jt=se(535);function jn(_){return _<=0?()=>In.E:(0,ye.e)((S,C)=>{let E=0;S.subscribe((0,ke.x)(C,R=>{++E<=_&&(C.next(R),_<=E&&C.complete())}))})}function tn(_,S){return(0,ye.e)((C,E)=>{let R=0;C.subscribe((0,ke.x)(E,H=>_.call(S,H,R++)&&E.next(H)))})}var Nn=se(631);function Ai(_){return(0,ye.e)((S,C)=>{let E=!1;S.subscribe((0,ke.x)(C,R=>{E=!0,C.next(R)},()=>{E||C.next(_),C.complete()}))})}function Ci(_=Ji){return(0,ye.e)((S,C)=>{let E=!1;S.subscribe((0,ke.x)(C,R=>{E=!0,C.next(R)},()=>E?C.complete():C.error(_())))})}function Ji(){return new ot}function Qi(_,S){const C=arguments.length>=2;return E=>E.pipe(_?tn((R,H)=>_(R,H,E)):zt.y,jn(1),C?Ai(S):Ci(()=>new ot))}function li(_,S){return(0,Ae.m)(S)?(0,Nn.z)(_,S,1):(0,Nn.z)(_,1)}function fi(_,S,C){const E=(0,Ae.m)(_)||S||C?{next:_,error:S,complete:C}:_;return E?(0,ye.e)((R,H)=>{var X;null===(X=E.subscribe)||void 0===X||X.call(E);let ue=!0;R.subscribe((0,ke.x)(H,Ve=>{var Me;null===(Me=E.next)||void 0===Me||Me.call(E,Ve),H.next(Ve)},()=>{var Ve;ue=!1,null===(Ve=E.complete)||void 0===Ve||Ve.call(E),H.complete()},Ve=>{var Me;ue=!1,null===(Me=E.error)||void 0===Me||Me.call(E,Ve),H.error(Ve)},()=>{var Ve,Me;ue&&(null===(Ve=E.unsubscribe)||void 0===Ve||Ve.call(E)),null===(Me=E.finalize)||void 0===Me||Me.call(E)}))}):zt.y}function hi(_){return(0,ye.e)((S,C)=>{let H,E=null,R=!1;E=S.subscribe((0,ke.x)(C,void 0,void 0,X=>{H=(0,fs.Xf)(_(X,hi(_)(S))),E?(E.unsubscribe(),E=null,H.subscribe(C)):R=!0})),R&&(E.unsubscribe(),E=null,H.subscribe(C))})}function _a(_){return _<=0?()=>In.E:(0,ye.e)((S,C)=>{let E=[];S.subscribe((0,ke.x)(C,R=>{E.push(R),_<E.length&&E.shift()},()=>{for(const R of E)C.next(R);C.complete()},void 0,()=>{E=null}))})}function Xr(_){return(0,ye.e)((S,C)=>{try{S.subscribe(C)}finally{C.add(_)}})}var zn=se(420),$a=se(593);const on="primary",Bi=Symbol("RouteTitle");class Ar{constructor(S){this.params=S||{}}has(S){return Object.prototype.hasOwnProperty.call(this.params,S)}get(S){if(this.has(S)){const C=this.params[S];return Array.isArray(C)?C[0]:C}return null}getAll(S){if(this.has(S)){const C=this.params[S];return Array.isArray(C)?C:[C]}return[]}get keys(){return Object.keys(this.params)}}function bi(_){return new Ar(_)}function go(_,S,C){const E=C.path.split("/");if(E.length>_.length||"full"===C.pathMatch&&(S.hasChildren()||E.length<_.length))return null;const R={};for(let H=0;H<E.length;H++){const X=E[H],ue=_[H];if(X.startsWith(":"))R[X.substring(1)]=ue;else if(X!==ue.path)return null}return{consumed:_.slice(0,E.length),posParams:R}}function er(_,S){const C=_?Object.keys(_):void 0,E=S?Object.keys(S):void 0;if(!C||!E||C.length!=E.length)return!1;let R;for(let H=0;H<C.length;H++)if(R=C[H],!Mt(_[R],S[R]))return!1;return!0}function Mt(_,S){if(Array.isArray(_)&&Array.isArray(S)){if(_.length!==S.length)return!1;const C=[..._].sort(),E=[...S].sort();return C.every((R,H)=>E[H]===R)}return _===S}function Ts(_){return _.length>0?_[_.length-1]:null}function Zn(_){return function at(_){return!!_&&(_ instanceof Ie.y||(0,Ae.m)(_.lift)&&(0,Ae.m)(_.subscribe))}(_)?_:(0,F.QGY)(_)?(0,je.D)(Promise.resolve(_)):(0,Je.of)(_)}const $i={exact:function Mi(_,S,C){if(!Ee(_.segments,S.segments)||!jo(_.segments,S.segments,C)||_.numberOfChildren!==S.numberOfChildren)return!1;for(const E in S.children)if(!_.children[E]||!Mi(_.children[E],S.children[E],C))return!1;return!0},subset:Wo},zo={exact:function Di(_,S){return er(_,S)},subset:function Go(_,S){return Object.keys(S).length<=Object.keys(_).length&&Object.keys(S).every(C=>Mt(_[C],S[C]))},ignored:()=>!0};function vo(_,S,C){return $i[C.paths](_.root,S.root,C.matrixParams)&&zo[C.queryParams](_.queryParams,S.queryParams)&&!("exact"===C.fragment&&_.fragment!==S.fragment)}function Wo(_,S,C){return Or(_,S,S.segments,C)}function Or(_,S,C,E){if(_.segments.length>C.length){const R=_.segments.slice(0,C.length);return!(!Ee(R,C)||S.hasChildren()||!jo(R,C,E))}if(_.segments.length===C.length){if(!Ee(_.segments,C)||!jo(_.segments,C,E))return!1;for(const R in S.children)if(!_.children[R]||!Wo(_.children[R],S.children[R],E))return!1;return!0}{const R=C.slice(0,_.segments.length),H=C.slice(_.segments.length);return!!(Ee(_.segments,R)&&jo(_.segments,R,E)&&_.children[on])&&Or(_.children[on],S,H,E)}}function jo(_,S,C){return S.every((E,R)=>zo[C](_[R].parameters,E.parameters))}class lr{constructor(S=new ii([],{}),C={},E=null){this.root=S,this.queryParams=C,this.fragment=E}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=bi(this.queryParams)),this._queryParamMap}toString(){return kt.serialize(this)}}class ii{constructor(S,C){this.segments=S,this.children=C,this.parent=null,Object.values(C).forEach(E=>E.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return un(this)}}class De{constructor(S,C){this.path=S,this.parameters=C}get parameterMap(){return this._parameterMap||(this._parameterMap=bi(this.parameters)),this._parameterMap}toString(){return As(this)}}function Ee(_,S){return _.length===S.length&&_.every((C,E)=>C.path===S[E].path)}let _e=(()=>{var _;class S{}return(_=S).\u0275fac=function(E){return new(E||_)},_.\u0275prov=F.Yz7({token:_,factory:function(){return new it},providedIn:"root"}),S})();class it{parse(S){const C=new Yr(S);return new lr(C.parseRootSegment(),C.parseQueryParams(),C.parseFragment())}serialize(S){const C=`/${Mn(S.root,!0)}`,E=function ur(_){const S=Object.keys(_).map(C=>{const E=_[C];return Array.isArray(E)?E.map(R=>`${ui(C)}=${ui(R)}`).join("&"):`${ui(C)}=${ui(E)}`}).filter(C=>!!C);return S.length?`?${S.join("&")}`:""}(S.queryParams);return`${C}${E}${"string"==typeof S.fragment?`#${function is(_){return encodeURI(_)}(S.fragment)}`:""}`}}const kt=new it;function un(_){return _.segments.map(S=>As(S)).join("/")}function Mn(_,S){if(!_.hasChildren())return un(_);if(S){const C=_.children[on]?Mn(_.children[on],!1):"",E=[];return Object.entries(_.children).forEach(([R,H])=>{R!==on&&E.push(`${R}:${Mn(H,!1)}`)}),E.length>0?`${C}(${E.join("//")})`:C}{const C=function ae(_,S){let C=[];return Object.entries(_.children).forEach(([E,R])=>{E===on&&(C=C.concat(S(R,E)))}),Object.entries(_.children).forEach(([E,R])=>{E!==on&&(C=C.concat(S(R,E)))}),C}(_,(E,R)=>R===on?[Mn(_.children[on],!1)]:[`${R}:${Mn(E,!1)}`]);return 1===Object.keys(_.children).length&&null!=_.children[on]?`${un(_)}/${C[0]}`:`${un(_)}/(${C.join("//")})`}}function Ii(_){return encodeURIComponent(_).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ui(_){return Ii(_).replace(/%3B/gi,";")}function ps(_){return Ii(_).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function yr(_){return decodeURIComponent(_)}function yo(_){return yr(_.replace(/\+/g,"%20"))}function As(_){return`${ps(_.path)}${function Xa(_){return Object.keys(_).map(S=>`;${ps(S)}=${ps(_[S])}`).join("")}(_.parameters)}`}const Dc=/^[^\/()?;#]+/;function ri(_){const S=_.match(Dc);return S?S[0]:""}const zs=/^[^\/()?;=#]+/,Gs=/^[^=?&#]+/,Du=/^[^&#]+/;class Yr{constructor(S){this.url=S,this.remaining=S}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new ii([],{}):new ii([],this.parseChildren())}parseQueryParams(){const S={};if(this.consumeOptional("?"))do{this.parseQueryParam(S)}while(this.consumeOptional("&"));return S}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const S=[];for(this.peekStartsWith("(")||S.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),S.push(this.parseSegment());let C={};this.peekStartsWith("/(")&&(this.capture("/"),C=this.parseParens(!0));let E={};return this.peekStartsWith("(")&&(E=this.parseParens(!1)),(S.length>0||Object.keys(C).length>0)&&(E[on]=new ii(S,C)),E}parseSegment(){const S=ri(this.remaining);if(""===S&&this.peekStartsWith(";"))throw new F.vHH(4009,!1);return this.capture(S),new De(yr(S),this.parseMatrixParams())}parseMatrixParams(){const S={};for(;this.consumeOptional(";");)this.parseParam(S);return S}parseParam(S){const C=function _o(_){const S=_.match(zs);return S?S[0]:""}(this.remaining);if(!C)return;this.capture(C);let E="";if(this.consumeOptional("=")){const R=ri(this.remaining);R&&(E=R,this.capture(E))}S[yr(C)]=yr(E)}parseQueryParam(S){const C=function Ic(_){const S=_.match(Gs);return S?S[0]:""}(this.remaining);if(!C)return;this.capture(C);let E="";if(this.consumeOptional("=")){const X=function Tl(_){const S=_.match(Du);return S?S[0]:""}(this.remaining);X&&(E=X,this.capture(E))}const R=yo(C),H=yo(E);if(S.hasOwnProperty(R)){let X=S[R];Array.isArray(X)||(X=[X],S[R]=X),X.push(H)}else S[R]=H}parseParens(S){const C={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const E=ri(this.remaining),R=this.remaining[E.length];if("/"!==R&&")"!==R&&";"!==R)throw new F.vHH(4010,!1);let H;E.indexOf(":")>-1?(H=E.slice(0,E.indexOf(":")),this.capture(H),this.capture(":")):S&&(H=on);const X=this.parseChildren();C[H]=1===Object.keys(X).length?X[on]:new ii([],X),this.consumeOptional("//")}return C}peekStartsWith(S){return this.remaining.startsWith(S)}consumeOptional(S){return!!this.peekStartsWith(S)&&(this.remaining=this.remaining.substring(S.length),!0)}capture(S){if(!this.consumeOptional(S))throw new F.vHH(4011,!1)}}function Mo(_){return _.segments.length>0?new ii([],{[on]:_}):_}function Cs(_){const S={};for(const E of Object.keys(_.children)){const H=Cs(_.children[E]);if(E===on&&0===H.segments.length&&H.hasChildren())for(const[X,ue]of Object.entries(H.children))S[X]=ue;else(H.segments.length>0||H.hasChildren())&&(S[E]=H)}return function rs(_){if(1===_.numberOfChildren&&_.children[on]){const S=_.children[on];return new ii(_.segments.concat(S.segments),S.children)}return _}(new ii(_.segments,S))}function Rn(_){return _ instanceof lr}function xa(_){let S;const R=Mo(function C(H){const X={};for(const Ve of H.children){const Me=C(Ve);X[Ve.outlet]=Me}const ue=new ii(H.url,X);return H===_&&(S=ue),ue}(_.root));return S??R}function $o(_,S,C,E){let R=_;for(;R.parent;)R=R.parent;if(0===S.length)return Ws(R,R,R,C,E);const H=function Yo(_){if("string"==typeof _[0]&&1===_.length&&"/"===_[0])return new Xo(!0,0,_);let S=0,C=!1;const E=_.reduce((R,H,X)=>{if("object"==typeof H&&null!=H){if(H.outlets){const ue={};return Object.entries(H.outlets).forEach(([Ve,Me])=>{ue[Ve]="string"==typeof Me?Me.split("/"):Me}),[...R,{outlets:ue}]}if(H.segmentPath)return[...R,H.segmentPath]}return"string"!=typeof H?[...R,H]:0===X?(H.split("/").forEach((ue,Ve)=>{0==Ve&&"."===ue||(0==Ve&&""===ue?C=!0:".."===ue?S++:""!=ue&&R.push(ue))}),R):[...R,H]},[]);return new Xo(C,S,E)}(S);if(H.toRoot())return Ws(R,R,new ii([],{}),C,E);const X=function Rc(_,S,C){if(_.isAbsolute)return new qo(S,!0,0);if(!C)return new qo(S,!1,NaN);if(null===C.parent)return new qo(C,!0,0);const E=Ea(_.commands[0])?0:1;return function ba(_,S,C){let E=_,R=S,H=C;for(;H>R;){if(H-=R,E=E.parent,!E)throw new F.vHH(4005,!1);R=E.segments.length}return new qo(E,!1,R-H)}(C,C.segments.length-1+E,_.numberOfDoubleDots)}(H,R,_),ue=X.processChildren?Zo(X.segmentGroup,X.index,H.commands):Pc(X.segmentGroup,X.index,H.commands);return Ws(R,X.segmentGroup,ue,C,E)}function Ea(_){return"object"==typeof _&&null!=_&&!_.outlets&&!_.segmentPath}function Cr(_){return"object"==typeof _&&null!=_&&_.outlets}function Ws(_,S,C,E,R){let X,H={};E&&Object.entries(E).forEach(([Ve,Me])=>{H[Ve]=Array.isArray(Me)?Me.map($t=>`${$t}`):`${Me}`}),X=_===S?C:Sa(_,S,C);const ue=Mo(Cs(X));return new lr(ue,H,R)}function Sa(_,S,C){const E={};return Object.entries(_.children).forEach(([R,H])=>{E[R]=H===S?C:Sa(H,S,C)}),new ii(_.segments,E)}class Xo{constructor(S,C,E){if(this.isAbsolute=S,this.numberOfDoubleDots=C,this.commands=E,S&&E.length>0&&Ea(E[0]))throw new F.vHH(4003,!1);const R=E.find(Cr);if(R&&R!==Ts(E))throw new F.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class qo{constructor(S,C,E){this.segmentGroup=S,this.processChildren=C,this.index=E}}function Pc(_,S,C){if(_||(_=new ii([],{})),0===_.segments.length&&_.hasChildren())return Zo(_,S,C);const E=function Al(_,S,C){let E=0,R=S;const H={match:!1,pathIndex:0,commandIndex:0};for(;R<_.segments.length;){if(E>=C.length)return H;const X=_.segments[R],ue=C[E];if(Cr(ue))break;const Ve=`${ue}`,Me=E<C.length-1?C[E+1]:null;if(R>0&&void 0===Ve)break;if(Ve&&Me&&"object"==typeof Me&&void 0===Me.outlets){if(!Nc(Ve,Me,X))return H;E+=2}else{if(!Nc(Ve,{},X))return H;E++}R++}return{match:!0,pathIndex:R,commandIndex:E}}(_,S,C),R=C.slice(E.commandIndex);if(E.match&&E.pathIndex<_.segments.length){const H=new ii(_.segments.slice(0,E.pathIndex),{});return H.children[on]=new ii(_.segments.slice(E.pathIndex),_.children),Zo(H,0,R)}return E.match&&0===R.length?new ii(_.segments,{}):E.match&&!_.hasChildren()?Lc(_,S,C):E.match?Zo(_,0,R):Lc(_,S,C)}function Zo(_,S,C){if(0===C.length)return new ii(_.segments,{});{const E=function Ya(_){return Cr(_[0])?_[0].outlets:{[on]:_}}(C),R={};if(Object.keys(E).some(H=>H!==on)&&_.children[on]&&1===_.numberOfChildren&&0===_.children[on].segments.length){const H=Zo(_.children[on],S,C);return new ii(_.segments,H.children)}return Object.entries(E).forEach(([H,X])=>{"string"==typeof X&&(X=[X]),null!==X&&(R[H]=Pc(_.children[H],S,X))}),Object.entries(_.children).forEach(([H,X])=>{void 0===E[H]&&(R[H]=X)}),new ii(_.segments,R)}}function Lc(_,S,C){const E=_.segments.slice(0,S);let R=0;for(;R<C.length;){const H=C[R];if(Cr(H)){const Ve=ss(H.outlets);return new ii(E,Ve)}if(0===R&&Ea(C[0])){E.push(new De(_.segments[S].path,Fr(C[0]))),R++;continue}const X=Cr(H)?H.outlets[on]:`${H}`,ue=R<C.length-1?C[R+1]:null;X&&ue&&Ea(ue)?(E.push(new De(X,Fr(ue))),R+=2):(E.push(new De(X,{})),R++)}return new ii(E,{})}function ss(_){const S={};return Object.entries(_).forEach(([C,E])=>{"string"==typeof E&&(E=[E]),null!==E&&(S[C]=Lc(new ii([],{}),0,E))}),S}function Fr(_){const S={};return Object.entries(_).forEach(([C,E])=>S[C]=`${E}`),S}function Nc(_,S,C){return _==C.path&&er(S,C.parameters)}const xo="imperative";class ms{constructor(S,C){this.id=S,this.url=C}}class qa extends ms{constructor(S,C,E="imperative",R=null){super(S,C),this.type=0,this.navigationTrigger=E,this.restoredState=R}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class js extends ms{constructor(S,C,E){super(S,C),this.urlAfterRedirects=E,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Ds extends ms{constructor(S,C,E,R){super(S,C),this.reason=E,this.code=R,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class qr extends ms{constructor(S,C,E,R){super(S,C),this.reason=E,this.code=R,this.type=16}}class Ko extends ms{constructor(S,C,E,R){super(S,C),this.error=E,this.target=R,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Eo extends ms{constructor(S,C,E,R){super(S,C),this.urlAfterRedirects=E,this.state=R,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Jo extends ms{constructor(S,C,E,R){super(S,C),this.urlAfterRedirects=E,this.state=R,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class wa extends ms{constructor(S,C,E,R,H){super(S,C),this.urlAfterRedirects=E,this.state=R,this.shouldActivate=H,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Oc extends ms{constructor(S,C,E,R){super(S,C),this.urlAfterRedirects=E,this.state=R,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Cl extends ms{constructor(S,C,E,R){super(S,C),this.urlAfterRedirects=E,this.state=R,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Iu{constructor(S){this.route=S,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Za{constructor(S){this.route=S,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Fc{constructor(S){this.snapshot=S,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Uc{constructor(S){this.snapshot=S,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $s{constructor(S){this.snapshot=S,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class kc{constructor(S){this.snapshot=S,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $n{constructor(S,C,E){this.routerEvent=S,this.position=C,this.anchor=E,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class xi{}class tr{constructor(S){this.url=S}}class _n{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Oi,this.attachRef=null}}let Oi=(()=>{var _;class S{constructor(){this.contexts=new Map}onChildOutletCreated(E,R){const H=this.getOrCreateContext(E);H.outlet=R,this.contexts.set(E,H)}onChildOutletDestroyed(E){const R=this.getContext(E);R&&(R.outlet=null,R.attachRef=null)}onOutletDeactivated(){const E=this.contexts;return this.contexts=new Map,E}onOutletReAttached(E){this.contexts=E}getOrCreateContext(E){let R=this.getContext(E);return R||(R=new _n,this.contexts.set(E,R)),R}getContext(E){return this.contexts.get(E)||null}}return(_=S).\u0275fac=function(E){return new(E||_)},_.\u0275prov=F.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),S})();class Ta{constructor(S){this._root=S}get root(){return this._root.value}parent(S){const C=this.pathFromRoot(S);return C.length>1?C[C.length-2]:null}children(S){const C=Aa(S,this._root);return C?C.children.map(E=>E.value):[]}firstChild(S){const C=Aa(S,this._root);return C&&C.children.length>0?C.children[0].value:null}siblings(S){const C=Bc(S,this._root);return C.length<2?[]:C[C.length-2].children.map(R=>R.value).filter(R=>R!==S)}pathFromRoot(S){return Bc(S,this._root).map(C=>C.value)}}function Aa(_,S){if(_===S.value)return S;for(const C of S.children){const E=Aa(_,C);if(E)return E}return null}function Bc(_,S){if(_===S.value)return[S];for(const C of S.children){const E=Bc(_,C);if(E.length)return E.unshift(S),E}return[]}class os{constructor(S,C){this.value=S,this.children=C}toString(){return`TreeNode(${this.value})`}}function mi(_){const S={};return _&&_.children.forEach(C=>S[C.value.outlet]=C),S}class At extends Ta{constructor(S,C){super(S),this.snapshot=C,Is(this,S)}toString(){return this.snapshot.toString()}}function xn(_,S){const C=function Ri(_,S){const X=new Xs([],{},{},"",{},on,S,null,{});return new Hi("",new os(X,[]))}(0,S),E=new Tt.X([new De("",{})]),R=new Tt.X({}),H=new Tt.X({}),X=new Tt.X({}),ue=new Tt.X(""),Ve=new Dr(E,R,X,ue,H,on,S,C.root);return Ve.snapshot=C.root,new At(new os(Ve,[]),C)}class Dr{constructor(S,C,E,R,H,X,ue,Ve){this.urlSubject=S,this.paramsSubject=C,this.queryParamsSubject=E,this.fragmentSubject=R,this.dataSubject=H,this.outlet=X,this.component=ue,this._futureSnapshot=Ve,this.title=this.dataSubject?.pipe((0,Ut.U)(Me=>Me[Bi]))??(0,Je.of)(void 0),this.url=S,this.params=C,this.queryParams=E,this.fragment=R,this.data=H}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Ut.U)(S=>bi(S)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Ut.U)(S=>bi(S)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Ka(_,S="emptyOnly"){const C=_.pathFromRoot;let E=0;if("always"!==S)for(E=C.length-1;E>=1;){const R=C[E],H=C[E-1];if(R.routeConfig&&""===R.routeConfig.path)E--;else{if(H.component)break;E--}}return function Ir(_){return _.reduce((S,C)=>({params:{...S.params,...C.params},data:{...S.data,...C.data},resolve:{...C.data,...S.resolve,...C.routeConfig?.data,...C._resolvedData}}),{params:{},data:{},resolve:{}})}(C.slice(E))}class Xs{get title(){return this.data?.[Bi]}constructor(S,C,E,R,H,X,ue,Ve,Me){this.url=S,this.params=C,this.queryParams=E,this.fragment=R,this.data=H,this.outlet=X,this.component=ue,this.routeConfig=Ve,this._resolve=Me}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=bi(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=bi(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(E=>E.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Hi extends Ta{constructor(S,C){super(C),this.url=S,Is(this,C)}toString(){return Ca(this._root)}}function Is(_,S){S.value._routerState=_,S.children.forEach(C=>Is(_,C))}function Ca(_){const S=_.children.length>0?` { ${_.children.map(Ca).join(", ")} } `:"";return`${_.value}${S}`}function hn(_){if(_.snapshot){const S=_.snapshot,C=_._futureSnapshot;_.snapshot=C,er(S.queryParams,C.queryParams)||_.queryParamsSubject.next(C.queryParams),S.fragment!==C.fragment&&_.fragmentSubject.next(C.fragment),er(S.params,C.params)||_.paramsSubject.next(C.params),function pi(_,S){if(_.length!==S.length)return!1;for(let C=0;C<_.length;++C)if(!er(_[C],S[C]))return!1;return!0}(S.url,C.url)||_.urlSubject.next(C.url),er(S.data,C.data)||_.dataSubject.next(C.data)}else _.snapshot=_._futureSnapshot,_.dataSubject.next(_._futureSnapshot.data)}function Da(_,S){const C=er(_.params,S.params)&&function le(_,S){return Ee(_,S)&&_.every((C,E)=>er(C.parameters,S[E].parameters))}(_.url,S.url);return C&&!(!_.parent!=!S.parent)&&(!_.parent||Da(_.parent,S.parent))}let Qo=(()=>{var _;class S{constructor(){this.activated=null,this._activatedRoute=null,this.name=on,this.activateEvents=new F.vpe,this.deactivateEvents=new F.vpe,this.attachEvents=new F.vpe,this.detachEvents=new F.vpe,this.parentContexts=(0,F.f3M)(Oi),this.location=(0,F.f3M)(F.s_b),this.changeDetector=(0,F.f3M)(F.sBO),this.environmentInjector=(0,F.f3M)(F.lqb),this.inputBinder=(0,F.f3M)(wi,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(E){if(E.name){const{firstChange:R,previousValue:H}=E.name;if(R)return;this.isTrackedInParentContexts(H)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(H)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(E){return this.parentContexts.getContext(E)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const E=this.parentContexts.getContext(this.name);E?.route&&(E.attachRef?this.attach(E.attachRef,E.route):this.activateWith(E.route,E.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new F.vHH(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new F.vHH(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new F.vHH(4012,!1);this.location.detach();const E=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(E.instance),E}attach(E,R){this.activated=E,this._activatedRoute=R,this.location.insert(E.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(E.instance)}deactivate(){if(this.activated){const E=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(E)}}activateWith(E,R){if(this.isActivated)throw new F.vHH(4013,!1);this._activatedRoute=E;const H=this.location,ue=E.snapshot.component,Ve=this.parentContexts.getOrCreateContext(this.name).children,Me=new Ia(E,Ve,H.injector);this.activated=H.createComponent(ue,{index:H.length,injector:Me,environmentInjector:R??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return(_=S).\u0275fac=function(E){return new(E||_)},_.\u0275dir=F.lG2({type:_,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[F.TTD]}),S})();class Ia{constructor(S,C,E){this.route=S,this.childContexts=C,this.parent=E}get(S,C){return S===Dr?this.route:S===Oi?this.childContexts:this.parent.get(S,C)}}const wi=new F.OlP("");let ea=(()=>{var _;class S{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(E){this.unsubscribeFromRouteData(E),this.subscribeToRouteData(E)}unsubscribeFromRouteData(E){this.outletDataSubscriptions.get(E)?.unsubscribe(),this.outletDataSubscriptions.delete(E)}subscribeToRouteData(E){const{activatedRoute:R}=E,H=Dt([R.queryParams,R.params,R.data]).pipe((0,Jt.w)(([X,ue,Ve],Me)=>(Ve={...X,...ue,...Ve},0===Me?(0,Je.of)(Ve):Promise.resolve(Ve)))).subscribe(X=>{if(!E.isActivated||!E.activatedComponentRef||E.activatedRoute!==R||null===R.component)return void this.unsubscribeFromRouteData(E);const ue=(0,F.qFp)(R.component);if(ue)for(const{templateName:Ve}of ue.inputs)E.activatedComponentRef.setInput(Ve,X[Ve]);else this.unsubscribeFromRouteData(E)});this.outletDataSubscriptions.set(E,H)}}return(_=S).\u0275fac=function(E){return new(E||_)},_.\u0275prov=F.Yz7({token:_,factory:_.\u0275fac}),S})();function nr(_,S,C){if(C&&_.shouldReuseRoute(S.value,C.value.snapshot)){const E=C.value;E._futureSnapshot=S.value;const R=function Ra(_,S,C){return S.children.map(E=>{for(const R of C.children)if(_.shouldReuseRoute(E.value,R.value.snapshot))return nr(_,E,R);return nr(_,E)})}(_,S,C);return new os(E,R)}{if(_.shouldAttach(S.value)){const H=_.retrieve(S.value);if(null!==H){const X=H.route;return X.value._futureSnapshot=S.value,X.children=S.children.map(ue=>nr(_,ue)),X}}const E=function Ru(_){return new Dr(new Tt.X(_.url),new Tt.X(_.params),new Tt.X(_.queryParams),new Tt.X(_.fragment),new Tt.X(_.data),_.outlet,_.component,_)}(S.value),R=S.children.map(H=>nr(_,H));return new os(E,R)}}const gs="ngNavigationCancelingError";function kr(_,S){const{redirectTo:C,navigationBehaviorOptions:E}=Rn(S)?{redirectTo:S,navigationBehaviorOptions:void 0}:S,R=Ja(!1,0,S);return R.url=C,R.navigationBehaviorOptions=E,R}function Ja(_,S,C){const E=new Error("NavigationCancelingError: "+(_||""));return E[gs]=!0,E.cancellationCode=S,C&&(E.url=C),E}function Un(_){return _&&_[gs]}let Zd=(()=>{var _;class S{}return(_=S).\u0275fac=function(E){return new(E||_)},_.\u0275cmp=F.Xpm({type:_,selectors:[["ng-component"]],standalone:!0,features:[F.jDz],decls:1,vars:0,template:function(E,R){1&E&&F._UZ(0,"router-outlet")},dependencies:[Qo],encapsulation:2}),S})();function Pi(_){const S=_.children&&_.children.map(Pi),C=S?{..._,children:S}:{..._};return!C.component&&!C.loadComponent&&(S||C.loadChildren)&&C.outlet&&C.outlet!==on&&(C.component=Zd),C}function ci(_){return _.outlet||on}function Br(_){if(!_)return null;if(_.routeConfig?._injector)return _.routeConfig._injector;for(let S=_.parent;S;S=S.parent){const C=S.routeConfig;if(C?._loadedInjector)return C._loadedInjector;if(C?._injector)return C._injector}return null}class Vi{constructor(S,C,E,R,H){this.routeReuseStrategy=S,this.futureState=C,this.currState=E,this.forwardEvent=R,this.inputBindingEnabled=H}activate(S){const C=this.futureState._root,E=this.currState?this.currState._root:null;this.deactivateChildRoutes(C,E,S),hn(this.futureState.root),this.activateChildRoutes(C,E,S)}deactivateChildRoutes(S,C,E){const R=mi(C);S.children.forEach(H=>{const X=H.value.outlet;this.deactivateRoutes(H,R[X],E),delete R[X]}),Object.values(R).forEach(H=>{this.deactivateRouteAndItsChildren(H,E)})}deactivateRoutes(S,C,E){const R=S.value,H=C?C.value:null;if(R===H)if(R.component){const X=E.getContext(R.outlet);X&&this.deactivateChildRoutes(S,C,X.children)}else this.deactivateChildRoutes(S,C,E);else H&&this.deactivateRouteAndItsChildren(C,E)}deactivateRouteAndItsChildren(S,C){S.value.component&&this.routeReuseStrategy.shouldDetach(S.value.snapshot)?this.detachAndStoreRouteSubtree(S,C):this.deactivateRouteAndOutlet(S,C)}detachAndStoreRouteSubtree(S,C){const E=C.getContext(S.value.outlet),R=E&&S.value.component?E.children:C,H=mi(S);for(const X of Object.keys(H))this.deactivateRouteAndItsChildren(H[X],R);if(E&&E.outlet){const X=E.outlet.detach(),ue=E.children.onOutletDeactivated();this.routeReuseStrategy.store(S.value.snapshot,{componentRef:X,route:S,contexts:ue})}}deactivateRouteAndOutlet(S,C){const E=C.getContext(S.value.outlet),R=E&&S.value.component?E.children:C,H=mi(S);for(const X of Object.keys(H))this.deactivateRouteAndItsChildren(H[X],R);E&&(E.outlet&&(E.outlet.deactivate(),E.children.onOutletDeactivated()),E.attachRef=null,E.route=null)}activateChildRoutes(S,C,E){const R=mi(C);S.children.forEach(H=>{this.activateRoutes(H,R[H.value.outlet],E),this.forwardEvent(new kc(H.value.snapshot))}),S.children.length&&this.forwardEvent(new Uc(S.value.snapshot))}activateRoutes(S,C,E){const R=S.value,H=C?C.value:null;if(hn(R),R===H)if(R.component){const X=E.getOrCreateContext(R.outlet);this.activateChildRoutes(S,C,X.children)}else this.activateChildRoutes(S,C,E);else if(R.component){const X=E.getOrCreateContext(R.outlet);if(this.routeReuseStrategy.shouldAttach(R.snapshot)){const ue=this.routeReuseStrategy.retrieve(R.snapshot);this.routeReuseStrategy.store(R.snapshot,null),X.children.onOutletReAttached(ue.contexts),X.attachRef=ue.componentRef,X.route=ue.route.value,X.outlet&&X.outlet.attach(ue.componentRef,ue.route.value),hn(ue.route.value),this.activateChildRoutes(S,null,X.children)}else{const ue=Br(R.snapshot);X.attachRef=null,X.route=R,X.injector=ue,X.outlet&&X.outlet.activateWith(R,X.injector),this.activateChildRoutes(S,null,X.children)}}else this.activateChildRoutes(S,null,E)}}class Vc{constructor(S){this.path=S,this.route=this.path[this.path.length-1]}}class Rl{constructor(S,C){this.component=S,this.route=C}}function Kd(_,S,C){const E=_._root;return nc(E,S?S._root:null,C,[E.value])}function tc(_,S){const C=Symbol(),E=S.get(_,C);return E===C?"function"!=typeof _||(0,F.Z0I)(_)?S.get(_):_:E}function nc(_,S,C,E,R={canDeactivateChecks:[],canActivateChecks:[]}){const H=mi(S);return _.children.forEach(X=>{(function Hh(_,S,C,E,R={canDeactivateChecks:[],canActivateChecks:[]}){const H=_.value,X=S?S.value:null,ue=C?C.getContext(_.value.outlet):null;if(X&&H.routeConfig===X.routeConfig){const Ve=function Vh(_,S,C){if("function"==typeof C)return C(_,S);switch(C){case"pathParamsChange":return!Ee(_.url,S.url);case"pathParamsOrQueryParamsChange":return!Ee(_.url,S.url)||!er(_.queryParams,S.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Da(_,S)||!er(_.queryParams,S.queryParams);default:return!Da(_,S)}}(X,H,H.routeConfig.runGuardsAndResolvers);Ve?R.canActivateChecks.push(new Vc(E)):(H.data=X.data,H._resolvedData=X._resolvedData),nc(_,S,H.component?ue?ue.children:null:C,E,R),Ve&&ue&&ue.outlet&&ue.outlet.isActivated&&R.canDeactivateChecks.push(new Rl(ue.outlet.component,X))}else X&&zc(S,ue,R),R.canActivateChecks.push(new Vc(E)),nc(_,null,H.component?ue?ue.children:null:C,E,R)})(X,H[X.value.outlet],C,E.concat([X.value]),R),delete H[X.value.outlet]}),Object.entries(H).forEach(([X,ue])=>zc(ue,C.getContext(X),R)),R}function zc(_,S,C){const E=mi(_),R=_.value;Object.entries(E).forEach(([H,X])=>{zc(X,R.component?S?S.children.getContext(H):null:S,C)}),C.canDeactivateChecks.push(new Rl(R.component&&S&&S.outlet&&S.outlet.isActivated?S.outlet.component:null,R))}function Pa(_){return"function"==typeof _}function Hr(_){return _ instanceof ot||"EmptyError"===_?.name}const En=Symbol("INITIAL_VALUE");function ia(){return(0,Jt.w)(_=>Dt(_.map(S=>S.pipe(jn(1),function ki(..._){const S=(0,ni.yG)(_);return(0,ye.e)((C,E)=>{(S?vr(_,C,S):vr(_,C)).subscribe(E)})}(En)))).pipe((0,Ut.U)(S=>{for(const C of S)if(!0!==C){if(C===En)return En;if(!1===C||C instanceof lr)return C}return!0}),tn(S=>S!==En),jn(1)))}function To(_){return(0,hs.z)(fi(S=>{if(Rn(S))throw kr(0,S)}),(0,Ut.U)(S=>!0===S))}class qs{constructor(S){this.segmentGroup=S||null}}class jc{constructor(S){this.urlTree=S}}function Zs(_){return Kt(new qs(_))}function rc(_){return Kt(new jc(_))}class Fu{constructor(S,C){this.urlSerializer=S,this.urlTree=C}noMatchError(S){return new F.vHH(4002,!1)}lineralizeSegments(S,C){let E=[],R=C.root;for(;;){if(E=E.concat(R.segments),0===R.numberOfChildren)return(0,Je.of)(E);if(R.numberOfChildren>1||!R.children[on])return Kt(new F.vHH(4e3,!1));R=R.children[on]}}applyRedirectCommands(S,C,E){return this.applyRedirectCreateUrlTree(C,this.urlSerializer.parse(C),S,E)}applyRedirectCreateUrlTree(S,C,E,R){const H=this.createSegmentGroup(S,C.root,E,R);return new lr(H,this.createQueryParams(C.queryParams,this.urlTree.queryParams),C.fragment)}createQueryParams(S,C){const E={};return Object.entries(S).forEach(([R,H])=>{if("string"==typeof H&&H.startsWith(":")){const ue=H.substring(1);E[R]=C[ue]}else E[R]=H}),E}createSegmentGroup(S,C,E,R){const H=this.createSegments(S,C.segments,E,R);let X={};return Object.entries(C.children).forEach(([ue,Ve])=>{X[ue]=this.createSegmentGroup(S,Ve,E,R)}),new ii(H,X)}createSegments(S,C,E,R){return C.map(H=>H.path.startsWith(":")?this.findPosParam(S,H,R):this.findOrReturn(H,E))}findPosParam(S,C,E){const R=E[C.path.substring(1)];if(!R)throw new F.vHH(4001,!1);return R}findOrReturn(S,C){let E=0;for(const R of C){if(R.path===S.path)return C.splice(E),R;E++}return S}}const sr={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Rs(_,S,C,E,R){const H=Ks(_,S,C);return H.matched?(E=function Dl(_,S){return _.providers&&!_._injector&&(_._injector=(0,F.MMx)(_.providers,S,`Route: ${_.path}`)),_._injector??S}(S,E),function ra(_,S,C,E){const R=S.canMatch;if(!R||0===R.length)return(0,Je.of)(!0);const H=R.map(X=>{const ue=tc(X,_);return Zn(function ef(_){return _&&Pa(_.canMatch)}(ue)?ue.canMatch(S,C):_.runInContext(()=>ue(S,C)))});return(0,Je.of)(H).pipe(ia(),To())}(E,S,C).pipe((0,Ut.U)(X=>!0===X?H:{...sr}))):(0,Je.of)(H)}function Ks(_,S,C){if(""===S.path)return"full"===S.pathMatch&&(_.hasChildren()||C.length>0)?{...sr}:{matched:!0,consumedSegments:[],remainingSegments:C,parameters:{},positionalParamSegments:{}};const R=(S.matcher||go)(C,_,S);if(!R)return{...sr};const H={};Object.entries(R.posParams??{}).forEach(([ue,Ve])=>{H[ue]=Ve.path});const X=R.consumed.length>0?{...H,...R.consumed[R.consumed.length-1].parameters}:H;return{matched:!0,consumedSegments:R.consumed,remainingSegments:C.slice(R.consumed.length),parameters:X,positionalParamSegments:R.posParams??{}}}function Ol(_,S,C,E){return C.length>0&&function Fl(_,S,C){return C.some(E=>L(_,S,E)&&ci(E)!==on)}(_,C,E)?{segmentGroup:new ii(S,Js(E,new ii(C,_.children))),slicedSegments:[]}:0===C.length&&function b(_,S,C){return C.some(E=>L(_,S,E))}(_,C,E)?{segmentGroup:new ii(_.segments,sc(_,0,C,E,_.children)),slicedSegments:C}:{segmentGroup:new ii(_.segments,_.children),slicedSegments:C}}function sc(_,S,C,E,R){const H={};for(const X of E)if(L(_,C,X)&&!R[ci(X)]){const ue=new ii([],{});H[ci(X)]=ue}return{...R,...H}}function Js(_,S){const C={};C[on]=S;for(const E of _)if(""===E.path&&ci(E)!==on){const R=new ii([],{});C[ci(E)]=R}return C}function L(_,S,C){return(!(_.hasChildren()||S.length>0)||"full"!==C.pathMatch)&&""===C.path}class re{constructor(S,C,E,R,H,X,ue){this.injector=S,this.configLoader=C,this.rootComponentType=E,this.config=R,this.urlTree=H,this.paramsInheritanceStrategy=X,this.urlSerializer=ue,this.allowRedirects=!0,this.applyRedirects=new Fu(this.urlSerializer,this.urlTree)}noMatchError(S){return new F.vHH(4002,!1)}recognize(){const S=Ol(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,S,on).pipe(hi(C=>{if(C instanceof jc)return this.allowRedirects=!1,this.urlTree=C.urlTree,this.match(C.urlTree);throw C instanceof qs?this.noMatchError(C):C}),(0,Ut.U)(C=>{const E=new Xs([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},on,this.rootComponentType,null,{}),R=new os(E,C),H=new Hi("",R),X=function Ma(_,S,C=null,E=null){return $o(xa(_),S,C,E)}(E,[],this.urlTree.queryParams,this.urlTree.fragment);return X.queryParams=this.urlTree.queryParams,H.url=this.urlSerializer.serialize(X),this.inheritParamsAndData(H._root),{state:H,tree:X}}))}match(S){return this.processSegmentGroup(this.injector,this.config,S.root,on).pipe(hi(E=>{throw E instanceof qs?this.noMatchError(E):E}))}inheritParamsAndData(S){const C=S.value,E=Ka(C,this.paramsInheritanceStrategy);C.params=Object.freeze(E.params),C.data=Object.freeze(E.data),S.children.forEach(R=>this.inheritParamsAndData(R))}processSegmentGroup(S,C,E,R){return 0===E.segments.length&&E.hasChildren()?this.processChildren(S,C,E):this.processSegment(S,C,E,E.segments,R,!0)}processChildren(S,C,E){const R=[];for(const H of Object.keys(E.children))"primary"===H?R.unshift(H):R.push(H);return(0,je.D)(R).pipe(li(H=>{const X=E.children[H],ue=function wo(_,S){const C=_.filter(E=>ci(E)===S);return C.push(..._.filter(E=>ci(E)!==S)),C}(C,H);return this.processSegmentGroup(S,ue,X,H)}),function wl(_,S){return(0,ye.e)(function nn(_,S,C,E,R){return(H,X)=>{let ue=C,Ve=S,Me=0;H.subscribe((0,ke.x)(X,$t=>{const en=Me++;Ve=ue?_(Ve,$t,en):(ue=!0,$t),E&&X.next(Ve)},R&&(()=>{ue&&X.next(Ve),X.complete()})))}}(_,S,arguments.length>=2,!0))}((H,X)=>(H.push(...X),H)),Ai(null),function Tr(_,S){const C=arguments.length>=2;return E=>E.pipe(_?tn((R,H)=>_(R,H,E)):zt.y,_a(1),C?Ai(S):Ci(()=>new ot))}(),(0,Nn.z)(H=>{if(null===H)return Zs(E);const X=kn(H);return function Ce(_){_.sort((S,C)=>S.value.outlet===on?-1:C.value.outlet===on?1:S.value.outlet.localeCompare(C.value.outlet))}(X),(0,Je.of)(X)}))}processSegment(S,C,E,R,H,X){return(0,je.D)(C).pipe(li(ue=>this.processSegmentAgainstRoute(ue._injector??S,C,ue,E,R,H,X).pipe(hi(Ve=>{if(Ve instanceof qs)return(0,Je.of)(null);throw Ve}))),Qi(ue=>!!ue),hi(ue=>{if(Hr(ue))return function P(_,S,C){return 0===S.length&&!_.children[C]}(E,R,H)?(0,Je.of)([]):Zs(E);throw ue}))}processSegmentAgainstRoute(S,C,E,R,H,X,ue){return function K(_,S,C,E){return!!(ci(_)===E||E!==on&&L(S,C,_))&&("**"===_.path||Ks(S,_,C).matched)}(E,R,H,X)?void 0===E.redirectTo?this.matchSegmentAgainstRoute(S,R,E,H,X,ue):ue&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(S,R,C,E,H,X):Zs(R):Zs(R)}expandSegmentAgainstRouteUsingRedirect(S,C,E,R,H,X){return"**"===R.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(S,E,R,X):this.expandRegularSegmentAgainstRouteUsingRedirect(S,C,E,R,H,X)}expandWildCardWithParamsAgainstRouteUsingRedirect(S,C,E,R){const H=this.applyRedirects.applyRedirectCommands([],E.redirectTo,{});return E.redirectTo.startsWith("/")?rc(H):this.applyRedirects.lineralizeSegments(E,H).pipe((0,Nn.z)(X=>{const ue=new ii(X,{});return this.processSegment(S,C,ue,X,R,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(S,C,E,R,H,X){const{matched:ue,consumedSegments:Ve,remainingSegments:Me,positionalParamSegments:$t}=Ks(C,R,H);if(!ue)return Zs(C);const en=this.applyRedirects.applyRedirectCommands(Ve,R.redirectTo,$t);return R.redirectTo.startsWith("/")?rc(en):this.applyRedirects.lineralizeSegments(R,en).pipe((0,Nn.z)(Ti=>this.processSegment(S,E,C,Ti.concat(Me),X,!1)))}matchSegmentAgainstRoute(S,C,E,R,H,X){let ue;if("**"===E.path){const Ve=R.length>0?Ts(R).parameters:{},Me=new Xs(R,Ve,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,$(E),ci(E),E.component??E._loadedComponent??null,E,Sn(E));ue=(0,Je.of)({snapshot:Me,consumedSegments:[],remainingSegments:[]}),C.children={}}else ue=Rs(C,E,R,S).pipe((0,Ut.U)(({matched:Ve,consumedSegments:Me,remainingSegments:$t,parameters:en})=>Ve?{snapshot:new Xs(Me,en,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,$(E),ci(E),E.component??E._loadedComponent??null,E,Sn(E)),consumedSegments:Me,remainingSegments:$t}:null));return ue.pipe((0,Jt.w)(Ve=>null===Ve?Zs(C):this.getChildConfig(S=E._injector??S,E,R).pipe((0,Jt.w)(({routes:Me})=>{const $t=E._loadedInjector??S,{snapshot:en,consumedSegments:Ti,remainingSegments:cn}=Ve,{segmentGroup:Ot,slicedSegments:Vl}=Ol(C,Ti,cn,Me);if(0===Vl.length&&Ot.hasChildren())return this.processChildren($t,Me,Ot).pipe((0,Ut.U)(Mr=>null===Mr?null:[new os(en,Mr)]));if(0===Me.length&&0===Vl.length)return(0,Je.of)([new os(en,[])]);const zl=ci(E)===H;return this.processSegment($t,Me,Ot,Vl,zl?on:H,!0).pipe((0,Ut.U)(Mr=>[new os(en,Mr)]))}))))}getChildConfig(S,C,E){return C.children?(0,Je.of)({routes:C.children,injector:S}):C.loadChildren?void 0!==C._loadedRoutes?(0,Je.of)({routes:C._loadedRoutes,injector:C._loadedInjector}):function Nl(_,S,C,E){const R=S.canLoad;if(void 0===R||0===R.length)return(0,Je.of)(!0);const H=R.map(X=>{const ue=tc(X,_);return Zn(function Qd(_){return _&&Pa(_.canLoad)}(ue)?ue.canLoad(S,C):_.runInContext(()=>ue(S,C)))});return(0,Je.of)(H).pipe(ia(),To())}(S,C,E).pipe((0,Nn.z)(R=>R?this.configLoader.loadChildren(S,C).pipe(fi(H=>{C._loadedRoutes=H.routes,C._loadedInjector=H.injector})):function Ou(_){return Kt(Ja(!1,3))}())):(0,Je.of)({routes:[],injector:S})}}function ht(_){const S=_.value.routeConfig;return S&&""===S.path}function kn(_){const S=[],C=new Set;for(const E of _){if(!ht(E)){S.push(E);continue}const R=S.find(H=>E.value.routeConfig===H.value.routeConfig);void 0!==R?(R.children.push(...E.children),C.add(R)):S.push(E)}for(const E of C){const R=kn(E.children);S.push(new os(E.value,R))}return S.filter(E=>!C.has(E))}function $(_){return _.data||{}}function Sn(_){return _.resolve||{}}function or(_){return"string"==typeof _.title||null===_.title}function Vr(_){return(0,Jt.w)(S=>{const C=_(S);return C?(0,je.D)(C).pipe((0,Ut.U)(()=>S)):(0,Je.of)(S)})}const Wi=new F.OlP("ROUTES");let ar=(()=>{var _;class S{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,F.f3M)(F.Sil)}loadComponent(E){if(this.componentLoaders.get(E))return this.componentLoaders.get(E);if(E._loadedComponent)return(0,Je.of)(E._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(E);const R=Zn(E.loadComponent()).pipe((0,Ut.U)(oc),fi(X=>{this.onLoadEndListener&&this.onLoadEndListener(E),E._loadedComponent=X}),Xr(()=>{this.componentLoaders.delete(E)})),H=new Le(R,()=>new $e.x).pipe(Ne());return this.componentLoaders.set(E,H),H}loadChildren(E,R){if(this.childrenLoaders.get(R))return this.childrenLoaders.get(R);if(R._loadedRoutes)return(0,Je.of)({routes:R._loadedRoutes,injector:R._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(R);const X=this.loadModuleFactoryOrRoutes(R.loadChildren).pipe((0,Ut.U)(Ve=>{this.onLoadEndListener&&this.onLoadEndListener(R);let Me,$t;return Array.isArray(Ve)?$t=Ve:(Me=Ve.create(E).injector,$t=Me.get(Wi,[],F.XFs.Self|F.XFs.Optional).flat()),{routes:$t.map(Pi),injector:Me}}),Xr(()=>{this.childrenLoaders.delete(R)})),ue=new Le(X,()=>new $e.x).pipe(Ne());return this.childrenLoaders.set(R,ue),ue}loadModuleFactoryOrRoutes(E){return Zn(E()).pipe((0,Ut.U)(oc),(0,Nn.z)(R=>R instanceof F.YKP||Array.isArray(R)?(0,Je.of)(R):(0,je.D)(this.compiler.compileModuleAsync(R))))}}return(_=S).\u0275fac=function(E){return new(E||_)},_.\u0275prov=F.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),S})();function oc(_){return function sa(_){return _&&"object"==typeof _&&"default"in _}(_)?_.default:_}let Na=(()=>{var _;class S{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new $e.x,this.transitionAbortSubject=new $e.x,this.configLoader=(0,F.f3M)(ar),this.environmentInjector=(0,F.f3M)(F.lqb),this.urlSerializer=(0,F.f3M)(_e),this.rootContexts=(0,F.f3M)(Oi),this.inputBindingEnabled=null!==(0,F.f3M)(wi,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,Je.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=H=>this.events.next(new Za(H)),this.configLoader.onLoadStartListener=H=>this.events.next(new Iu(H))}complete(){this.transitions?.complete()}handleNavigationRequest(E){const R=++this.navigationId;this.transitions?.next({...this.transitions.value,...E,id:R})}setupNavigations(E,R,H){return this.transitions=new Tt.X({id:0,currentUrlTree:R,currentRawUrl:R,currentBrowserUrl:R,extractedUrl:E.urlHandlingStrategy.extract(R),urlAfterRedirects:E.urlHandlingStrategy.extract(R),rawUrl:R,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:xo,restoredState:null,currentSnapshot:H.snapshot,targetSnapshot:null,currentRouterState:H,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(tn(X=>0!==X.id),(0,Ut.U)(X=>({...X,extractedUrl:E.urlHandlingStrategy.extract(X.rawUrl)})),(0,Jt.w)(X=>{this.currentTransition=X;let ue=!1,Ve=!1;return(0,Je.of)(X).pipe(fi(Me=>{this.currentNavigation={id:Me.id,initialUrl:Me.rawUrl,extractedUrl:Me.extractedUrl,trigger:Me.source,extras:Me.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,Jt.w)(Me=>{const $t=Me.currentBrowserUrl.toString(),en=!E.navigated||Me.extractedUrl.toString()!==$t||$t!==Me.currentUrlTree.toString();if(!en&&"reload"!==(Me.extras.onSameUrlNavigation??E.onSameUrlNavigation)){const cn="";return this.events.next(new qr(Me.id,this.urlSerializer.serialize(Me.rawUrl),cn,0)),Me.resolve(null),In.E}if(E.urlHandlingStrategy.shouldProcessUrl(Me.rawUrl))return(0,Je.of)(Me).pipe((0,Jt.w)(cn=>{const Ot=this.transitions?.getValue();return this.events.next(new qa(cn.id,this.urlSerializer.serialize(cn.extractedUrl),cn.source,cn.restoredState)),Ot!==this.transitions?.getValue()?In.E:Promise.resolve(cn)}),function Fi(_,S,C,E,R,H){return(0,Nn.z)(X=>function G(_,S,C,E,R,H,X="emptyOnly"){return new re(_,S,C,E,R,X,H).recognize()}(_,S,C,E,X.extractedUrl,R,H).pipe((0,Ut.U)(({state:ue,tree:Ve})=>({...X,targetSnapshot:ue,urlAfterRedirects:Ve}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,E.config,this.urlSerializer,E.paramsInheritanceStrategy),fi(cn=>{X.targetSnapshot=cn.targetSnapshot,X.urlAfterRedirects=cn.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:cn.urlAfterRedirects};const Ot=new Eo(cn.id,this.urlSerializer.serialize(cn.extractedUrl),this.urlSerializer.serialize(cn.urlAfterRedirects),cn.targetSnapshot);this.events.next(Ot)}));if(en&&E.urlHandlingStrategy.shouldProcessUrl(Me.currentRawUrl)){const{id:cn,extractedUrl:Ot,source:Vl,restoredState:zl,extras:Mr}=Me,Gl=new qa(cn,this.urlSerializer.serialize(Ot),Vl,zl);this.events.next(Gl);const Fa=xn(0,this.rootComponentType).snapshot;return this.currentTransition=X={...Me,targetSnapshot:Fa,urlAfterRedirects:Ot,extras:{...Mr,skipLocationChange:!1,replaceUrl:!1}},(0,Je.of)(X)}{const cn="";return this.events.next(new qr(Me.id,this.urlSerializer.serialize(Me.extractedUrl),cn,1)),Me.resolve(null),In.E}}),fi(Me=>{const $t=new Jo(Me.id,this.urlSerializer.serialize(Me.extractedUrl),this.urlSerializer.serialize(Me.urlAfterRedirects),Me.targetSnapshot);this.events.next($t)}),(0,Ut.U)(Me=>(this.currentTransition=X={...Me,guards:Kd(Me.targetSnapshot,Me.currentSnapshot,this.rootContexts)},X)),function Re(_,S){return(0,Nn.z)(C=>{const{targetSnapshot:E,currentSnapshot:R,guards:{canActivateChecks:H,canDeactivateChecks:X}}=C;return 0===X.length&&0===H.length?(0,Je.of)({...C,guardsResult:!0}):function gn(_,S,C,E){return(0,je.D)(_).pipe((0,Nn.z)(R=>function Wc(_,S,C,E,R){const H=S&&S.routeConfig?S.routeConfig.canDeactivate:null;if(!H||0===H.length)return(0,Je.of)(!0);const X=H.map(ue=>{const Ve=Br(S)??R,Me=tc(ue,Ve);return Zn(function Pu(_){return _&&Pa(_.canDeactivate)}(Me)?Me.canDeactivate(_,S,C,E):Ve.runInContext(()=>Me(_,S,C,E))).pipe(Qi())});return(0,Je.of)(X).pipe(ia())}(R.component,R.route,C,S,E)),Qi(R=>!0!==R,!0))}(X,E,R,_).pipe((0,Nn.z)(ue=>ue&&function Jd(_){return"boolean"==typeof _}(ue)?function Lu(_,S,C,E){return(0,je.D)(S).pipe(li(R=>vr(function dr(_,S){return null!==_&&S&&S(new Fc(_)),(0,Je.of)(!0)}(R.route.parent,E),function Ll(_,S){return null!==_&&S&&S(new $s(_)),(0,Je.of)(!0)}(R.route,E),function _r(_,S,C){const E=S[S.length-1],H=S.slice(0,S.length-1).reverse().map(X=>function ec(_){const S=_.routeConfig?_.routeConfig.canActivateChild:null;return S&&0!==S.length?{node:_,guards:S}:null}(X)).filter(X=>null!==X).map(X=>Nt(()=>{const ue=X.guards.map(Ve=>{const Me=Br(X.node)??C,$t=tc(Ve,Me);return Zn(function ic(_){return _&&Pa(_.canActivateChild)}($t)?$t.canActivateChild(E,_):Me.runInContext(()=>$t(E,_))).pipe(Qi())});return(0,Je.of)(ue).pipe(ia())}));return(0,Je.of)(H).pipe(ia())}(_,R.path,C),function Ys(_,S,C){const E=S.routeConfig?S.routeConfig.canActivate:null;if(!E||0===E.length)return(0,Je.of)(!0);const R=E.map(H=>Nt(()=>{const X=Br(S)??C,ue=tc(H,X);return Zn(function Pl(_){return _&&Pa(_.canActivate)}(ue)?ue.canActivate(S,_):X.runInContext(()=>ue(S,_))).pipe(Qi())}));return(0,Je.of)(R).pipe(ia())}(_,R.route,C))),Qi(R=>!0!==R,!0))}(E,H,_,S):(0,Je.of)(ue)),(0,Ut.U)(ue=>({...C,guardsResult:ue})))})}(this.environmentInjector,Me=>this.events.next(Me)),fi(Me=>{if(X.guardsResult=Me.guardsResult,Rn(Me.guardsResult))throw kr(0,Me.guardsResult);const $t=new wa(Me.id,this.urlSerializer.serialize(Me.extractedUrl),this.urlSerializer.serialize(Me.urlAfterRedirects),Me.targetSnapshot,!!Me.guardsResult);this.events.next($t)}),tn(Me=>!!Me.guardsResult||(this.cancelNavigationTransition(Me,"",3),!1)),Vr(Me=>{if(Me.guards.canActivateChecks.length)return(0,Je.of)(Me).pipe(fi($t=>{const en=new Oc($t.id,this.urlSerializer.serialize($t.extractedUrl),this.urlSerializer.serialize($t.urlAfterRedirects),$t.targetSnapshot);this.events.next(en)}),(0,Jt.w)($t=>{let en=!1;return(0,Je.of)($t).pipe(function Xn(_,S){return(0,Nn.z)(C=>{const{targetSnapshot:E,guards:{canActivateChecks:R}}=C;if(!R.length)return(0,Je.of)(C);let H=0;return(0,je.D)(R).pipe(li(X=>function gi(_,S,C,E){const R=_.routeConfig,H=_._resolve;return void 0!==R?.title&&!or(R)&&(H[Bi]=R.title),function fr(_,S,C,E){const R=function Pr(_){return[...Object.keys(_),...Object.getOwnPropertySymbols(_)]}(_);if(0===R.length)return(0,Je.of)({});const H={};return(0,je.D)(R).pipe((0,Nn.z)(X=>function Zr(_,S,C,E){const R=Br(S)??E,H=tc(_,R);return Zn(H.resolve?H.resolve(S,C):R.runInContext(()=>H(S,C)))}(_[X],S,C,E).pipe(Qi(),fi(ue=>{H[X]=ue}))),_a(1),function oi(_){return(0,Ut.U)(()=>_)}(H),hi(X=>Hr(X)?In.E:Kt(X)))}(H,_,S,E).pipe((0,Ut.U)(X=>(_._resolvedData=X,_.data=Ka(_,C).resolve,R&&or(R)&&(_.data[Bi]=R.title),null)))}(X.route,E,_,S)),fi(()=>H++),_a(1),(0,Nn.z)(X=>H===R.length?(0,Je.of)(C):In.E))})}(E.paramsInheritanceStrategy,this.environmentInjector),fi({next:()=>en=!0,complete:()=>{en||this.cancelNavigationTransition($t,"",2)}}))}),fi($t=>{const en=new Cl($t.id,this.urlSerializer.serialize($t.extractedUrl),this.urlSerializer.serialize($t.urlAfterRedirects),$t.targetSnapshot);this.events.next(en)}))}),Vr(Me=>{const $t=en=>{const Ti=[];en.routeConfig?.loadComponent&&!en.routeConfig._loadedComponent&&Ti.push(this.configLoader.loadComponent(en.routeConfig).pipe(fi(cn=>{en.component=cn}),(0,Ut.U)(()=>{})));for(const cn of en.children)Ti.push(...$t(cn));return Ti};return Dt($t(Me.targetSnapshot.root)).pipe(Ai(),jn(1))}),Vr(()=>this.afterPreactivation()),(0,Ut.U)(Me=>{const $t=function ta(_,S,C){const E=nr(_,S._root,C?C._root:void 0);return new At(E,S)}(E.routeReuseStrategy,Me.targetSnapshot,Me.currentRouterState);return this.currentTransition=X={...Me,targetRouterState:$t},X}),fi(()=>{this.events.next(new xi)}),((_,S,C,E)=>(0,Ut.U)(R=>(new Vi(S,R.targetRouterState,R.currentRouterState,C,E).activate(_),R)))(this.rootContexts,E.routeReuseStrategy,Me=>this.events.next(Me),this.inputBindingEnabled),jn(1),fi({next:Me=>{ue=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new js(Me.id,this.urlSerializer.serialize(Me.extractedUrl),this.urlSerializer.serialize(Me.urlAfterRedirects))),E.titleStrategy?.updateTitle(Me.targetRouterState.snapshot),Me.resolve(!0)},complete:()=>{ue=!0}}),function Fn(_){return(0,ye.e)((S,C)=>{(0,fs.Xf)(_).subscribe((0,ke.x)(C,()=>C.complete(),zn.Z)),!C.closed&&S.subscribe(C)})}(this.transitionAbortSubject.pipe(fi(Me=>{throw Me}))),Xr(()=>{ue||Ve||this.cancelNavigationTransition(X,"",1),this.currentNavigation?.id===X.id&&(this.currentNavigation=null)}),hi(Me=>{if(Ve=!0,Un(Me))this.events.next(new Ds(X.id,this.urlSerializer.serialize(X.extractedUrl),Me.message,Me.cancellationCode)),function Hc(_){return Un(_)&&Rn(_.url)}(Me)?this.events.next(new tr(Me.url)):X.resolve(!1);else{this.events.next(new Ko(X.id,this.urlSerializer.serialize(X.extractedUrl),Me,X.targetSnapshot??void 0));try{X.resolve(E.errorHandler(Me))}catch($t){X.reject($t)}}return In.E}))}))}cancelNavigationTransition(E,R,H){const X=new Ds(E.id,this.urlSerializer.serialize(E.extractedUrl),R,H);this.events.next(X),E.resolve(!1)}}return(_=S).\u0275fac=function(E){return new(E||_)},_.\u0275prov=F.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),S})();function ac(_){return _!==xo}let Ao=(()=>{var _;class S{buildTitle(E){let R,H=E.root;for(;void 0!==H;)R=this.getResolvedTitleForRoute(H)??R,H=H.children.find(X=>X.outlet===on);return R}getResolvedTitleForRoute(E){return E.data[Bi]}}return(_=S).\u0275fac=function(E){return new(E||_)},_.\u0275prov=F.Yz7({token:_,factory:function(){return(0,F.f3M)(Uu)},providedIn:"root"}),S})(),Uu=(()=>{var _;class S extends Ao{constructor(E){super(),this.title=E}updateTitle(E){const R=this.buildTitle(E);void 0!==R&&this.title.setTitle(R)}}return(_=S).\u0275fac=function(E){return new(E||_)(F.LFG($a.Dx))},_.\u0275prov=F.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),S})(),ku=(()=>{var _;class S{}return(_=S).\u0275fac=function(E){return new(E||_)},_.\u0275prov=F.Yz7({token:_,factory:function(){return(0,F.f3M)(vs)},providedIn:"root"}),S})();class $c{shouldDetach(S){return!1}store(S,C){}shouldAttach(S){return!1}retrieve(S){return null}shouldReuseRoute(S,C){return S.routeConfig===C.routeConfig}}let vs=(()=>{var _;class S extends $c{}return(_=S).\u0275fac=function(){let C;return function(R){return(C||(C=F.n5z(_)))(R||_)}}(),_.\u0275prov=F.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),S})();const zr=new F.OlP("",{providedIn:"root",factory:()=>({})});let Qs=(()=>{var _;class S{}return(_=S).\u0275fac=function(E){return new(E||_)},_.\u0275prov=F.Yz7({token:_,factory:function(){return(0,F.f3M)(vi)},providedIn:"root"}),S})(),vi=(()=>{var _;class S{shouldProcessUrl(E){return!0}extract(E){return E}merge(E,R){return E}}return(_=S).\u0275fac=function(E){return new(E||_)},_.\u0275prov=F.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),S})();var eo=function(_){return _[_.COMPLETE=0]="COMPLETE",_[_.FAILED=1]="FAILED",_[_.REDIRECTING=2]="REDIRECTING",_}(eo||{});function ys(_,S){_.events.pipe(tn(C=>C instanceof js||C instanceof Ds||C instanceof Ko||C instanceof qr),(0,Ut.U)(C=>C instanceof js||C instanceof qr?eo.COMPLETE:C instanceof Ds&&(0===C.code||1===C.code)?eo.REDIRECTING:eo.FAILED),tn(C=>C!==eo.REDIRECTING),jn(1)).subscribe(()=>{S()})}function Lr(_){throw _}function Ul(_,S,C){return S.parse("/")}const kl={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Ps={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ht=(()=>{var _;class S{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,F.f3M)(F.c2e),this.isNgZoneEnabled=!1,this._events=new $e.x,this.options=(0,F.f3M)(zr,{optional:!0})||{},this.pendingTasks=(0,F.f3M)(F.HDt),this.errorHandler=this.options.errorHandler||Lr,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Ul,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,F.f3M)(Qs),this.routeReuseStrategy=(0,F.f3M)(ku),this.titleStrategy=(0,F.f3M)(Ao),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=(0,F.f3M)(Wi,{optional:!0})?.flat()??[],this.navigationTransitions=(0,F.f3M)(Na),this.urlSerializer=(0,F.f3M)(_e),this.location=(0,F.f3M)(nt.Ye),this.componentInputBindingEnabled=!!(0,F.f3M)(wi,{optional:!0}),this.eventsSubscription=new be.w0,this.isNgZoneEnabled=(0,F.f3M)(F.R0b)instanceof F.R0b&&F.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new lr,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=xn(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(E=>{this.lastSuccessfulId=E.id,this.currentPageId=this.browserPageId},E=>{this.console.warn(`Unhandled Navigation Error: ${E}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const E=this.navigationTransitions.events.subscribe(R=>{try{const{currentTransition:H}=this.navigationTransitions;if(null===H)return void(_s(R)&&this._events.next(R));if(R instanceof qa)ac(H.source)&&(this.browserUrlTree=H.extractedUrl);else if(R instanceof qr)this.rawUrlTree=H.rawUrl;else if(R instanceof Eo){if("eager"===this.urlUpdateStrategy){if(!H.extras.skipLocationChange){const X=this.urlHandlingStrategy.merge(H.urlAfterRedirects,H.rawUrl);this.setBrowserUrl(X,H)}this.browserUrlTree=H.urlAfterRedirects}}else if(R instanceof xi)this.currentUrlTree=H.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(H.urlAfterRedirects,H.rawUrl),this.routerState=H.targetRouterState,"deferred"===this.urlUpdateStrategy&&(H.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,H),this.browserUrlTree=H.urlAfterRedirects);else if(R instanceof Ds)0!==R.code&&1!==R.code&&(this.navigated=!0),(3===R.code||2===R.code)&&this.restoreHistory(H);else if(R instanceof tr){const X=this.urlHandlingStrategy.merge(R.url,H.currentRawUrl),ue={skipLocationChange:H.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||ac(H.source)};this.scheduleNavigation(X,xo,null,ue,{resolve:H.resolve,reject:H.reject,promise:H.promise})}R instanceof Ko&&this.restoreHistory(H,!0),R instanceof js&&(this.navigated=!0),_s(R)&&this._events.next(R)}catch(H){this.navigationTransitions.transitionAbortSubject.next(H)}});this.eventsSubscription.add(E)}resetRootComponentType(E){this.routerState.root.component=E,this.navigationTransitions.rootComponentType=E}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const E=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),xo,E)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(E=>{const R="popstate"===E.type?"popstate":"hashchange";"popstate"===R&&setTimeout(()=>{this.navigateToSyncWithBrowser(E.url,R,E.state)},0)}))}navigateToSyncWithBrowser(E,R,H){const X={replaceUrl:!0},ue=H?.navigationId?H:null;if(H){const Me={...H};delete Me.navigationId,delete Me.\u0275routerPageId,0!==Object.keys(Me).length&&(X.state=Me)}const Ve=this.parseUrl(E);this.scheduleNavigation(Ve,R,ue,X)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(E){this.config=E.map(Pi),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(E,R={}){const{relativeTo:H,queryParams:X,fragment:ue,queryParamsHandling:Ve,preserveFragment:Me}=R,$t=Me?this.currentUrlTree.fragment:ue;let Ti,en=null;switch(Ve){case"merge":en={...this.currentUrlTree.queryParams,...X};break;case"preserve":en=this.currentUrlTree.queryParams;break;default:en=X||null}null!==en&&(en=this.removeEmptyProps(en));try{Ti=xa(H?H.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof E[0]||!E[0].startsWith("/"))&&(E=[]),Ti=this.currentUrlTree.root}return $o(Ti,E,en,$t??null)}navigateByUrl(E,R={skipLocationChange:!1}){const H=Rn(E)?E:this.parseUrl(E),X=this.urlHandlingStrategy.merge(H,this.rawUrlTree);return this.scheduleNavigation(X,xo,null,R)}navigate(E,R={skipLocationChange:!1}){return function cc(_){for(let S=0;S<_.length;S++)if(null==_[S])throw new F.vHH(4008,!1)}(E),this.navigateByUrl(this.createUrlTree(E,R),R)}serializeUrl(E){return this.urlSerializer.serialize(E)}parseUrl(E){let R;try{R=this.urlSerializer.parse(E)}catch(H){R=this.malformedUriErrorHandler(H,this.urlSerializer,E)}return R}isActive(E,R){let H;if(H=!0===R?{...kl}:!1===R?{...Ps}:R,Rn(E))return vo(this.currentUrlTree,E,H);const X=this.parseUrl(E);return vo(this.currentUrlTree,X,H)}removeEmptyProps(E){return Object.keys(E).reduce((R,H)=>{const X=E[H];return null!=X&&(R[H]=X),R},{})}scheduleNavigation(E,R,H,X,ue){if(this.disposed)return Promise.resolve(!1);let Ve,Me,$t;ue?(Ve=ue.resolve,Me=ue.reject,$t=ue.promise):$t=new Promise((Ti,cn)=>{Ve=Ti,Me=cn});const en=this.pendingTasks.add();return ys(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(en))}),this.navigationTransitions.handleNavigationRequest({source:R,restoredState:H,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:E,extras:X,resolve:Ve,reject:Me,promise:$t,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),$t.catch(Ti=>Promise.reject(Ti))}setBrowserUrl(E,R){const H=this.urlSerializer.serialize(E);if(this.location.isCurrentPathEqualTo(H)||R.extras.replaceUrl){const ue={...R.extras.state,...this.generateNgRouterState(R.id,this.browserPageId)};this.location.replaceState(H,"",ue)}else{const X={...R.extras.state,...this.generateNgRouterState(R.id,this.browserPageId+1)};this.location.go(H,"",X)}}restoreHistory(E,R=!1){if("computed"===this.canceledNavigationResolution){const X=this.currentPageId-this.browserPageId;0!==X?this.location.historyGo(X):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===X&&(this.resetState(E),this.browserUrlTree=E.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(R&&this.resetState(E),this.resetUrlToCurrentUrlTree())}resetState(E){this.routerState=E.currentRouterState,this.currentUrlTree=E.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,E.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(E,R){return"computed"===this.canceledNavigationResolution?{navigationId:E,\u0275routerPageId:R}:{navigationId:E}}}return(_=S).\u0275fac=function(E){return new(E||_)},_.\u0275prov=F.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),S})();function _s(_){return!(_ instanceof xi||_ instanceof tr)}class Xc{}let Hu=(()=>{var _;class S{constructor(E,R,H,X,ue){this.router=E,this.injector=H,this.preloadingStrategy=X,this.loader=ue}setUpPreloading(){this.subscription=this.router.events.pipe(tn(E=>E instanceof js),li(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(E,R){const H=[];for(const X of R){X.providers&&!X._injector&&(X._injector=(0,F.MMx)(X.providers,E,`Route: ${X.path}`));const ue=X._injector??E,Ve=X._loadedInjector??ue;(X.loadChildren&&!X._loadedRoutes&&void 0===X.canLoad||X.loadComponent&&!X._loadedComponent)&&H.push(this.preloadConfig(ue,X)),(X.children||X._loadedRoutes)&&H.push(this.processRoutes(Ve,X.children??X._loadedRoutes))}return(0,je.D)(H).pipe((0,Zt.J)())}preloadConfig(E,R){return this.preloadingStrategy.preload(R,()=>{let H;H=R.loadChildren&&void 0===R.canLoad?this.loader.loadChildren(E,R):(0,Je.of)(null);const X=H.pipe((0,Nn.z)(ue=>null===ue?(0,Je.of)(void 0):(R._loadedRoutes=ue.routes,R._loadedInjector=ue.injector,this.processRoutes(ue.injector??E,ue.routes))));if(R.loadComponent&&!R._loadedComponent){const ue=this.loader.loadComponent(R);return(0,je.D)([X,ue]).pipe((0,Zt.J)())}return X})}}return(_=S).\u0275fac=function(E){return new(E||_)(F.LFG(Ht),F.LFG(F.Sil),F.LFG(F.lqb),F.LFG(Xc),F.LFG(ar))},_.\u0275prov=F.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),S})();const Vu=new F.OlP("");let an=(()=>{var _;class S{constructor(E,R,H,X,ue={}){this.urlSerializer=E,this.transitions=R,this.viewportScroller=H,this.zone=X,this.options=ue,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},ue.scrollPositionRestoration=ue.scrollPositionRestoration||"disabled",ue.anchorScrolling=ue.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(E=>{E instanceof qa?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=E.navigationTrigger,this.restoredId=E.restoredState?E.restoredState.navigationId:0):E instanceof js?(this.lastId=E.id,this.scheduleScrollEvent(E,this.urlSerializer.parse(E.urlAfterRedirects).fragment)):E instanceof qr&&0===E.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(E,this.urlSerializer.parse(E.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(E=>{E instanceof $n&&(E.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(E.position):E.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(E.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(E,R){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new $n(E,"popstate"===this.lastSource?this.store[this.restoredId]:null,R))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return(_=S).\u0275fac=function(E){F.$Z()},_.\u0275prov=F.Yz7({token:_,factory:_.\u0275fac}),S})();function Kr(_,S){return{\u0275kind:_,\u0275providers:S}}function rf(){const _=(0,F.f3M)(F.zs3);return S=>{const C=_.get(F.z2F);if(S!==C.components[0])return;const E=_.get(Ht),R=_.get(Gu);1===_.get(Bl)&&E.initialNavigation(),_.get(sn,null,F.XFs.Optional)?.setUpPreloading(),_.get(Vu,null,F.XFs.Optional)?.init(),E.resetRootComponentType(C.componentTypes[0]),R.closed||(R.next(),R.complete(),R.unsubscribe())}}const Gu=new F.OlP("",{factory:()=>new $e.x}),Bl=new F.OlP("",{providedIn:"root",factory:()=>1}),sn=new F.OlP("");function Ls(_){return Kr(0,[{provide:sn,useExisting:Hu},{provide:Xc,useExisting:_}])}const Zc=new F.OlP("ROUTER_FORROOT_GUARD"),Kc=[nt.Ye,{provide:_e,useClass:it},Ht,Oi,{provide:Dr,useFactory:function nf(_){return _.routerState.root},deps:[Ht]},ar,[]];function Wu(){return new F.PXZ("Router",Ht)}let af=(()=>{var _;class S{constructor(E){}static forRoot(E,R){return{ngModule:S,providers:[Kc,[],{provide:Wi,multi:!0,useValue:E},{provide:Zc,useFactory:Ms,deps:[[Ht,new F.FiY,new F.tp0]]},{provide:zr,useValue:R||{}},R?.useHash?{provide:nt.S$,useClass:nt.Do}:{provide:nt.S$,useClass:nt.b0},{provide:Vu,useFactory:()=>{const _=(0,F.f3M)(nt.EM),S=(0,F.f3M)(F.R0b),C=(0,F.f3M)(zr),E=(0,F.f3M)(Na),R=(0,F.f3M)(_e);return C.scrollOffset&&_.setOffset(C.scrollOffset),new an(R,E,_,S,C)}},R?.preloadingStrategy?Ls(R.preloadingStrategy).\u0275providers:[],{provide:F.PXZ,multi:!0,useFactory:Wu},R?.initialNavigation?Oa(R):[],R?.bindToComponentInputs?Kr(8,[ea,{provide:wi,useExisting:ea}]).\u0275providers:[],[{provide:Xi,useFactory:rf},{provide:F.tb,multi:!0,useExisting:Xi}]]}}static forChild(E){return{ngModule:S,providers:[{provide:Wi,multi:!0,useValue:E}]}}}return(_=S).\u0275fac=function(E){return new(E||_)(F.LFG(Zc,8))},_.\u0275mod=F.oAB({type:_}),_.\u0275inj=F.cJS({}),S})();function Ms(_){return"guarded"}function Oa(_){return["disabled"===_.initialNavigation?Kr(3,[{provide:F.ip1,multi:!0,useFactory:()=>{const S=(0,F.f3M)(Ht);return()=>{S.setUpLocationChangeListener()}}},{provide:Bl,useValue:2}]).\u0275providers:[],"enabledBlocking"===_.initialNavigation?Kr(2,[{provide:Bl,useValue:0},{provide:F.ip1,multi:!0,deps:[F.zs3],useFactory:S=>{const C=S.get(nt.V_,Promise.resolve());return()=>C.then(()=>new Promise(E=>{const R=S.get(Ht),H=S.get(Gu);ys(R,()=>{E(!0)}),S.get(Na).afterPreactivation=()=>(E(!0),H.closed?(0,Je.of)(void 0):H),R.initialNavigation()}))}}]).\u0275providers:[]]}const Xi=new F.OlP("")},582:(On,_t,se)=>{function ut(be,ye,Ne,Le){return new(Ne||(Ne=Promise))(function(nt,Jt){function jn(Nn){try{tn(Le.next(Nn))}catch(Ai){Jt(Ai)}}function ki(Nn){try{tn(Le.throw(Nn))}catch(Ai){Jt(Ai)}}function tn(Nn){Nn.done?nt(Nn.value):function $e(nt){return nt instanceof Ne?nt:new Ne(function(Jt){Jt(nt)})}(Nn.value).then(jn,ki)}tn((Le=Le.apply(be,ye||[])).next())})}function ke(be){return this instanceof ke?(this.v=be,this):new ke(be)}function st(be,ye,Ne){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var $e,Le=Ne.apply(be,ye||[]),nt=[];return $e={},Jt("next"),Jt("throw"),Jt("return"),$e[Symbol.asyncIterator]=function(){return this},$e;function Jt(Ci){Le[Ci]&&($e[Ci]=function(Ji){return new Promise(function(Qi,li){nt.push([Ci,Ji,Qi,li])>1||jn(Ci,Ji)})})}function jn(Ci,Ji){try{!function ki(Ci){Ci.value instanceof ke?Promise.resolve(Ci.value.v).then(tn,Nn):Ai(nt[0][2],Ci)}(Le[Ci](Ji))}catch(Qi){Ai(nt[0][3],Qi)}}function tn(Ci){jn("next",Ci)}function Nn(Ci){jn("throw",Ci)}function Ai(Ci,Ji){Ci(Ji),nt.shift(),nt.length&&jn(nt[0][0],nt[0][1])}}function yn(be){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Ne,ye=be[Symbol.asyncIterator];return ye?ye.call(be):(be=function ai(be){var ye="function"==typeof Symbol&&Symbol.iterator,Ne=ye&&be[ye],Le=0;if(Ne)return Ne.call(be);if(be&&"number"==typeof be.length)return{next:function(){return be&&Le>=be.length&&(be=void 0),{value:be&&be[Le++],done:!be}}};throw new TypeError(ye?"Object is not iterable.":"Symbol.iterator is not defined.")}(be),Ne={},Le("next"),Le("throw"),Le("return"),Ne[Symbol.asyncIterator]=function(){return this},Ne);function Le(nt){Ne[nt]=be[nt]&&function(Jt){return new Promise(function(jn,ki){!function $e(nt,Jt,jn,ki){Promise.resolve(ki).then(function(tn){nt({value:tn,done:jn})},Jt)}(jn,ki,(Jt=be[nt](Jt)).done,Jt.value)})}}}se.d(_t,{FC:()=>st,KL:()=>yn,mG:()=>ut,qq:()=>ke}),"function"==typeof SuppressedError&&SuppressedError}},On=>{On(On.s=698)}]);